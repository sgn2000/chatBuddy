var LA=Object.defineProperty,VA=Object.defineProperties;var FA=Object.getOwnPropertyDescriptors;var t_=Object.getOwnPropertySymbols,jA=Object.getPrototypeOf,UA=Object.prototype.hasOwnProperty,BA=Object.prototype.propertyIsEnumerable,$A=Reflect.get;var n_=(n,e,t)=>e in n?LA(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,jt=(n,e)=>{for(var t in e||={})UA.call(e,t)&&n_(n,t,e[t]);if(t_)for(var t of t_(e))BA.call(e,t)&&n_(n,t,e[t]);return n},Ut=(n,e)=>VA(n,FA(e));var qa=(n,e,t)=>$A(jA(n),t,e);var w=(n,e,t)=>new Promise((r,i)=>{var o=u=>{try{a(t.next(u))}catch(l){i(l)}},s=u=>{try{a(t.throw(u))}catch(l){i(l)}},a=u=>u.done?r(u.value):Promise.resolve(u.value).then(o,s);a((t=t.apply(n,e)).next())});function r_(n,e){return Object.is(n,e)}var Be=null,Ha=!1,za=1,an=Symbol("SIGNAL");function ue(n){let e=Be;return Be=n,e}function i_(){return Be}var ns={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Kd(n){if(Ha)throw new Error("");if(Be===null)return;Be.consumerOnSignalRead(n);let e=Be.nextProducerIndex++;if(Qa(Be),e<Be.producerNode.length&&Be.producerNode[e]!==n&&ts(Be)){let t=Be.producerNode[e];Ka(t,Be.producerIndexOfThis[e])}Be.producerNode[e]!==n&&(Be.producerNode[e]=n,Be.producerIndexOfThis[e]=ts(Be)?c_(n,Be,e):0),Be.producerLastReadVersion[e]=n.version}function qA(){za++}function o_(n){if(!(ts(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===za)){if(!n.producerMustRecompute(n)&&!Yd(n)){n.dirty=!1,n.lastCleanEpoch=za;return}n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=za}}function s_(n){if(n.liveConsumerNode===void 0)return;let e=Ha;Ha=!0;try{for(let t of n.liveConsumerNode)t.dirty||HA(t)}finally{Ha=e}}function a_(){return Be?.consumerAllowSignalWrites!==!1}function HA(n){n.dirty=!0,s_(n),n.consumerMarkedDirty?.(n)}function Wa(n){return n&&(n.nextProducerIndex=0),ue(n)}function Qd(n,e){if(ue(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(ts(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)Ka(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function Yd(n){Qa(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(o_(t),r!==t.version))return!0}return!1}function Jd(n){if(Qa(n),ts(n))for(let e=0;e<n.producerNode.length;e++)Ka(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function c_(n,e,t){if(u_(n),n.liveConsumerNode.length===0&&l_(n))for(let r=0;r<n.producerNode.length;r++)n.producerIndexOfThis[r]=c_(n.producerNode[r],n,r);return n.liveConsumerIndexOfThis.push(t),n.liveConsumerNode.push(e)-1}function Ka(n,e){if(u_(n),n.liveConsumerNode.length===1&&l_(n))for(let r=0;r<n.producerNode.length;r++)Ka(n.producerNode[r],n.producerIndexOfThis[r]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];Qa(i),i.producerIndexOfThis[r]=e}}function ts(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function Qa(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function u_(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function l_(n){return n.producerNode!==void 0}function d_(n){let e=Object.create(zA);e.computation=n;let t=()=>{if(o_(e),Kd(e),e.value===Ga)throw e.error;return e.value};return t[an]=e,t}var Gd=Symbol("UNSET"),Wd=Symbol("COMPUTING"),Ga=Symbol("ERRORED"),zA=Ut(jt({},ns),{value:Gd,dirty:!0,error:null,equal:r_,producerMustRecompute(n){return n.value===Gd||n.value===Wd},producerRecomputeValue(n){if(n.value===Wd)throw new Error("Detected cycle in computations.");let e=n.value;n.value=Wd;let t=Wa(n),r;try{r=n.computation()}catch(i){r=Ga,n.error=i}finally{Qd(n,t)}if(e!==Gd&&e!==Ga&&r!==Ga&&n.equal(e,r)){n.value=e;return}n.value=r,n.version++}});function GA(){throw new Error}var h_=GA;function f_(){h_()}function p_(n){h_=n}var WA=null;function m_(n){let e=Object.create(y_);e.value=n;let t=()=>(Kd(e),e.value);return t[an]=e,t}function Zd(n,e){a_()||f_(),n.equal(n.value,e)||(n.value=e,KA(n))}function g_(n,e){a_()||f_(),Zd(n,e(n.value))}var y_=Ut(jt({},ns),{equal:r_,value:void 0});function KA(n){n.version++,qA(),s_(n),WA?.()}function Q(n){return typeof n=="function"}function Ei(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Ya=Ei(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Er(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var Oe=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(Q(r))try{r()}catch(o){e=o instanceof Ya?o.errors:[o]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let o of i)try{v_(o)}catch(s){e=e??[],s instanceof Ya?e=[...e,...s.errors]:e.push(s)}}if(e)throw new Ya(e)}}add(e){var t;if(e&&e!==this)if(this.closed)v_(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Er(t,e)}remove(e){let{_finalizers:t}=this;t&&Er(t,e),e instanceof n&&e._removeParent(this)}};Oe.EMPTY=(()=>{let n=new Oe;return n.closed=!0,n})();var Xd=Oe.EMPTY;function Ja(n){return n instanceof Oe||n&&"closed"in n&&Q(n.remove)&&Q(n.add)&&Q(n.unsubscribe)}function v_(n){Q(n)?n():n.unsubscribe()}var xt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Ti={setTimeout(n,e,...t){let{delegate:r}=Ti;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=Ti;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Za(n){Ti.setTimeout(()=>{let{onUnhandledError:e}=xt;if(e)e(n);else throw n})}function Tr(){}var __=eh("C",void 0,void 0);function I_(n){return eh("E",void 0,n)}function w_(n){return eh("N",n,void 0)}function eh(n,e,t){return{kind:n,value:e,error:t}}var br=null;function bi(n){if(xt.useDeprecatedSynchronousErrorHandling){let e=!br;if(e&&(br={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=br;if(br=null,t)throw r}}else n()}function E_(n){xt.useDeprecatedSynchronousErrorHandling&&br&&(br.errorThrown=!0,br.error=n)}var Cr=class extends Oe{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Ja(e)&&e.add(this)):this.destination=JA}static create(e,t,r){return new Ci(e,t,r)}next(e){this.isStopped?nh(w_(e),this):this._next(e)}error(e){this.isStopped?nh(I_(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?nh(__,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},QA=Function.prototype.bind;function th(n,e){return QA.call(n,e)}var rh=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){Xa(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){Xa(r)}else Xa(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Xa(t)}}},Ci=class extends Cr{constructor(e,t,r){super();let i;if(Q(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let o;this&&xt.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&th(e.next,o),error:e.error&&th(e.error,o),complete:e.complete&&th(e.complete,o)}):i=e}this.destination=new rh(i)}};function Xa(n){xt.useDeprecatedSynchronousErrorHandling?E_(n):Za(n)}function YA(n){throw n}function nh(n,e){let{onStoppedNotification:t}=xt;t&&Ti.setTimeout(()=>t(n,e))}var JA={closed:!0,next:Tr,error:YA,complete:Tr};var Di=typeof Symbol=="function"&&Symbol.observable||"@@observable";function ut(n){return n}function ec(...n){return ih(n)}function ih(n){return n.length===0?ut:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var ne=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let o=XA(t)?t:new Ci(t,r,i);return bi(()=>{let{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=T_(r),new r((i,o)=>{let s=new Ci({next:a=>{try{t(a)}catch(u){o(u),s.unsubscribe()}},error:o,complete:i});this.subscribe(s)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[Di](){return this}pipe(...t){return ih(t)(this)}toPromise(t){return t=T_(t),new t((r,i)=>{let o;this.subscribe(s=>o=s,s=>i(s),()=>r(o))})}}return n.create=e=>new n(e),n})();function T_(n){var e;return(e=n??xt.Promise)!==null&&e!==void 0?e:Promise}function ZA(n){return n&&Q(n.next)&&Q(n.error)&&Q(n.complete)}function XA(n){return n&&n instanceof Cr||ZA(n)&&Ja(n)}function oh(n){return Q(n?.lift)}function ee(n){return e=>{if(oh(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Y(n,e,t,r,i){return new sh(n,e,t,r,i)}var sh=class extends Cr{constructor(e,t,r,i,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(u){e.error(u)}}:super._next,this._error=i?function(a){try{i(a)}catch(u){e.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function ah(){return ee((n,e)=>{let t=null;n._refCount++;let r=Y(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let i=n._connection,o=t;t=null,i&&(!o||i===o)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}var ch=class extends ne{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,oh(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Oe;let t=this.getSubject();e.add(this.source.subscribe(Y(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Oe.EMPTY)}return e}refCount(){return ah()(this)}};var b_=Ei(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Nn=(()=>{class n extends ne{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new tc(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new b_}next(t){bi(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){bi(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){bi(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:o}=this;return r||i?Xd:(this.currentObservers=null,o.push(t),new Oe(()=>{this.currentObservers=null,Er(o,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:o}=this;r?t.error(i):o&&t.complete()}asObservable(){let t=new ne;return t.source=this,t}}return n.create=(e,t)=>new tc(e,t),n})(),tc=class extends Nn{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:Xd}};var rs=class extends Nn{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var uh={now(){return(uh.delegate||Date).now()},delegate:void 0};var nc=class extends Oe{constructor(e,t){super()}schedule(e,t=0){return this}};var is={setInterval(n,e,...t){let{delegate:r}=is;return r?.setInterval?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=is;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var Si=class extends nc{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;let i=this.id,o=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(o,i,t)),this.pending=!0,this.delay=t,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(o,this.id,t),this}requestAsyncId(e,t,r=0){return is.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return t;t!=null&&is.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,t);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r=!1,i;try{this.work(e)}catch(o){r=!0,i=o||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Er(r,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var Ai=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}};Ai.now=uh.now;var Ni=class extends Ai{constructor(e,t=Ai.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}};var rc=new Ni(Si),lh=rc;var ic=class extends Si{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,t,r):(e.flush(this),0)}};var oc=class extends Ni{};var dh=new oc(ic);var os=new ne(n=>n.complete());function sc(n){return n&&Q(n.schedule)}function C_(n){return n[n.length-1]}function ac(n){return Q(C_(n))?n.pop():void 0}function xn(n){return sc(C_(n))?n.pop():void 0}function hh(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function S_(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(h){try{l(r.next(h))}catch(p){s(p)}}function u(h){try{l(r.throw(h))}catch(p){s(p)}}function l(h){h.done?o(h.value):i(h.value).then(a,u)}l((r=r.apply(n,e||[])).next())})}function D_(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Dr(n){return this instanceof Dr?(this.v=n,this):new Dr(n)}function A_(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,o=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),i[Symbol.asyncIterator]=function(){return this},i;function s(y){return function(D){return Promise.resolve(D).then(y,p)}}function a(y,D){r[y]&&(i[y]=function(R){return new Promise(function(P,O){o.push([y,R,P,O])>1||u(y,R)})},D&&(i[y]=D(i[y])))}function u(y,D){try{l(r[y](D))}catch(R){g(o[0][3],R)}}function l(y){y.value instanceof Dr?Promise.resolve(y.value.v).then(h,p):g(o[0][2],y)}function h(y){u("next",y)}function p(y){u("throw",y)}function g(y,D){y(D),o.shift(),o.length&&u(o[0][0],o[0][1])}}function N_(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof D_=="function"?D_(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=n[o]&&function(s){return new Promise(function(a,u){s=n[o](s),i(a,u,s.done,s.value)})}}function i(o,s,a,u){Promise.resolve(u).then(function(l){o({value:l,done:a})},s)}}var cc=n=>n&&typeof n.length=="number"&&typeof n!="function";function uc(n){return Q(n?.then)}function lc(n){return Q(n[Di])}function dc(n){return Symbol.asyncIterator&&Q(n?.[Symbol.asyncIterator])}function hc(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function eN(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var fc=eN();function pc(n){return Q(n?.[fc])}function mc(n){return A_(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield Dr(t.read());if(i)return yield Dr(void 0);yield yield Dr(r)}}finally{t.releaseLock()}})}function gc(n){return Q(n?.getReader)}function De(n){if(n instanceof ne)return n;if(n!=null){if(lc(n))return tN(n);if(cc(n))return nN(n);if(uc(n))return rN(n);if(dc(n))return x_(n);if(pc(n))return iN(n);if(gc(n))return oN(n)}throw hc(n)}function tN(n){return new ne(e=>{let t=n[Di]();if(Q(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function nN(n){return new ne(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function rN(n){return new ne(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Za)})}function iN(n){return new ne(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function x_(n){return new ne(e=>{sN(n,e).catch(t=>e.error(t))})}function oN(n){return x_(mc(n))}function sN(n,e){var t,r,i,o;return S_(this,void 0,void 0,function*(){try{for(t=N_(n);r=yield t.next(),!r.done;){let s=r.value;if(e.next(s),e.closed)return}}catch(s){i={error:s}}finally{try{r&&!r.done&&(o=t.return)&&(yield o.call(t))}finally{if(i)throw i.error}}e.complete()})}function dt(n,e,t,r=0,i=!1){let o=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(o),!i)return o}function Rn(n,e=0){return ee((t,r)=>{t.subscribe(Y(r,i=>dt(r,n,()=>r.next(i),e),()=>dt(r,n,()=>r.complete(),e),i=>dt(r,n,()=>r.error(i),e)))})}function Pn(n,e=0){return ee((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function R_(n,e){return De(n).pipe(Pn(e),Rn(e))}function P_(n,e){return De(n).pipe(Pn(e),Rn(e))}function M_(n,e){return new ne(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function k_(n,e){return new ne(t=>{let r;return dt(t,e,()=>{r=n[fc](),dt(t,e,()=>{let i,o;try{({value:i,done:o}=r.next())}catch(s){t.error(s);return}o?t.complete():t.next(i)},0,!0)}),()=>Q(r?.return)&&r.return()})}function yc(n,e){if(!n)throw new Error("Iterable cannot be null");return new ne(t=>{dt(t,e,()=>{let r=n[Symbol.asyncIterator]();dt(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function O_(n,e){return yc(mc(n),e)}function L_(n,e){if(n!=null){if(lc(n))return R_(n,e);if(cc(n))return M_(n,e);if(uc(n))return P_(n,e);if(dc(n))return yc(n,e);if(pc(n))return k_(n,e);if(gc(n))return O_(n,e)}throw hc(n)}function Et(n,e){return e?L_(n,e):De(n)}function aN(...n){let e=xn(n);return Et(n,e)}function cN(n,e){let t=Q(n)?n:()=>n,r=i=>i.error(t());return new ne(e?i=>e.schedule(r,0,i):r)}function uN(n){return!!n&&(n instanceof ne||Q(n.lift)&&Q(n.subscribe))}var Sr=Ei(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function V_(n){return n instanceof Date&&!isNaN(n)}function We(n,e){return ee((t,r)=>{let i=0;t.subscribe(Y(r,o=>{r.next(n.call(e,o,i++))}))})}var{isArray:lN}=Array;function dN(n,e){return lN(e)?n(...e):n(e)}function vc(n){return We(e=>dN(n,e))}var{isArray:hN}=Array,{getPrototypeOf:fN,prototype:pN,keys:mN}=Object;function _c(n){if(n.length===1){let e=n[0];if(hN(e))return{args:e,keys:null};if(gN(e)){let t=mN(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function gN(n){return n&&typeof n=="object"&&fN(n)===pN}function Ic(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function yN(...n){let e=xn(n),t=ac(n),{args:r,keys:i}=_c(n);if(r.length===0)return Et([],e);let o=new ne(vN(r,e,i?s=>Ic(i,s):ut));return t?o.pipe(vc(t)):o}function vN(n,e,t=ut){return r=>{F_(e,()=>{let{length:i}=n,o=new Array(i),s=i,a=i;for(let u=0;u<i;u++)F_(e,()=>{let l=Et(n[u],e),h=!1;l.subscribe(Y(r,p=>{o[u]=p,h||(h=!0,a--),a||r.next(t(o.slice()))},()=>{--s||r.complete()}))},r)},r)}}function F_(n,e,t){n?dt(t,n,e):e()}function j_(n,e,t,r,i,o,s,a){let u=[],l=0,h=0,p=!1,g=()=>{p&&!u.length&&!l&&e.complete()},y=R=>l<r?D(R):u.push(R),D=R=>{o&&e.next(R),l++;let P=!1;De(t(R,h++)).subscribe(Y(e,O=>{i?.(O),o?y(O):e.next(O)},()=>{P=!0},void 0,()=>{if(P)try{for(l--;u.length&&l<r;){let O=u.shift();s?dt(e,s,()=>D(O)):D(O)}g()}catch(O){e.error(O)}}))};return n.subscribe(Y(e,y,()=>{p=!0,g()})),()=>{a?.()}}function Ar(n,e,t=1/0){return Q(e)?Ar((r,i)=>We((o,s)=>e(r,o,i,s))(De(n(r,i))),t):(typeof e=="number"&&(t=e),ee((r,i)=>j_(r,i,n,t)))}function U_(n=1/0){return Ar(ut,n)}function B_(){return U_(1)}function wc(...n){return B_()(Et(n,xn(n)))}function _N(n){return new ne(e=>{De(n()).subscribe(e)})}function IN(...n){let e=ac(n),{args:t,keys:r}=_c(n),i=new ne(o=>{let{length:s}=t;if(!s){o.complete();return}let a=new Array(s),u=s,l=s;for(let h=0;h<s;h++){let p=!1;De(t[h]).subscribe(Y(o,g=>{p||(p=!0,l--),a[h]=g},()=>u--,void 0,()=>{(!u||!p)&&(l||o.next(r?Ic(r,a):a),o.complete())}))}});return e?i.pipe(vc(e)):i}function fh(n=0,e,t=lh){let r=-1;return e!=null&&(sc(e)?t=e:r=e),new ne(i=>{let o=V_(n)?+n-t.now():n;o<0&&(o=0);let s=0;return t.schedule(function(){i.closed||(i.next(s++),0<=r?this.schedule(void 0,r):i.complete())},o)})}function Mn(n,e){return ee((t,r)=>{let i=0;t.subscribe(Y(r,o=>n.call(e,o,i++)&&r.next(o)))})}function $_(n){return ee((e,t)=>{let r=null,i=!1,o;r=e.subscribe(Y(t,void 0,void 0,s=>{o=De(n(s,$_(n)(e))),r?(r.unsubscribe(),r=null,o.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,o.subscribe(t))})}function q_(n,e,t,r,i){return(o,s)=>{let a=t,u=e,l=0;o.subscribe(Y(s,h=>{let p=l++;u=a?n(u,h,p):(a=!0,h),r&&s.next(u)},i&&(()=>{a&&s.next(u),s.complete()})))}}function ph(n,e){return Q(e)?Ar(n,e,1):Ar(n,1)}function ss(n){return ee((e,t)=>{let r=!1;e.subscribe(Y(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function mh(n){return n<=0?()=>os:ee((e,t)=>{let r=0;e.subscribe(Y(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function wN(n){return We(()=>n)}function gh(n,e){return ee((t,r)=>{let i=new Set;t.subscribe(Y(r,o=>{let s=n?n(o):o;i.has(s)||(i.add(s),r.next(o))})),e&&De(e).subscribe(Y(r,()=>i.clear(),Tr))})}function yh(n,e=ut){return n=n??EN,ee((t,r)=>{let i,o=!0;t.subscribe(Y(r,s=>{let a=e(s);(o||!n(i,a))&&(o=!1,i=a,r.next(s))}))})}function EN(n,e){return n===e}function Ec(n=TN){return ee((e,t)=>{let r=!1;e.subscribe(Y(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function TN(){return new Sr}function bN(n){return ee((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function H_(n,e){let t=arguments.length>=2;return r=>r.pipe(n?Mn((i,o)=>n(i,o,r)):ut,mh(1),t?ss(e):Ec(()=>new Sr))}function vh(n){return n<=0?()=>os:ee((e,t)=>{let r=[];e.subscribe(Y(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function CN(n,e){let t=arguments.length>=2;return r=>r.pipe(n?Mn((i,o)=>n(i,o,r)):ut,vh(1),t?ss(e):Ec(()=>new Sr))}function _h(){return ee((n,e)=>{let t,r=!1;n.subscribe(Y(e,i=>{let o=t;t=i,r&&e.next([o,i]),r=!0}))})}function Tc(n,e){return ee(q_(n,e,arguments.length>=2,!0))}function Ih(...n){let e=xn(n);return ee((t,r)=>{(e?wc(n,t,e):wc(n,t)).subscribe(r)})}function DN(n,e){return ee((t,r)=>{let i=null,o=0,s=!1,a=()=>s&&!i&&r.complete();t.subscribe(Y(r,u=>{i?.unsubscribe();let l=0,h=o++;De(n(u,h)).subscribe(i=Y(r,p=>r.next(e?e(u,p,h,l++):p),()=>{i=null,a()}))},()=>{s=!0,a()}))})}function SN(n){return ee((e,t)=>{De(n).subscribe(Y(t,()=>t.complete(),Tr)),!t.closed&&e.subscribe(t)})}function wh(n,e,t){let r=Q(n)||e||t?{next:n,error:e,complete:t}:n;return r?ee((i,o)=>{var s;(s=r.subscribe)===null||s===void 0||s.call(r);let a=!0;i.subscribe(Y(o,u=>{var l;(l=r.next)===null||l===void 0||l.call(r,u),o.next(u)},()=>{var u;a=!1,(u=r.complete)===null||u===void 0||u.call(r),o.complete()},u=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,u),o.error(u)},()=>{var u,l;a&&((u=r.unsubscribe)===null||u===void 0||u.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):ut}var xI="https://g.co/ng/security#xss",de=class extends Error{constructor(e,t){super(AN(e,t)),this.code=e}};function AN(n,e){return`${`NG0${Math.abs(n)}`}${e?": "+e:""}`}function vs(n){return{toString:n}.toString()}var bc="__parameters__";function NN(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function RI(n,e,t){return vs(()=>{let r=NN(e);function i(...o){if(this instanceof i)return r.apply(this,o),this;let s=new i(...o);return a.annotation=s,a;function a(u,l,h){let p=u.hasOwnProperty(bc)?u[bc]:Object.defineProperty(u,bc,{value:[]})[bc];for(;p.length<=h;)p.push(null);return(p[h]=p[h]||[]).push(s),u}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}var Cc=globalThis;function _e(n){for(let e in n)if(n[e]===_e)return e;throw Error("Could not find renamed property on target object.")}function xN(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function yt(n){if(typeof n=="string")return n;if(Array.isArray(n))return"["+n.map(yt).join(", ")+"]";if(n==null)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;let e=n.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function z_(n,e){return n==null||n===""?e===null?"":e:e==null||e===""?n:n+" "+e}var RN=_e({__forward_ref__:_e});function PI(n){return n.__forward_ref__=PI,n.toString=function(){return yt(this())},n}function lt(n){return MI(n)?n():n}function MI(n){return typeof n=="function"&&n.hasOwnProperty(RN)&&n.__forward_ref__===PI}function Ke(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function kI(n){return{providers:n.providers||[],imports:n.imports||[]}}function cu(n){return G_(n,OI)||G_(n,LI)}function iH(n){return cu(n)!==null}function G_(n,e){return n.hasOwnProperty(e)?n[e]:null}function PN(n){let e=n&&(n[OI]||n[LI]);return e||null}function W_(n){return n&&(n.hasOwnProperty(K_)||n.hasOwnProperty(MN))?n[K_]:null}var OI=_e({\u0275prov:_e}),K_=_e({\u0275inj:_e}),LI=_e({ngInjectableDef:_e}),MN=_e({ngInjectorDef:_e}),me=class{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=Ke({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function VI(n){return n&&!!n.\u0275providers}var kN=_e({\u0275cmp:_e}),ON=_e({\u0275dir:_e}),LN=_e({\u0275pipe:_e}),VN=_e({\u0275mod:_e}),Oc=_e({\u0275fac:_e}),us=_e({__NG_ELEMENT_ID__:_e}),Q_=_e({__NG_ENV_ID__:_e});function uu(n){return typeof n=="string"?n:n==null?"":String(n)}function FN(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():uu(n)}function jN(n,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new de(-200,n)}function kf(n,e){throw new de(-201,!1)}var oe=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(oe||{}),Lh;function FI(){return Lh}function ht(n){let e=Lh;return Lh=n,e}function jI(n,e,t){let r=cu(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&oe.Optional)return null;if(e!==void 0)return e;kf(n,"Injector")}var UN={},ls=UN,Vh="__NG_DI_FLAG__",Lc="ngTempTokenPath",BN="ngTokenPath",$N=/\n/gm,qN="\u0275",Y_="__source",Mi;function HN(){return Mi}function kn(n){let e=Mi;return Mi=n,e}function zN(n,e=oe.Default){if(Mi===void 0)throw new de(-203,!1);return Mi===null?jI(n,void 0,e):Mi.get(n,e&oe.Optional?null:void 0,e)}function qt(n,e=oe.Default){return(FI()||zN)(lt(n),e)}function ve(n,e=oe.Default){return qt(n,lu(e))}function lu(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Fh(n){let e=[];for(let t=0;t<n.length;t++){let r=lt(n[t]);if(Array.isArray(r)){if(r.length===0)throw new de(900,!1);let i,o=oe.Default;for(let s=0;s<r.length;s++){let a=r[s],u=GN(a);typeof u=="number"?u===-1?i=a.token:o|=u:i=a}e.push(qt(i,o))}else e.push(qt(r))}return e}function UI(n,e){return n[Vh]=e,n.prototype[Vh]=e,n}function GN(n){return n[Vh]}function WN(n,e,t,r){let i=n[Lc];throw e[Y_]&&i.unshift(e[Y_]),n.message=KN(`
`+n.message,i,t,r),n[BN]=i,n[Lc]=null,n}function KN(n,e,t,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==qN?n.slice(2):n;let i=yt(e);if(Array.isArray(e))i=e.map(yt).join(" -> ");else if(typeof e=="object"){let o=[];for(let s in e)if(e.hasOwnProperty(s)){let a=e[s];o.push(s+":"+(typeof a=="string"?JSON.stringify(a):yt(a)))}i=`{${o.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace($N,`
  `)}`}var ln=UI(RI("Optional"),8);var QN=UI(RI("SkipSelf"),4);function Rr(n,e){let t=n.hasOwnProperty(Oc);return t?n[Oc]:null}function YN(n,e,t){if(n.length!==e.length)return!1;for(let r=0;r<n.length;r++){let i=n[r],o=e[r];if(t&&(i=t(i),o=t(o)),o!==i)return!1}return!0}function JN(n){return n.flat(Number.POSITIVE_INFINITY)}function Of(n,e){n.forEach(t=>Array.isArray(t)?Of(t,e):e(t))}function BI(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Vc(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function ZN(n,e,t,r){let i=n.length;if(i==e)n.push(t,r);else if(i===1)n.push(r,n[0]),n[0]=t;else{for(i--,n.push(n[i-1],n[i]);i>e;){let o=i-2;n[i]=n[o],i--}n[e]=t,n[e+1]=r}}function XN(n,e,t){let r=_s(n,e);return r>=0?n[r|1]=t:(r=~r,ZN(n,r,e,t)),r}function Eh(n,e){let t=_s(n,e);if(t>=0)return n[t|1]}function _s(n,e){return ex(n,e,1)}function ex(n,e,t){let r=0,i=n.length>>t;for(;i!==r;){let o=r+(i-r>>1),s=n[o<<t];if(e===s)return o<<t;s>e?i=o:r=o+1}return~(i<<t)}var Oi={},Tt=[],Fc=new me(""),$I=new me("",-1),qI=new me(""),jc=class{get(e,t=ls){if(t===ls){let r=new Error(`NullInjectorError: No provider for ${yt(e)}!`);throw r.name="NullInjectorError",r}return t}},HI=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(HI||{}),ds=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(ds||{}),Vn=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(Vn||{});function tx(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let o=e.length;if(i+o===r||n.charCodeAt(i+o)<=32)return i}t=i+1}}function jh(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let o=t[r++],s=t[r++],a=t[r++];n.setAttribute(e,s,a,o)}else{let o=i,s=t[++r];rx(o)?n.setProperty(e,o,s):n.setAttribute(e,o,s),r++}}return r}function nx(n){return n===3||n===4||n===6}function rx(n){return n.charCodeAt(0)===64}function hs(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?J_(n,t,i,null,e[++r]):J_(n,t,i,null,null))}}return n}function J_(n,e,t,r,i){let o=0,s=n.length;if(e===-1)s=-1;else for(;o<n.length;){let a=n[o++];if(typeof a=="number"){if(a===e){s=-1;break}else if(a>e){s=o-1;break}}}for(;o<n.length;){let a=n[o];if(typeof a=="number")break;if(a===t){if(r===null){i!==null&&(n[o+1]=i);return}else if(r===n[o+1]){n[o+2]=i;return}}o++,r!==null&&o++,i!==null&&o++}s!==-1&&(n.splice(s,0,e),o=s+1),n.splice(o++,0,t),r!==null&&n.splice(o++,0,r),i!==null&&n.splice(o++,0,i)}var zI="ng-template";function ix(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&tx(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(Lf(n))return!1;if(i=e.indexOf(1,i),i>-1){let o;for(;++i<e.length&&typeof(o=e[i])=="string";)if(o.toLowerCase()===t)return!0}return!1}function Lf(n){return n.type===4&&n.value!==zI}function ox(n,e,t){let r=n.type===4&&!t?zI:n.value;return e===r}function sx(n,e,t){let r=4,i=n.attrs,o=i!==null?ux(i):0,s=!1;for(let a=0;a<e.length;a++){let u=e[a];if(typeof u=="number"){if(!s&&!Rt(r)&&!Rt(u))return!1;if(s&&Rt(u))continue;s=!1,r=u|r&1;continue}if(!s)if(r&4){if(r=2|r&1,u!==""&&!ox(n,u,t)||u===""&&e.length===1){if(Rt(r))return!1;s=!0}}else if(r&8){if(i===null||!ix(n,i,u,t)){if(Rt(r))return!1;s=!0}}else{let l=e[++a],h=ax(u,i,Lf(n),t);if(h===-1){if(Rt(r))return!1;s=!0;continue}if(l!==""){let p;if(h>o?p="":p=i[h+1].toLowerCase(),r&2&&l!==p){if(Rt(r))return!1;s=!0}}}}return Rt(r)||s}function Rt(n){return(n&1)===0}function ax(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let o=!1;for(;i<e.length;){let s=e[i];if(s===n)return i;if(s===3||s===6)o=!0;else if(s===1||s===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(s===4)break;if(s===0){i+=4;continue}}i+=o?1:2}return-1}else return lx(e,n)}function cx(n,e,t=!1){for(let r=0;r<e.length;r++)if(sx(n,e[r],t))return!0;return!1}function ux(n){for(let e=0;e<n.length;e++){let t=n[e];if(nx(t))return e}return n.length}function lx(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function Z_(n,e){return n?":not("+e.trim()+")":e}function dx(n){let e=n[0],t=1,r=2,i="",o=!1;for(;t<n.length;){let s=n[t];if(typeof s=="string")if(r&2){let a=n[++t];i+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+s:r&4&&(i+=" "+s);else i!==""&&!Rt(s)&&(e+=Z_(o,i),i=""),r=s,o=o||!Rt(r);t++}return i!==""&&(e+=Z_(o,i)),e}function hx(n){return n.map(dx).join(",")}function fx(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let o=n[r];if(typeof o=="string")i===2?o!==""&&e.push(o,n[++r]):i===8&&t.push(o);else{if(!Rt(i))break;i=o}r++}return{attrs:e,classes:t}}function oH(n){return vs(()=>{let e=YI(n),t=Ut(jt({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===HI.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||ds.Emulated,styles:n.styles||Tt,_:null,schemas:n.schemas||null,tView:null,id:""});JI(t);let r=n.dependencies;return t.directiveDefs=eI(r,!1),t.pipeDefs=eI(r,!0),t.id=yx(t),t})}function px(n){return Pr(n)||WI(n)}function mx(n){return n!==null}function GI(n){return vs(()=>({type:n.type,bootstrap:n.bootstrap||Tt,declarations:n.declarations||Tt,imports:n.imports||Tt,exports:n.exports||Tt,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function X_(n,e){if(n==null)return Oi;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],o,s,a=Vn.None;Array.isArray(i)?(a=i[0],o=i[1],s=i[2]??o):(o=i,s=i),e?(t[o]=a!==Vn.None?[r,a]:r,e[o]=s):t[o]=r}return t}function sH(n){return vs(()=>{let e=YI(n);return JI(e),e})}function aH(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone===!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function Pr(n){return n[kN]||null}function WI(n){return n[ON]||null}function KI(n){return n[LN]||null}function gx(n){let e=Pr(n)||WI(n)||KI(n);return e!==null?e.standalone:!1}function QI(n,e){let t=n[VN]||null;if(!t&&e===!0)throw new Error(`Type ${yt(n)} does not have '\u0275mod' property.`);return t}function YI(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||Oi,exportAs:n.exportAs||null,standalone:n.standalone===!0,signals:n.signals===!0,selectors:n.selectors||Tt,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:X_(n.inputs,e),outputs:X_(n.outputs),debugInfo:null}}function JI(n){n.features?.forEach(e=>e(n))}function eI(n,e){if(!n)return null;let t=e?KI:px;return()=>(typeof n=="function"?n():n).map(r=>t(r)).filter(mx)}function yx(n){let e=0,t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(let i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function Is(n){return{\u0275providers:n}}function vx(...n){return{\u0275providers:ZI(!0,n),\u0275fromNgModule:!0}}function ZI(n,...e){let t=[],r=new Set,i,o=s=>{t.push(s)};return Of(e,s=>{let a=s;Uh(a,o,[],r)&&(i||=[],i.push(a))}),i!==void 0&&XI(i,o),t}function XI(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];Vf(i,o=>{e(o,r)})}}function Uh(n,e,t,r){if(n=lt(n),!n)return!1;let i=null,o=W_(n),s=!o&&Pr(n);if(!o&&!s){let u=n.ngModule;if(o=W_(u),o)i=u;else return!1}else{if(s&&!s.standalone)return!1;i=n}let a=r.has(i);if(s){if(a)return!1;if(r.add(i),s.dependencies){let u=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let l of u)Uh(l,e,t,r)}}else if(o){if(o.imports!=null&&!a){r.add(i);let l;try{Of(o.imports,h=>{Uh(h,e,t,r)&&(l||=[],l.push(h))})}finally{}l!==void 0&&XI(l,e)}if(!a){let l=Rr(i)||(()=>new i);e({provide:i,useFactory:l,deps:Tt},i),e({provide:qI,useValue:i,multi:!0},i),e({provide:Fc,useValue:()=>qt(i),multi:!0},i)}let u=o.providers;if(u!=null&&!a){let l=n;Vf(u,h=>{e(h,l)})}}else return!1;return i!==n&&n.providers!==void 0}function Vf(n,e){for(let t of n)VI(t)&&(t=t.\u0275providers),Array.isArray(t)?Vf(t,e):e(t)}var _x=_e({provide:String,useValue:_e});function ew(n){return n!==null&&typeof n=="object"&&_x in n}function Ix(n){return!!(n&&n.useExisting)}function wx(n){return!!(n&&n.useFactory)}function Li(n){return typeof n=="function"}function Ex(n){return!!n.useClass}var tw=new me(""),Nc={},Tx={},Th;function Ff(){return Th===void 0&&(Th=new jc),Th}var Fn=class{},fs=class extends Fn{get destroyed(){return this._destroyed}constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,$h(e,s=>this.processProvider(s)),this.records.set($I,xi(void 0,this)),i.has("environment")&&this.records.set(Fn,xi(void 0,this));let o=this.records.get(tw);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(qI,Tt,oe.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=ue(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),ue(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let t=kn(this),r=ht(void 0),i;try{return e()}finally{kn(t),ht(r)}}get(e,t=ls,r=oe.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(Q_))return e[Q_](this);r=lu(r);let i,o=kn(this),s=ht(void 0);try{if(!(r&oe.SkipSelf)){let u=this.records.get(e);if(u===void 0){let l=Ax(e)&&cu(e);l&&this.injectableDefInScope(l)?u=xi(Bh(e),Nc):u=null,this.records.set(e,u)}if(u!=null)return this.hydrate(e,u)}let a=r&oe.Self?Ff():this.parent;return t=r&oe.Optional&&t===ls?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[Lc]=a[Lc]||[]).unshift(yt(e)),o)throw a;return WN(a,e,"R3InjectorError",this.source)}else throw a}finally{ht(s),kn(o)}}resolveInjectorInitializers(){let e=ue(null),t=kn(this),r=ht(void 0),i;try{let o=this.get(Fc,Tt,oe.Self);for(let s of o)s()}finally{kn(t),ht(r),ue(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(yt(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new de(205,!1)}processProvider(e){e=lt(e);let t=Li(e)?e:lt(e&&e.provide),r=Cx(e);if(!Li(e)&&e.multi===!0){let i=this.records.get(t);i||(i=xi(void 0,Nc,!0),i.factory=()=>Fh(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){let r=ue(null);try{return t.value===Nc&&(t.value=Tx,t.value=t.factory()),typeof t.value=="object"&&t.value&&Sx(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{ue(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=lt(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function Bh(n){let e=cu(n),t=e!==null?e.factory:Rr(n);if(t!==null)return t;if(n instanceof me)throw new de(204,!1);if(n instanceof Function)return bx(n);throw new de(204,!1)}function bx(n){if(n.length>0)throw new de(204,!1);let t=PN(n);return t!==null?()=>t.factory(n):()=>new n}function Cx(n){if(ew(n))return xi(void 0,n.useValue);{let e=nw(n);return xi(e,Nc)}}function nw(n,e,t){let r;if(Li(n)){let i=lt(n);return Rr(i)||Bh(i)}else if(ew(n))r=()=>lt(n.useValue);else if(wx(n))r=()=>n.useFactory(...Fh(n.deps||[]));else if(Ix(n))r=()=>qt(lt(n.useExisting));else{let i=lt(n&&(n.useClass||n.provide));if(Dx(n))r=()=>new i(...Fh(n.deps));else return Rr(i)||Bh(i)}return r}function xi(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function Dx(n){return!!n.deps}function Sx(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function Ax(n){return typeof n=="function"||typeof n=="object"&&n instanceof me}function $h(n,e){for(let t of n)Array.isArray(t)?$h(t,e):t&&VI(t)?$h(t.\u0275providers,e):e(t)}function cH(n,e){n instanceof fs&&n.assertNotDestroyed();let t,r=kn(n),i=ht(void 0);try{return e()}finally{kn(r),ht(i)}}function Nx(){return FI()!==void 0||HN()!=null}function xx(n){return typeof n=="function"}var dn=0,Z=1,W=2,et=3,Pt=4,Ot=5,Uc=6,Bc=7,Mt=8,Vi=9,Ht=10,qe=11,ps=12,tI=13,qi=14,zt=15,Mr=16,Ri=17,un=18,du=19,rw=20,On=21,bh=22,bt=23,kt=25,iw=1;var kr=7,$c=8,Fi=9,vt=10,qc=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n}(qc||{});function Ln(n){return Array.isArray(n)&&typeof n[iw]=="object"}function hn(n){return Array.isArray(n)&&n[iw]===!0}function ow(n){return(n.flags&4)!==0}function hu(n){return n.componentOffset>-1}function jf(n){return(n.flags&1)===1}function jn(n){return!!n.template}function qh(n){return(n[W]&512)!==0}var Hh=class{constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function sw(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}function Rx(){return aw}function aw(n){return n.type.prototype.ngOnChanges&&(n.setInput=Mx),Px}Rx.ngInherit=!0;function Px(){let n=uw(this),e=n?.current;if(e){let t=n.previous;if(t===Oi)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function Mx(n,e,t,r,i){let o=this.declaredInputs[r],s=uw(n)||kx(n,{previous:Oi,current:null}),a=s.current||(s.current={}),u=s.previous,l=u[o];a[o]=new Hh(l&&l.currentValue,t,u===Oi),sw(n,e,i,t)}var cw="__ngSimpleChanges__";function uw(n){return n[cw]||null}function kx(n,e){return n[cw]=e}var nI=null;var Bt=function(n,e,t){nI?.(n,e,t)},lw="svg",Ox="math";function Gt(n){for(;Array.isArray(n);)n=n[dn];return n}function dw(n,e){return Gt(e[n])}function Ct(n,e){return Gt(e[n.index])}function hw(n,e){return n.data[e]}function fw(n,e){return n[e]}function Bn(n,e){let t=e[n];return Ln(t)?t:t[dn]}function Lx(n){return(n[W]&4)===4}function Uf(n){return(n[W]&128)===128}function Vx(n){return hn(n[et])}function Hc(n,e){return e==null?null:n[e]}function pw(n){n[Ri]=0}function mw(n){n[W]&1024||(n[W]|=1024,Uf(n)&&pu(n))}function Fx(n,e){for(;n>0;)e=e[qi],n--;return e}function fu(n){return!!(n[W]&9216||n[bt]?.dirty)}function zh(n){n[Ht].changeDetectionScheduler?.notify(8),n[W]&64&&(n[W]|=1024),fu(n)&&pu(n)}function pu(n){n[Ht].changeDetectionScheduler?.notify(0);let e=Or(n);for(;e!==null&&!(e[W]&8192||(e[W]|=8192,!Uf(e)));)e=Or(e)}function gw(n,e){if((n[W]&256)===256)throw new de(911,!1);n[On]===null&&(n[On]=[]),n[On].push(e)}function jx(n,e){if(n[On]===null)return;let t=n[On].indexOf(e);t!==-1&&n[On].splice(t,1)}function Or(n){let e=n[et];return hn(e)?e[et]:e}var X={lFrame:Cw(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var yw=!1;function Ux(){return X.lFrame.elementDepthCount}function Bx(){X.lFrame.elementDepthCount++}function $x(){X.lFrame.elementDepthCount--}function vw(){return X.bindingsEnabled}function qx(){return X.skipHydrationRootTNode!==null}function Hx(n){return X.skipHydrationRootTNode===n}function zx(){X.skipHydrationRootTNode=null}function fe(){return X.lFrame.lView}function tt(){return X.lFrame.tView}function uH(n){return X.lFrame.contextLView=n,n[Mt]}function lH(n){return X.lFrame.contextLView=null,n}function ft(){let n=_w();for(;n!==null&&n.type===64;)n=n.parent;return n}function _w(){return X.lFrame.currentTNode}function Gx(){let n=X.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function ws(n,e){let t=X.lFrame;t.currentTNode=n,t.isParent=e}function Iw(){return X.lFrame.isParent}function Wx(){X.lFrame.isParent=!1}function Kx(){return X.lFrame.contextLView}function ww(){return yw}function rI(n){yw=n}function Qx(){let n=X.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function Yx(n){return X.lFrame.bindingIndex=n}function mu(){return X.lFrame.bindingIndex++}function Jx(n){let e=X.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function Zx(){return X.lFrame.inI18n}function Xx(n,e){let t=X.lFrame;t.bindingIndex=t.bindingRootIndex=n,Gh(e)}function eR(){return X.lFrame.currentDirectiveIndex}function Gh(n){X.lFrame.currentDirectiveIndex=n}function tR(n){let e=X.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function Ew(){return X.lFrame.currentQueryIndex}function Bf(n){X.lFrame.currentQueryIndex=n}function nR(n){let e=n[Z];return e.type===2?e.declTNode:e.type===1?n[Ot]:null}function Tw(n,e,t){if(t&oe.SkipSelf){let i=e,o=n;for(;i=i.parent,i===null&&!(t&oe.Host);)if(i=nR(o),i===null||(o=o[qi],i.type&10))break;if(i===null)return!1;e=i,n=o}let r=X.lFrame=bw();return r.currentTNode=e,r.lView=n,!0}function $f(n){let e=bw(),t=n[Z];X.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function bw(){let n=X.lFrame,e=n===null?null:n.child;return e===null?Cw(n):e}function Cw(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function Dw(){let n=X.lFrame;return X.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var Sw=Dw;function qf(){let n=Dw();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function rR(n){return(X.lFrame.contextLView=Fx(n,X.lFrame.contextLView))[Mt]}function Hi(){return X.lFrame.selectedIndex}function Lr(n){X.lFrame.selectedIndex=n}function Hf(){let n=X.lFrame;return hw(n.tView,n.selectedIndex)}function dH(){X.lFrame.currentNamespace=lw}function hH(){iR()}function iR(){X.lFrame.currentNamespace=null}function oR(){return X.lFrame.currentNamespace}var Aw=!0;function zf(){return Aw}function Gf(n){Aw=n}function sR(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=e.type.prototype;if(r){let s=aw(e);(t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s)}i&&(t.preOrderHooks??=[]).push(0-n,i),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}function Wf(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let o=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:u,ngAfterViewChecked:l,ngOnDestroy:h}=o;s&&(n.contentHooks??=[]).push(-t,s),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),u&&(n.viewHooks??=[]).push(-t,u),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),h!=null&&(n.destroyHooks??=[]).push(t,h)}}function xc(n,e,t){Nw(n,e,3,t)}function Rc(n,e,t,r){(n[W]&3)===t&&Nw(n,e,t,r)}function Ch(n,e){let t=n[W];(t&3)===e&&(t&=16383,t+=1,n[W]=t)}function Nw(n,e,t,r){let i=r!==void 0?n[Ri]&65535:0,o=r??-1,s=e.length-1,a=0;for(let u=i;u<s;u++)if(typeof e[u+1]=="number"){if(a=e[u],r!=null&&a>=r)break}else e[u]<0&&(n[Ri]+=65536),(a<o||o==-1)&&(aR(n,t,e,u),n[Ri]=(n[Ri]&4294901760)+u+2),u++}function iI(n,e){Bt(4,n,e);let t=ue(null);try{e.call(n)}finally{ue(t),Bt(5,n,e)}}function aR(n,e,t,r){let i=t[r]<0,o=t[r+1],s=i?-t[r]:t[r],a=n[s];i?n[W]>>14<n[Ri]>>16&&(n[W]&3)===e&&(n[W]+=16384,iI(a,o)):iI(a,o)}var ki=-1,Vr=class{constructor(e,t,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}};function cR(n){return n instanceof Vr}function uR(n){return(n.flags&8)!==0}function lR(n){return(n.flags&16)!==0}var Dh={},Wh=class{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=lu(r);let i=this.injector.get(e,Dh,r);return i!==Dh||t===Dh?i:this.parentInjector.get(e,t,r)}};function xw(n){return n!==ki}function zc(n){return n&32767}function dR(n){return n>>16}function Gc(n,e){let t=dR(n),r=e;for(;t>0;)r=r[qi],t--;return r}var Kh=!0;function Wc(n){let e=Kh;return Kh=n,e}var hR=256,Rw=hR-1,Pw=5,fR=0,$t={};function pR(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(us)&&(r=t[us]),r==null&&(r=t[us]=fR++);let i=r&Rw,o=1<<i;e.data[n+(i>>Pw)]|=o}function Kc(n,e){let t=Mw(n,e);if(t!==-1)return t;let r=e[Z];r.firstCreatePass&&(n.injectorIndex=e.length,Sh(r.data,n),Sh(e,null),Sh(r.blueprint,null));let i=Kf(n,e),o=n.injectorIndex;if(xw(i)){let s=zc(i),a=Gc(i,e),u=a[Z].data;for(let l=0;l<8;l++)e[o+l]=a[s+l]|u[s+l]}return e[o+8]=i,o}function Sh(n,e){n.push(0,0,0,0,0,0,0,0,e)}function Mw(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function Kf(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=Fw(i),r===null)return ki;if(t++,i=i[qi],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return ki}function Qh(n,e,t){pR(n,e,t)}function kw(n,e,t){if(t&oe.Optional||n!==void 0)return n;kf(e,"NodeInjector")}function Ow(n,e,t,r){if(t&oe.Optional&&r===void 0&&(r=null),!(t&(oe.Self|oe.Host))){let i=n[Vi],o=ht(void 0);try{return i?i.get(e,r,t&oe.Optional):jI(e,r,t&oe.Optional)}finally{ht(o)}}return kw(r,e,t)}function Lw(n,e,t,r=oe.Default,i){if(n!==null){if(e[W]&2048&&!(r&oe.Self)){let s=vR(n,e,t,r,$t);if(s!==$t)return s}let o=Vw(n,e,t,r,$t);if(o!==$t)return o}return Ow(e,t,r,i)}function Vw(n,e,t,r,i){let o=gR(t);if(typeof o=="function"){if(!Tw(e,n,r))return r&oe.Host?kw(i,t,r):Ow(e,t,r,i);try{let s;if(s=o(r),s==null&&!(r&oe.Optional))kf(t);else return s}finally{Sw()}}else if(typeof o=="number"){let s=null,a=Mw(n,e),u=ki,l=r&oe.Host?e[zt][Ot]:null;for((a===-1||r&oe.SkipSelf)&&(u=a===-1?Kf(n,e):e[a+8],u===ki||!sI(r,!1)?a=-1:(s=e[Z],a=zc(u),e=Gc(u,e)));a!==-1;){let h=e[Z];if(oI(o,a,h.data)){let p=mR(a,e,t,s,r,l);if(p!==$t)return p}u=e[a+8],u!==ki&&sI(r,e[Z].data[a+8]===l)&&oI(o,a,e)?(s=h,a=zc(u),e=Gc(u,e)):a=-1}}return i}function mR(n,e,t,r,i,o){let s=e[Z],a=s.data[n+8],u=r==null?hu(a)&&Kh:r!=s&&(a.type&3)!==0,l=i&oe.Host&&o===a,h=Pc(a,s,t,u,l);return h!==null?Fr(e,s,h,a):$t}function Pc(n,e,t,r,i){let o=n.providerIndexes,s=e.data,a=o&1048575,u=n.directiveStart,l=n.directiveEnd,h=o>>20,p=r?a:a+h,g=i?a+h:l;for(let y=p;y<g;y++){let D=s[y];if(y<u&&t===D||y>=u&&D.type===t)return y}if(i){let y=s[u];if(y&&jn(y)&&y.type===t)return u}return null}function Fr(n,e,t,r){let i=n[t],o=e.data;if(cR(i)){let s=i;s.resolving&&jN(FN(o[t]));let a=Wc(s.canSeeViewProviders);s.resolving=!0;let u,l=s.injectImpl?ht(s.injectImpl):null,h=Tw(n,r,oe.Default);try{i=n[t]=s.factory(void 0,o,n,r),e.firstCreatePass&&t>=r.directiveStart&&sR(t,o[t],e)}finally{l!==null&&ht(l),Wc(a),s.resolving=!1,Sw()}}return i}function gR(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(us)?n[us]:void 0;return typeof e=="number"?e>=0?e&Rw:yR:e}function oI(n,e,t){let r=1<<n;return!!(t[e+(n>>Pw)]&r)}function sI(n,e){return!(n&oe.Self)&&!(n&oe.Host&&e)}var xr=class{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return Lw(this._tNode,this._lView,e,lu(r),t)}};function yR(){return new xr(ft(),fe())}function fH(n){return vs(()=>{let e=n.prototype.constructor,t=e[Oc]||Yh(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let o=i[Oc]||Yh(i);if(o&&o!==t)return o;i=Object.getPrototypeOf(i)}return o=>new o})}function Yh(n){return MI(n)?()=>{let e=Yh(lt(n));return e&&e()}:Rr(n)}function vR(n,e,t,r,i){let o=n,s=e;for(;o!==null&&s!==null&&s[W]&2048&&!(s[W]&512);){let a=Vw(o,s,t,r|oe.Self,$t);if(a!==$t)return a;let u=o.parent;if(!u){let l=s[rw];if(l){let h=l.get(t,$t,r);if(h!==$t)return h}u=Fw(s),s=s[qi]}o=u}return i}function Fw(n){let e=n[Z],t=e.type;return t===2?e.declTNode:t===1?n[Ot]:null}function aI(n,e=null,t=null,r){let i=jw(n,e,t,r);return i.resolveInjectorInitializers(),i}function jw(n,e=null,t=null,r,i=new Set){let o=[t||Tt,vx(n)];return r=r||(typeof n=="object"?void 0:yt(n)),new fs(o,e||Ff(),r||null,i)}var Un=class n{static{this.THROW_IF_NOT_FOUND=ls}static{this.NULL=new jc}static create(e,t){if(Array.isArray(e))return aI({name:""},t,e,"");{let r=e.name??"";return aI({name:r},e.parent,e.providers,r)}}static{this.\u0275prov=Ke({token:n,providedIn:"any",factory:()=>qt($I)})}static{this.__NG_ELEMENT_ID__=-1}};var _R=new me("");_R.__NG_ELEMENT_ID__=n=>{let e=ft();if(e===null)throw new de(204,!1);if(e.type&2)return e.value;if(n&oe.Optional)return null;throw new de(204,!1)};var IR="ngOriginalError";function Ah(n){return n[IR]}var Uw=!0,Bw=(()=>{class n{static{this.__NG_ELEMENT_ID__=wR}static{this.__NG_ENV_ID__=t=>t}}return n})(),Jh=class extends Bw{constructor(e){super(),this._lView=e}onDestroy(e){return gw(this._lView,e),()=>jx(this._lView,e)}};function wR(){return new Jh(fe())}var gu=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new rs(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static{this.\u0275prov=Ke({token:n,providedIn:"root",factory:()=>new n})}}return n})();var Zh=class extends Nn{constructor(e=!1){super(),this.destroyRef=void 0,this.pendingTasks=void 0,this.__isAsync=e,Nx()&&(this.destroyRef=ve(Bw,{optional:!0})??void 0,this.pendingTasks=ve(gu,{optional:!0})??void 0)}emit(e){let t=ue(null);try{super.next(e)}finally{ue(t)}}subscribe(e,t,r){let i=e,o=t||(()=>null),s=r;if(e&&typeof e=="object"){let u=e;i=u.next?.bind(u),o=u.error?.bind(u),s=u.complete?.bind(u)}this.__isAsync&&(o=this.wrapInTimeout(o),i&&(i=this.wrapInTimeout(i)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:i,error:o,complete:s});return e instanceof Oe&&e.add(a),a}wrapInTimeout(e){return t=>{let r=this.pendingTasks?.add();setTimeout(()=>{e(t),r!==void 0&&this.pendingTasks?.remove(r)})}}},cn=Zh;function Qc(...n){}function $w(n){let e,t;function r(){n=Qc;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),r()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),r()})),()=>r()}function cI(n){return queueMicrotask(()=>n()),()=>{n=Qc}}var Qf="isAngularZone",Yc=Qf+"_ID",ER=0,$e=class n{constructor(e){this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new cn(!1),this.onMicrotaskEmpty=new cn(!1),this.onStable=new cn(!1),this.onError=new cn(!1);let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:o=Uw}=e;if(typeof Zone>"u")throw new de(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!i&&r,s.shouldCoalesceRunChangeDetection=i,s.callbackScheduled=!1,s.scheduleInRootZone=o,CR(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(Qf)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new de(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new de(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+i,e,TR,Qc,Qc);try{return o.runTask(s,t,r)}finally{o.cancelTask(s)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},TR={};function Yf(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function bR(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){$w(()=>{n.callbackScheduled=!1,Xh(n),n.isCheckStableRunning=!0,Yf(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),Xh(n)}function CR(n){let e=()=>{bR(n)},t=ER++;n._inner=n._inner.fork({name:"angular",properties:{[Qf]:!0,[Yc]:t,[Yc+t]:!0},onInvokeTask:(r,i,o,s,a,u)=>{if(DR(u))return r.invokeTask(o,s,a,u);try{return uI(n),r.invokeTask(o,s,a,u)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),lI(n)}},onInvoke:(r,i,o,s,a,u,l)=>{try{return uI(n),r.invoke(o,s,a,u,l)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!SR(u)&&e(),lI(n)}},onHasTask:(r,i,o,s)=>{r.hasTask(o,s),i===o&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,Xh(n),Yf(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(r,i,o,s)=>(r.handleError(o,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function Xh(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function uI(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function lI(n){n._nesting--,Yf(n)}var ef=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new cn,this.onMicrotaskEmpty=new cn,this.onStable=new cn,this.onError=new cn}run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function DR(n){return qw(n,"__ignore_ng_zone__")}function SR(n){return qw(n,"__scheduler_tick__")}function qw(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var ji=class{constructor(){this._console=console}handleError(e){let t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&Ah(e);for(;t&&Ah(t);)t=Ah(t);return t||null}},AR=new me("",{providedIn:"root",factory:()=>{let n=ve($e),e=ve(ji);return t=>n.runOutsideAngular(()=>e.handleError(t))}});function NR(){return zi(ft(),fe())}function zi(n,e){return new yu(Ct(n,e))}var yu=(()=>{class n{constructor(t){this.nativeElement=t}static{this.__NG_ELEMENT_ID__=NR}}return n})();function xR(n){return n instanceof yu?n.nativeElement:n}function RR(){return this._results[Symbol.iterator]()}var tf=class n{get changes(){return this._changes??=new cn}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._onDirty=void 0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;let t=n.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=RR)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;let r=JN(e);(this._changesDetected=!YN(this._results,r,t))&&(this._results=r,this.length=r.length,this.last=r[this.length-1],this.first=r[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}};function Hw(n){return(n.flags&128)===128}var zw=new Map,PR=0;function MR(){return PR++}function kR(n){zw.set(n[du],n)}function nf(n){zw.delete(n[du])}var dI="__ngContext__";function jr(n,e){Ln(e)?(n[dI]=e[du],kR(e)):n[dI]=e}function Gw(n){return Kw(n[ps])}function Ww(n){return Kw(n[Pt])}function Kw(n){for(;n!==null&&!hn(n);)n=n[Pt];return n}var rf;function pH(n){rf=n}function OR(){if(rf!==void 0)return rf;if(typeof document<"u")return document;throw new de(210,!1)}var mH=new me("",{providedIn:"root",factory:()=>LR}),LR="ng",VR=new me(""),Qw=new me("",{providedIn:"platform",factory:()=>"unknown"});var gH=new me("",{providedIn:"root",factory:()=>OR().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var FR="h",jR="b";var UR=()=>null;function Jf(n,e,t=!1){return UR(n,e,t)}var Yw=!1,BR=new me("",{providedIn:"root",factory:()=>Yw});var Jc=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${xI})`}};function Jw(n){return n instanceof Jc?n.changingThisBreaksApplicationSecurity:n}function $R(n,e){let t=qR(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${xI})`)}return t===e}function qR(n){return n instanceof Jc&&n.getTypeName()||null}var HR=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function zR(n){return n=String(n),n.match(HR)?n:"unsafe:"+n}var Zw=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(Zw||{});function yH(n){let e=GR();return e?e.sanitize(Zw.URL,n)||"":$R(n,"URL")?Jw(n):zR(uu(n))}function GR(){let n=fe();return n&&n[Ht].sanitizer}function vH(n){return n.ownerDocument}function Xw(n){return n instanceof Function?n():n}var of=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(of||{}),WR;function Zf(n,e){return WR(n,e)}function Pi(n,e,t,r,i){if(r!=null){let o,s=!1;hn(r)?o=r:Ln(r)&&(s=!0,r=r[dn]);let a=Gt(r);n===0&&t!==null?i==null?iE(e,t,a):Zc(e,t,a,i||null,!0):n===1&&t!==null?Zc(e,t,a,i||null,!0):n===2?c0(e,a,s):n===3&&e.destroyNode(a),o!=null&&l0(e,n,o,t,i)}}function KR(n,e){return n.createText(e)}function QR(n,e,t){n.setValue(e,t)}function eE(n,e,t){return n.createElement(e,t)}function YR(n,e){tE(n,e),e[dn]=null,e[Ot]=null}function JR(n,e,t,r,i,o){r[dn]=i,r[Ot]=e,vu(n,r,t,1,i,o)}function tE(n,e){e[Ht].changeDetectionScheduler?.notify(9),vu(n,e,e[qe],2,null,null)}function ZR(n){let e=n[ps];if(!e)return Nh(n[Z],n);for(;e;){let t=null;if(Ln(e))t=e[ps];else{let r=e[vt];r&&(t=r)}if(!t){for(;e&&!e[Pt]&&e!==n;)Ln(e)&&Nh(e[Z],e),e=e[et];e===null&&(e=n),Ln(e)&&Nh(e[Z],e),t=e&&e[Pt]}e=t}}function XR(n,e,t,r){let i=vt+r,o=t.length;r>0&&(t[i-1][Pt]=e),r<o-vt?(e[Pt]=t[i],BI(t,vt+r,e)):(t.push(e),e[Pt]=null),e[et]=t;let s=e[Mr];s!==null&&t!==s&&nE(s,e);let a=e[un];a!==null&&a.insertView(n),zh(e),e[W]|=128}function nE(n,e){let t=n[Fi],r=e[et];if(Ln(r))n[W]|=qc.HasTransplantedViews;else{let i=r[et][zt];e[zt]!==i&&(n[W]|=qc.HasTransplantedViews)}t===null?n[Fi]=[e]:t.push(e)}function Xf(n,e){let t=n[Fi],r=t.indexOf(e);t.splice(r,1)}function sf(n,e){if(n.length<=vt)return;let t=vt+e,r=n[t];if(r){let i=r[Mr];i!==null&&i!==n&&Xf(i,r),e>0&&(n[t-1][Pt]=r[Pt]);let o=Vc(n,vt+e);YR(r[Z],r);let s=o[un];s!==null&&s.detachView(o[Z]),r[et]=null,r[Pt]=null,r[W]&=-129}return r}function rE(n,e){if(!(e[W]&256)){let t=e[qe];t.destroyNode&&vu(n,e,t,3,null,null),ZR(e)}}function Nh(n,e){if(e[W]&256)return;let t=ue(null);try{e[W]&=-129,e[W]|=256,e[bt]&&Jd(e[bt]),t0(n,e),e0(n,e),e[Z].type===1&&e[qe].destroy();let r=e[Mr];if(r!==null&&hn(e[et])){r!==e[et]&&Xf(r,e);let i=e[un];i!==null&&i.detachView(n)}nf(e)}finally{ue(t)}}function e0(n,e){let t=n.cleanup,r=e[Bc];if(t!==null)for(let o=0;o<t.length-1;o+=2)if(typeof t[o]=="string"){let s=t[o+3];s>=0?r[s]():r[-s].unsubscribe(),o+=2}else{let s=r[t[o+1]];t[o].call(s)}r!==null&&(e[Bc]=null);let i=e[On];if(i!==null){e[On]=null;for(let o=0;o<i.length;o++){let s=i[o];s()}}}function t0(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof Vr)){let o=t[r+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let a=i[o[s]],u=o[s+1];Bt(4,a,u);try{u.call(a)}finally{Bt(5,a,u)}}else{Bt(4,i,o);try{o.call(i)}finally{Bt(5,i,o)}}}}}function n0(n,e,t){return r0(n,e.parent,t)}function r0(n,e,t){let r=e;for(;r!==null&&r.type&168;)e=r,r=e.parent;if(r===null)return t[dn];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:o}=n.data[r.directiveStart+i];if(o===ds.None||o===ds.Emulated)return null}return Ct(r,t)}}function Zc(n,e,t,r,i){n.insertBefore(e,t,r,i)}function iE(n,e,t){n.appendChild(e,t)}function hI(n,e,t,r,i){r!==null?Zc(n,e,t,r,i):iE(n,e,t)}function oE(n,e){return n.parentNode(e)}function i0(n,e){return n.nextSibling(e)}function o0(n,e,t){return a0(n,e,t)}function s0(n,e,t){return n.type&40?Ct(n,t):null}var a0=s0,fI;function ep(n,e,t,r){let i=n0(n,r,e),o=e[qe],s=r.parent||e[Ot],a=o0(s,r,e);if(i!=null)if(Array.isArray(t))for(let u=0;u<t.length;u++)hI(o,i,t[u],a,!1);else hI(o,i,t,a,!1);fI!==void 0&&fI(o,r,e,t,i)}function as(n,e){if(e!==null){let t=e.type;if(t&3)return Ct(e,n);if(t&4)return af(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return as(n,r);{let i=n[e.index];return hn(i)?af(-1,i):Gt(i)}}else{if(t&128)return as(n,e.next);if(t&32)return Zf(e,n)()||Gt(n[e.index]);{let r=sE(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=Or(n[zt]);return as(i,r)}else return as(n,e.next)}}}return null}function sE(n,e){if(e!==null){let r=n[zt][Ot],i=e.projection;return r.projection[i]}return null}function af(n,e){let t=vt+n+1;if(t<e.length){let r=e[t],i=r[Z].firstChild;if(i!==null)return as(r,i)}return e[kr]}function c0(n,e,t){n.removeChild(null,e,t)}function tp(n,e,t,r,i,o,s){for(;t!=null;){if(t.type===128){t=t.next;continue}let a=r[t.index],u=t.type;if(s&&e===0&&(a&&jr(Gt(a),r),t.flags|=2),(t.flags&32)!==32)if(u&8)tp(n,e,t.child,r,i,o,!1),Pi(e,n,i,a,o);else if(u&32){let l=Zf(t,r),h;for(;h=l();)Pi(e,n,i,h,o);Pi(e,n,i,a,o)}else u&16?u0(n,e,r,t,i,o):Pi(e,n,i,a,o);t=s?t.projectionNext:t.next}}function vu(n,e,t,r,i,o){tp(t,r,n.firstChild,e,i,o,!1)}function u0(n,e,t,r,i,o){let s=t[zt],u=s[Ot].projection[r.projection];if(Array.isArray(u))for(let l=0;l<u.length;l++){let h=u[l];Pi(e,n,i,h,o)}else{let l=u,h=s[et];Hw(r)&&(l.flags|=128),tp(n,e,l,h,i,o,!0)}}function l0(n,e,t,r,i){let o=t[kr],s=Gt(t);o!==s&&Pi(e,n,r,o,i);for(let a=vt;a<t.length;a++){let u=t[a];vu(u[Z],u,n,e,r,o)}}function d0(n,e,t,r,i){if(e)i?n.addClass(t,r):n.removeClass(t,r);else{let o=r.indexOf("-")===-1?void 0:of.DashCase;i==null?n.removeStyle(t,r,o):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),o|=of.Important),n.setStyle(t,r,i,o))}}function h0(n,e,t){n.setAttribute(e,"style",t)}function aE(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function cE(n,e,t){let{mergedAttrs:r,classes:i,styles:o}=t;r!==null&&jh(n,e,r),i!==null&&aE(n,e,i),o!==null&&h0(n,e,o)}var Hr={};function _H(n=1){uE(tt(),fe(),Hi()+n,!1)}function uE(n,e,t,r){if(!r)if((e[W]&3)===3){let o=n.preOrderCheckHooks;o!==null&&xc(e,o,t)}else{let o=n.preOrderHooks;o!==null&&Rc(e,o,0,t)}Lr(t)}function _u(n,e=oe.Default){let t=fe();if(t===null)return qt(n,e);let r=ft();return Lw(r,t,lt(n),e)}function lE(n,e,t,r,i,o){let s=ue(null);try{let a=null;i&Vn.SignalBased&&(a=e[r][an]),a!==null&&a.transformFn!==void 0&&(o=a.transformFn(o)),i&Vn.HasDecoratorInputTransform&&(o=n.inputTransforms[r].call(e,o)),n.setInput!==null?n.setInput(e,a,o,t,r):sw(e,a,r,o)}finally{ue(s)}}function f0(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)Lr(~i);else{let o=i,s=t[++r],a=t[++r];Xx(s,o);let u=e[o];a(2,u)}}}finally{Lr(-1)}}function Iu(n,e,t,r,i,o,s,a,u,l,h){let p=e.blueprint.slice();return p[dn]=i,p[W]=r|4|128|8|64,(l!==null||n&&n[W]&2048)&&(p[W]|=2048),pw(p),p[et]=p[qi]=n,p[Mt]=t,p[Ht]=s||n&&n[Ht],p[qe]=a||n&&n[qe],p[Vi]=u||n&&n[Vi]||null,p[Ot]=o,p[du]=MR(),p[Uc]=h,p[rw]=l,p[zt]=e.type==2?n[zt]:p,p}function wu(n,e,t,r,i){let o=n.data[e];if(o===null)o=p0(n,e,t,r,i),Zx()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=r,o.attrs=i;let s=Gx();o.injectorIndex=s===null?-1:s.injectorIndex}return ws(o,!0),o}function p0(n,e,t,r,i){let o=_w(),s=Iw(),a=s?o:o&&o.parent,u=n.data[e]=I0(n,a,t,e,r,i);return n.firstChild===null&&(n.firstChild=u),o!==null&&(s?o.child==null&&u.parent!==null&&(o.child=u):o.next===null&&(o.next=u,u.prev=o)),u}function dE(n,e,t,r){if(t===0)return-1;let i=e.length;for(let o=0;o<t;o++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function hE(n,e,t,r,i){let o=Hi(),s=r&2;try{Lr(-1),s&&e.length>kt&&uE(n,e,kt,!1),Bt(s?2:0,i),t(r,i)}finally{Lr(o),Bt(s?3:1,i)}}function fE(n,e,t){if(ow(e)){let r=ue(null);try{let i=e.directiveStart,o=e.directiveEnd;for(let s=i;s<o;s++){let a=n.data[s];if(a.contentQueries){let u=t[s];a.contentQueries(1,u,s)}}}finally{ue(r)}}}function pE(n,e,t){vw()&&(D0(n,e,t,Ct(t,e)),(t.flags&64)===64&&IE(n,e,t))}function mE(n,e,t=Ct){let r=e.localNames;if(r!==null){let i=e.index+1;for(let o=0;o<r.length;o+=2){let s=r[o+1],a=s===-1?t(e,n):n[s];n[i++]=a}}}function gE(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=np(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function np(n,e,t,r,i,o,s,a,u,l,h){let p=kt+r,g=p+i,y=m0(p,g),D=typeof l=="function"?l():l;return y[Z]={type:n,blueprint:y,template:t,queries:null,viewQuery:a,declTNode:e,data:y.slice().fill(null,p),bindingStartIndex:p,expandoStartIndex:g,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:u,consts:D,incompleteFirstPass:!1,ssrId:h}}function m0(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:Hr);return t}function g0(n,e,t,r){let o=r.get(BR,Yw)||t===ds.ShadowDom,s=n.selectRootElement(e,o);return y0(s),s}function y0(n){v0(n)}var v0=()=>null;function _0(n,e,t,r){let i=TE(e);i.push(t),n.firstCreatePass&&bE(n).push(r,i.length-1)}function I0(n,e,t,r,i,o){let s=e?e.injectorIndex:-1,a=0;return qx()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function pI(n,e,t,r,i){for(let o in e){if(!e.hasOwnProperty(o))continue;let s=e[o];if(s===void 0)continue;r??={};let a,u=Vn.None;Array.isArray(s)?(a=s[0],u=s[1]):a=s;let l=o;if(i!==null){if(!i.hasOwnProperty(o))continue;l=i[o]}n===0?mI(r,t,l,a,u):mI(r,t,l,a)}return r}function mI(n,e,t,r,i){let o;n.hasOwnProperty(t)?(o=n[t]).push(e,r):o=n[t]=[e,r],i!==void 0&&o.push(i)}function w0(n,e,t){let r=e.directiveStart,i=e.directiveEnd,o=n.data,s=e.attrs,a=[],u=null,l=null;for(let h=r;h<i;h++){let p=o[h],g=t?t.get(p):null,y=g?g.inputs:null,D=g?g.outputs:null;u=pI(0,p.inputs,h,u,y),l=pI(1,p.outputs,h,l,D);let R=u!==null&&s!==null&&!Lf(e)?V0(u,h,s):null;a.push(R)}u!==null&&(u.hasOwnProperty("class")&&(e.flags|=8),u.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=u,e.outputs=l}function E0(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function yE(n,e,t,r,i,o,s,a){let u=Ct(e,t),l=e.inputs,h;!a&&l!=null&&(h=l[r])?(rp(n,t,h,r,i),hu(e)&&T0(t,e.index)):e.type&3?(r=E0(r),i=s!=null?s(i,e.value||"",r):i,o.setProperty(u,r,i)):e.type&12}function T0(n,e){let t=Bn(e,n);t[W]&16||(t[W]|=64)}function vE(n,e,t,r){if(vw()){let i=r===null?null:{"":-1},o=A0(n,t),s,a;o===null?s=a=null:[s,a]=o,s!==null&&_E(n,e,t,s,i,a),i&&N0(t,r,i)}t.mergedAttrs=hs(t.mergedAttrs,t.attrs)}function _E(n,e,t,r,i,o){for(let l=0;l<r.length;l++)Qh(Kc(t,e),n,r[l].type);R0(t,n.data.length,r.length);for(let l=0;l<r.length;l++){let h=r[l];h.providersResolver&&h.providersResolver(h)}let s=!1,a=!1,u=dE(n,e,r.length,null);for(let l=0;l<r.length;l++){let h=r[l];t.mergedAttrs=hs(t.mergedAttrs,h.hostAttrs),P0(n,t,e,u,h),x0(u,h,i),h.contentQueries!==null&&(t.flags|=4),(h.hostBindings!==null||h.hostAttrs!==null||h.hostVars!==0)&&(t.flags|=64);let p=h.type.prototype;!s&&(p.ngOnChanges||p.ngOnInit||p.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),s=!0),!a&&(p.ngOnChanges||p.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),u++}w0(n,t,o)}function b0(n,e,t,r,i){let o=i.hostBindings;if(o){let s=n.hostBindingOpCodes;s===null&&(s=n.hostBindingOpCodes=[]);let a=~e.index;C0(s)!=a&&s.push(a),s.push(t,r,o)}}function C0(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function D0(n,e,t,r){let i=t.directiveStart,o=t.directiveEnd;hu(t)&&M0(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||Kc(t,e),jr(r,e);let s=t.initialInputs;for(let a=i;a<o;a++){let u=n.data[a],l=Fr(e,n,a,t);if(jr(l,e),s!==null&&L0(e,a-i,l,u,t,s),jn(u)){let h=Bn(t.index,e);h[Mt]=Fr(e,n,a,t)}}}function IE(n,e,t){let r=t.directiveStart,i=t.directiveEnd,o=t.index,s=eR();try{Lr(o);for(let a=r;a<i;a++){let u=n.data[a],l=e[a];Gh(a),(u.hostBindings!==null||u.hostVars!==0||u.hostAttrs!==null)&&S0(u,l)}}finally{Lr(-1),Gh(s)}}function S0(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function A0(n,e){let t=n.directiveRegistry,r=null,i=null;if(t)for(let o=0;o<t.length;o++){let s=t[o];if(cx(e,s.selectors,!1))if(r||(r=[]),jn(s))if(s.findHostDirectiveDefs!==null){let a=[];i=i||new Map,s.findHostDirectiveDefs(s,a,i),r.unshift(...a,s);let u=a.length;cf(n,e,u)}else r.unshift(s),cf(n,e,0);else i=i||new Map,s.findHostDirectiveDefs?.(s,r,i),r.push(s)}return r===null?null:[r,i]}function cf(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function N0(n,e,t){if(e){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let o=t[e[i+1]];if(o==null)throw new de(-301,!1);r.push(e[i],o)}}}function x0(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;jn(e)&&(t[""]=n)}}function R0(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function P0(n,e,t,r,i){n.data[r]=i;let o=i.factory||(i.factory=Rr(i.type,!0)),s=new Vr(o,jn(i),_u);n.blueprint[r]=s,t[r]=s,b0(n,e,r,dE(n,t,i.hostVars,Hr),i)}function M0(n,e,t){let r=Ct(e,n),i=gE(t),o=n[Ht].rendererFactory,s=16;t.signals?s=4096:t.onPush&&(s=64);let a=Eu(n,Iu(n,i,null,s,r,e,null,o.createRenderer(r,t),null,null,null));n[e.index]=a}function k0(n,e,t,r,i,o){let s=Ct(n,e);O0(e[qe],s,o,n.value,t,r,i)}function O0(n,e,t,r,i,o,s){if(o==null)n.removeAttribute(e,i,t);else{let a=s==null?uu(o):s(o,r||"",i);n.setAttribute(e,i,a,t)}}function L0(n,e,t,r,i,o){let s=o[e];if(s!==null)for(let a=0;a<s.length;){let u=s[a++],l=s[a++],h=s[a++],p=s[a++];lE(r,t,u,l,h,p)}}function V0(n,e,t){let r=null,i=0;for(;i<t.length;){let o=t[i];if(o===0){i+=4;continue}else if(o===5){i+=2;continue}if(typeof o=="number")break;if(n.hasOwnProperty(o)){r===null&&(r=[]);let s=n[o];for(let a=0;a<s.length;a+=3)if(s[a]===e){r.push(o,s[a+1],s[a+2],t[i+1]);break}}i+=2}return r}function wE(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function EE(n,e){let t=n.contentQueries;if(t!==null){let r=ue(null);try{for(let i=0;i<t.length;i+=2){let o=t[i],s=t[i+1];if(s!==-1){let a=n.data[s];Bf(o),a.contentQueries(2,e[s],s)}}}finally{ue(r)}}}function Eu(n,e){return n[ps]?n[tI][Pt]=e:n[ps]=e,n[tI]=e,e}function uf(n,e,t){Bf(0);let r=ue(null);try{e(n,t)}finally{ue(r)}}function TE(n){return n[Bc]??=[]}function bE(n){return n.cleanup??=[]}function CE(n,e){let t=n[Vi],r=t?t.get(ji,null):null;r&&r.handleError(e)}function rp(n,e,t,r,i){for(let o=0;o<t.length;){let s=t[o++],a=t[o++],u=t[o++],l=e[s],h=n.data[s];lE(h,l,r,a,u,i)}}function F0(n,e,t){let r=dw(e,n);QR(n[qe],r,t)}function j0(n,e){let t=Bn(e,n),r=t[Z];U0(r,t);let i=t[dn];i!==null&&t[Uc]===null&&(t[Uc]=Jf(i,t[Vi])),ip(r,t,t[Mt])}function U0(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function ip(n,e,t){$f(e);try{let r=n.viewQuery;r!==null&&uf(1,r,t);let i=n.template;i!==null&&hE(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[un]?.finishViewCreation(n),n.staticContentQueries&&EE(n,e),n.staticViewQueries&&uf(2,n.viewQuery,t);let o=n.components;o!==null&&B0(e,o)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[W]&=-5,qf()}}function B0(n,e){for(let t=0;t<e.length;t++)j0(n,e[t])}function $0(n,e,t,r){let i=ue(null);try{let o=e.tView,a=n[W]&4096?4096:16,u=Iu(n,o,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),l=n[e.index];u[Mr]=l;let h=n[un];return h!==null&&(u[un]=h.createEmbeddedView(o)),ip(o,u,t),u}finally{ue(i)}}function gI(n,e){return!e||e.firstChild===null||Hw(n)}function q0(n,e,t,r=!0){let i=e[Z];if(XR(i,e,n,t),r){let s=af(t,n),a=e[qe],u=oE(a,n[kr]);u!==null&&JR(i,n[Ot],a,e,u,s)}let o=e[Uc];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function Xc(n,e,t,r,i=!1){for(;t!==null;){if(t.type===128){t=i?t.projectionNext:t.next;continue}let o=e[t.index];o!==null&&r.push(Gt(o)),hn(o)&&H0(o,r);let s=t.type;if(s&8)Xc(n,e,t.child,r);else if(s&32){let a=Zf(t,e),u;for(;u=a();)r.push(u)}else if(s&16){let a=sE(e,t);if(Array.isArray(a))r.push(...a);else{let u=Or(e[zt]);Xc(u[Z],u,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function H0(n,e){for(let t=vt;t<n.length;t++){let r=n[t],i=r[Z].firstChild;i!==null&&Xc(r[Z],r,i,e)}n[kr]!==n[dn]&&e.push(n[kr])}var DE=[];function z0(n){return n[bt]??G0(n)}function G0(n){let e=DE.pop()??Object.create(K0);return e.lView=n,e}function W0(n){n.lView[bt]!==n&&(n.lView=null,DE.push(n))}var K0=Ut(jt({},ns),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{pu(n.lView)},consumerOnSignalRead(){this.lView[bt]=this}});function Q0(n){let e=n[bt]??Object.create(Y0);return e.lView=n,e}var Y0=Ut(jt({},ns),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{let e=Or(n.lView);for(;e&&!SE(e[Z]);)e=Or(e);e&&mw(e)},consumerOnSignalRead(){this.lView[bt]=this}});function SE(n){return n.type!==2}var J0=100;function AE(n,e=!0,t=0){let r=n[Ht],i=r.rendererFactory,o=!1;o||i.begin?.();try{Z0(n,t)}catch(s){throw e&&CE(n,s),s}finally{o||(i.end?.(),r.inlineEffectRunner?.flush())}}function Z0(n,e){let t=ww();try{rI(!0),lf(n,e);let r=0;for(;fu(n);){if(r===J0)throw new de(103,!1);r++,lf(n,1)}}finally{rI(t)}}function X0(n,e,t,r){let i=e[W];if((i&256)===256)return;let o=!1,s=!1;!o&&e[Ht].inlineEffectRunner?.flush(),$f(e);let a=!0,u=null,l=null;o||(SE(n)?(l=z0(e),u=Wa(l)):i_()===null?(a=!1,l=Q0(e),u=Wa(l)):e[bt]&&(Jd(e[bt]),e[bt]=null));try{pw(e),Yx(n.bindingStartIndex),t!==null&&hE(n,e,t,2,r);let h=(i&3)===3;if(!o)if(h){let y=n.preOrderCheckHooks;y!==null&&xc(e,y,null)}else{let y=n.preOrderHooks;y!==null&&Rc(e,y,0,null),Ch(e,0)}if(s||eP(e),NE(e,0),n.contentQueries!==null&&EE(n,e),!o)if(h){let y=n.contentCheckHooks;y!==null&&xc(e,y)}else{let y=n.contentHooks;y!==null&&Rc(e,y,1),Ch(e,1)}f0(n,e);let p=n.components;p!==null&&RE(e,p,0);let g=n.viewQuery;if(g!==null&&uf(2,g,r),!o)if(h){let y=n.viewCheckHooks;y!==null&&xc(e,y)}else{let y=n.viewHooks;y!==null&&Rc(e,y,2),Ch(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[bh]){for(let y of e[bh])y();e[bh]=null}o||(e[W]&=-73)}catch(h){throw o||pu(e),h}finally{l!==null&&(Qd(l,u),a&&W0(l)),qf()}}function NE(n,e){for(let t=Gw(n);t!==null;t=Ww(t))for(let r=vt;r<t.length;r++){let i=t[r];xE(i,e)}}function eP(n){for(let e=Gw(n);e!==null;e=Ww(e)){if(!(e[W]&qc.HasTransplantedViews))continue;let t=e[Fi];for(let r=0;r<t.length;r++){let i=t[r];mw(i)}}}function tP(n,e,t){let r=Bn(e,n);xE(r,t)}function xE(n,e){Uf(n)&&lf(n,e)}function lf(n,e){let r=n[Z],i=n[W],o=n[bt],s=!!(e===0&&i&16);if(s||=!!(i&64&&e===0),s||=!!(i&1024),s||=!!(o?.dirty&&Yd(o)),s||=!1,o&&(o.dirty=!1),n[W]&=-9217,s)X0(r,n,r.template,n[Mt]);else if(i&8192){NE(n,1);let a=r.components;a!==null&&RE(n,a,1)}}function RE(n,e,t){for(let r=0;r<e.length;r++)tP(n,e[r],t)}function op(n,e){let t=ww()?64:1088;for(n[Ht].changeDetectionScheduler?.notify(e);n;){n[W]|=t;let r=Or(n);if(qh(n)&&!r)return n;n=r}return null}var Ur=class{get rootNodes(){let e=this._lView,t=e[Z];return Xc(t,e,t.firstChild,[])}constructor(e,t,r=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Mt]}set context(e){this._lView[Mt]=e}get destroyed(){return(this._lView[W]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[et];if(hn(e)){let t=e[$c],r=t?t.indexOf(this):-1;r>-1&&(sf(e,r),Vc(t,r))}this._attachedToViewContainer=!1}rE(this._lView[Z],this._lView)}onDestroy(e){gw(this._lView,e)}markForCheck(){op(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[W]&=-129}reattach(){zh(this._lView),this._lView[W]|=128}detectChanges(){this._lView[W]|=1024,AE(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new de(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=qh(this._lView),t=this._lView[Mr];t!==null&&!e&&Xf(t,this._lView),tE(this._lView[Z],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new de(902,!1);this._appRef=e;let t=qh(this._lView),r=this._lView[Mr];r!==null&&!t&&nE(r,this._lView),zh(this._lView)}},eu=(()=>{class n{static{this.__NG_ELEMENT_ID__=iP}}return n})(),nP=eu,rP=class extends nP{constructor(e,t,r){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,r){let i=$0(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:r});return new Ur(i)}};function iP(){return sp(ft(),fe())}function sp(n,e){return n.type&4?new rP(e,n,zi(n,e)):null}var wH=new RegExp(`^(\\d+)*(${jR}|${FR})*(.*)`);var oP=()=>null;function yI(n,e){return oP(n,e)}var Ui=class{},ap=new me("",{providedIn:"root",factory:()=>!1});var PE=new me(""),ME=new me(""),df=class{},tu=class{};function sP(n){let e=Error(`No component factory found for ${yt(n)}.`);return e[aP]=n,e}var aP="ngComponent";var hf=class{resolveComponentFactory(e){throw sP(e)}},Bi=class{static{this.NULL=new hf}},nu=class{},EH=(()=>{class n{constructor(){this.destroyNode=null}static{this.__NG_ELEMENT_ID__=()=>cP()}}return n})();function cP(){let n=fe(),e=ft(),t=Bn(e.index,n);return(Ln(t)?t:n)[qe]}var uP=(()=>{class n{static{this.\u0275prov=Ke({token:n,providedIn:"root",factory:()=>null})}}return n})();function ff(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,o=0;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];if(typeof a=="number")o=a;else if(o==1)i=z_(i,a);else if(o==2){let u=a,l=e[++s];r=z_(r,u+": "+l+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}var ru=class extends Bi{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=Pr(e);return new ms(t,this.ngModule)}};function vI(n,e){let t=[];for(let r in n){if(!n.hasOwnProperty(r))continue;let i=n[r];if(i===void 0)continue;let o=Array.isArray(i),s=o?i[0]:i,a=o?i[1]:Vn.None;e?t.push({propName:s,templateName:r,isSignal:(a&Vn.SignalBased)!==0}):t.push({propName:s,templateName:r})}return t}function lP(n){let e=n.toLowerCase();return e==="svg"?lw:e==="math"?Ox:null}var ms=class extends tu{get inputs(){let e=this.componentDef,t=e.inputTransforms,r=vI(e.inputs,!0);if(t!==null)for(let i of r)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return r}get outputs(){return vI(this.componentDef.outputs,!1)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=hx(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,r,i){let o=ue(null);try{i=i||this.ngModule;let s=i instanceof Fn?i:i?.injector;s&&this.componentDef.getStandaloneInjector!==null&&(s=this.componentDef.getStandaloneInjector(s)||s);let a=s?new Wh(e,s):e,u=a.get(nu,null);if(u===null)throw new de(407,!1);let l=a.get(uP,null),h=a.get(Ui,null),p={rendererFactory:u,sanitizer:l,inlineEffectRunner:null,changeDetectionScheduler:h},g=u.createRenderer(null,this.componentDef),y=this.componentDef.selectors[0][0]||"div",D=r?g0(g,r,this.componentDef.encapsulation,a):eE(g,y,lP(y)),R=512;this.componentDef.signals?R|=4096:this.componentDef.onPush||(R|=16);let P=null;D!==null&&(P=Jf(D,a,!0));let O=np(0,null,null,1,0,null,null,null,null,null,null),B=Iu(null,O,null,R,null,null,p,g,a,null,P);$f(B);let U,G,te=null;try{let H=this.componentDef,E,v=null;H.findHostDirectiveDefs?(E=[],v=new Map,H.findHostDirectiveDefs(H,E,v),E.push(H)):E=[H];let _=dP(B,D);te=hP(_,D,H,E,B,p,g),G=hw(O,kt),D&&mP(g,H,D,r),t!==void 0&&gP(G,this.ngContentSelectors,t),U=pP(te,H,E,v,B,[yP]),ip(O,B,null)}catch(H){throw te!==null&&nf(te),nf(B),H}finally{qf()}return new pf(this.componentType,U,zi(G,B),B,G)}finally{ue(o)}}},pf=class extends df{constructor(e,t,r,i,o){super(),this.location=r,this._rootLView=i,this._tNode=o,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new Ur(i,void 0,!1),this.componentType=e}setInput(e,t){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let o=this._rootLView;rp(o[Z],o,i,e,t),this.previousInputValues.set(e,t);let s=Bn(this._tNode.index,o);op(s,1)}}get injector(){return new xr(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function dP(n,e){let t=n[Z],r=kt;return n[r]=e,wu(t,r,2,"#host",null)}function hP(n,e,t,r,i,o,s){let a=i[Z];fP(r,n,e,s);let u=null;e!==null&&(u=Jf(e,i[Vi]));let l=o.rendererFactory.createRenderer(e,t),h=16;t.signals?h=4096:t.onPush&&(h=64);let p=Iu(i,gE(t),null,h,i[n.index],n,o,l,null,null,u);return a.firstCreatePass&&cf(a,n,r.length-1),Eu(i,p),i[n.index]=p}function fP(n,e,t,r){for(let i of n)e.mergedAttrs=hs(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(ff(e,e.mergedAttrs,!0),t!==null&&cE(r,t,e))}function pP(n,e,t,r,i,o){let s=ft(),a=i[Z],u=Ct(s,i);_E(a,i,s,t,null,r);for(let h=0;h<t.length;h++){let p=s.directiveStart+h,g=Fr(i,a,p,s);jr(g,i)}IE(a,i,s),u&&jr(u,i);let l=Fr(i,a,s.directiveStart+s.componentOffset,s);if(n[Mt]=i[Mt]=l,o!==null)for(let h of o)h(l,e);return fE(a,s,i),l}function mP(n,e,t,r){if(r)jh(n,t,["ng-version","18.2.14"]);else{let{attrs:i,classes:o}=fx(e.selectors[0]);i&&jh(n,t,i),o&&o.length>0&&aE(n,t,o.join(" "))}}function gP(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let o=t[i];r.push(o!=null?Array.from(o):null)}}function yP(){let n=ft();Wf(fe()[Z],n)}var cp=(()=>{class n{static{this.__NG_ELEMENT_ID__=vP}}return n})();function vP(){let n=ft();return OE(n,fe())}var _P=cp,kE=class extends _P{constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return zi(this._hostTNode,this._hostLView)}get injector(){return new xr(this._hostTNode,this._hostLView)}get parentInjector(){let e=Kf(this._hostTNode,this._hostLView);if(xw(e)){let t=Gc(e,this._hostLView),r=zc(e),i=t[Z].data[r+8];return new xr(i,t)}else return new xr(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=_I(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-vt}createEmbeddedView(e,t,r){let i,o;typeof r=="number"?i=r:r!=null&&(i=r.index,o=r.injector);let s=yI(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},o,s);return this.insertImpl(a,i,gI(this._hostTNode,s)),a}createComponent(e,t,r,i,o){let s=e&&!xx(e),a;if(s)a=t;else{let D=t||{};a=D.index,r=D.injector,i=D.projectableNodes,o=D.environmentInjector||D.ngModuleRef}let u=s?e:new ms(Pr(e)),l=r||this.parentInjector;if(!o&&u.ngModule==null){let R=(s?l:this.parentInjector).get(Fn,null);R&&(o=R)}let h=Pr(u.componentType??{}),p=yI(this._lContainer,h?.id??null),g=p?.firstChild??null,y=u.create(l,i,g,o);return this.insertImpl(y.hostView,a,gI(this._hostTNode,p)),y}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(Vx(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let u=i[et],l=new kE(u,u[Ot],u[et]);l.detach(l.indexOf(e))}}let o=this._adjustIndex(t),s=this._lContainer;return q0(s,i,o,r),e.attachToViewContainerRef(),BI(xh(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=_I(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=sf(this._lContainer,t);r&&(Vc(xh(this._lContainer),t),rE(r[Z],r))}detach(e){let t=this._adjustIndex(e,-1),r=sf(this._lContainer,t);return r&&Vc(xh(this._lContainer),t)!=null?new Ur(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function _I(n){return n[$c]}function xh(n){return n[$c]||(n[$c]=[])}function OE(n,e){let t,r=e[n.index];return hn(r)?t=r:(t=wE(r,e,null,n),e[n.index]=t,Eu(e,t)),wP(t,e,n,r),new kE(t,n,e)}function IP(n,e){let t=n[qe],r=t.createComment(""),i=Ct(e,n),o=oE(t,i);return Zc(t,o,r,i0(t,i),!1),r}var wP=bP,EP=()=>!1;function TP(n,e,t){return EP(n,e,t)}function bP(n,e,t,r){if(n[kr])return;let i;t.type&8?i=Gt(r):i=IP(e,t),n[kr]=i}var mf=class n{constructor(e){this.queryList=e,this.matches=null}clone(){return new n(this.queryList)}setDirty(){this.queryList.setDirty()}},gf=class n{constructor(e=[]){this.queries=e}createEmbeddedView(e){let t=e.queries;if(t!==null){let r=e.contentQueries!==null?e.contentQueries[0]:t.length,i=[];for(let o=0;o<r;o++){let s=t.getByIndex(o),a=this.queries[s.indexInDeclarationView];i.push(a.clone())}return new n(i)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)up(e,t).matches!==null&&this.queries[t].setDirty()}},yf=class{constructor(e,t,r=null){this.flags=t,this.read=r,typeof e=="string"?this.predicate=PP(e):this.predicate=e}},vf=class n{constructor(e=[]){this.queries=e}elementStart(e,t){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let r=0;r<this.length;r++){let i=t!==null?t.length:0,o=this.getByIndex(r).embeddedTView(e,i);o&&(o.indexInDeclarationView=r,t!==null?t.push(o):t=[o])}return t!==null?new n(t):null}template(e,t){for(let r=0;r<this.queries.length;r++)this.queries[r].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},_f=class n{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new n(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let t=this._declarationNodeIndex,r=e.parent;for(;r!==null&&r.type&8&&r.index!==t;)r=r.parent;return t===(r!==null?r.index:-1)}return this._appliesToNextNode}matchTNode(e,t){let r=this.metadata.predicate;if(Array.isArray(r))for(let i=0;i<r.length;i++){let o=r[i];this.matchTNodeWithReadOption(e,t,CP(t,o)),this.matchTNodeWithReadOption(e,t,Pc(t,e,o,!1,!1))}else r===eu?t.type&4&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Pc(t,e,r,!1,!1))}matchTNodeWithReadOption(e,t,r){if(r!==null){let i=this.metadata.read;if(i!==null)if(i===yu||i===cp||i===eu&&t.type&4)this.addMatch(t.index,-2);else{let o=Pc(t,e,i,!1,!1);o!==null&&this.addMatch(t.index,o)}else this.addMatch(t.index,r)}}addMatch(e,t){this.matches===null?this.matches=[e,t]:this.matches.push(e,t)}};function CP(n,e){let t=n.localNames;if(t!==null){for(let r=0;r<t.length;r+=2)if(t[r]===e)return t[r+1]}return null}function DP(n,e){return n.type&11?zi(n,e):n.type&4?sp(n,e):null}function SP(n,e,t,r){return t===-1?DP(e,n):t===-2?AP(n,e,r):Fr(n,n[Z],t,e)}function AP(n,e,t){if(t===yu)return zi(e,n);if(t===eu)return sp(e,n);if(t===cp)return OE(e,n)}function LE(n,e,t,r){let i=e[un].queries[r];if(i.matches===null){let o=n.data,s=t.matches,a=[];for(let u=0;s!==null&&u<s.length;u+=2){let l=s[u];if(l<0)a.push(null);else{let h=o[l];a.push(SP(e,h,s[u+1],t.metadata.read))}}i.matches=a}return i.matches}function If(n,e,t,r){let i=n.queries.getByIndex(t),o=i.matches;if(o!==null){let s=LE(n,e,i,t);for(let a=0;a<o.length;a+=2){let u=o[a];if(u>0)r.push(s[a/2]);else{let l=o[a+1],h=e[-u];for(let p=vt;p<h.length;p++){let g=h[p];g[Mr]===g[et]&&If(g[Z],g,l,r)}if(h[Fi]!==null){let p=h[Fi];for(let g=0;g<p.length;g++){let y=p[g];If(y[Z],y,l,r)}}}}}return r}function NP(n,e){return n[un].queries[e].queryList}function xP(n,e,t){let r=new tf((t&4)===4);return _0(n,e,r,r.destroy),(e[un]??=new gf).queries.push(new mf(r))-1}function RP(n,e,t){let r=tt();return r.firstCreatePass&&(MP(r,new yf(n,e,t),-1),(e&2)===2&&(r.staticViewQueries=!0)),xP(r,fe(),e)}function PP(n){return n.split(",").map(e=>e.trim())}function MP(n,e,t){n.queries===null&&(n.queries=new vf),n.queries.track(new _f(e,t))}function up(n,e){return n.queries.getByIndex(e)}function kP(n,e){let t=n[Z],r=up(t,e);return r.crossesNgTemplate?If(t,n,e,[]):LE(t,n,r,e)}var II=new Set;function Tu(n){II.has(n)||(II.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}function OP(n){return typeof n=="function"&&n[an]!==void 0}function bH(n,e){Tu("NgSignals");let t=m_(n),r=t[an];return e?.equal&&(r.equal=e.equal),t.set=i=>Zd(r,i),t.update=i=>g_(r,i),t.asReadonly=LP.bind(t),t}function LP(){let n=this[an];if(n.readonlyFn===void 0){let e=()=>this();e[an]=n,n.readonlyFn=e}return n.readonlyFn}function VE(n){return OP(n)&&typeof n.set=="function"}function VP(n){return Object.getPrototypeOf(n.prototype).constructor}function FP(n){let e=VP(n.type),t=!0,r=[n];for(;e;){let i;if(jn(n))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new de(903,!1);i=e.\u0275dir}if(i){if(t){r.push(i);let s=n;s.inputs=Dc(n.inputs),s.inputTransforms=Dc(n.inputTransforms),s.declaredInputs=Dc(n.declaredInputs),s.outputs=Dc(n.outputs);let a=i.hostBindings;a&&qP(n,a);let u=i.viewQuery,l=i.contentQueries;if(u&&BP(n,u),l&&$P(n,l),jP(n,i),xN(n.outputs,i.outputs),jn(i)&&i.data.animation){let h=n.data;h.animation=(h.animation||[]).concat(i.data.animation)}}let o=i.features;if(o)for(let s=0;s<o.length;s++){let a=o[s];a&&a.ngInherit&&a(n),a===FP&&(t=!1)}}e=Object.getPrototypeOf(e)}UP(r)}function jP(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let r=e.inputs[t];if(r!==void 0&&(n.inputs[t]=r,n.declaredInputs[t]=e.declaredInputs[t],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;n.inputTransforms??={},n.inputTransforms[i]=e.inputTransforms[i]}}}function UP(n){let e=0,t=null;for(let r=n.length-1;r>=0;r--){let i=n[r];i.hostVars=e+=i.hostVars,i.hostAttrs=hs(i.hostAttrs,t=hs(t,i.hostAttrs))}}function Dc(n){return n===Oi?{}:n===Tt?[]:n}function BP(n,e){let t=n.viewQuery;t?n.viewQuery=(r,i)=>{e(r,i),t(r,i)}:n.viewQuery=e}function $P(n,e){let t=n.contentQueries;t?n.contentQueries=(r,i,o)=>{e(r,i,o),t(r,i,o)}:n.contentQueries=e}function qP(n,e){let t=n.hostBindings;t?n.hostBindings=(r,i)=>{e(r,i),t(r,i)}:n.hostBindings=e}var Br=class{},wf=class{};var Ef=class extends Br{constructor(e,t,r,i=!0){super(),this.ngModuleType=e,this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new ru(this);let o=QI(e);this._bootstrapComponents=Xw(o.bootstrap),this._r3Injector=jw(e,t,[{provide:Br,useValue:this},{provide:Bi,useValue:this.componentFactoryResolver},...r],yt(e),new Set(["environment"])),i&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Tf=class extends wf{constructor(e){super(),this.moduleType=e}create(e){return new Ef(this.moduleType,e,[])}};var iu=class extends Br{constructor(e){super(),this.componentFactoryResolver=new ru(this),this.instance=null;let t=new fs([...e.providers,{provide:Br,useValue:this},{provide:Bi,useValue:this.componentFactoryResolver}],e.parent||Ff(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function HP(n,e,t=null){return new iu({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}function FE(n){return GP(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function zP(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),r;for(;!(r=t.next()).done;)e(r.value)}}function GP(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function WP(n,e,t){return n[e]=t}function $r(n,e,t){let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function KP(n,e,t,r){let i=$r(n,e,t);return $r(n,e+1,r)||i}function QP(n){return(n.flags&32)===32}function YP(n,e,t,r,i,o,s,a,u){let l=e.consts,h=wu(e,n,4,s||null,a||null);vE(e,t,h,Hc(l,u)),Wf(e,h);let p=h.tView=np(2,h,r,i,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return e.queries!==null&&(e.queries.template(e,h),p.queries=e.queries.embeddedTView(h)),h}function JP(n,e,t,r,i,o,s,a,u,l){let h=t+kt,p=e.firstCreatePass?YP(h,e,n,r,i,o,s,a,u):e.data[h];ws(p,!1);let g=XP(e,n,p,t);zf()&&ep(e,n,g,p),jr(g,n);let y=wE(g,n,g,p);return n[h]=y,Eu(n,y),TP(y,p,n),jf(p)&&pE(e,n,p),u!=null&&mE(n,p,l),p}function ZP(n,e,t,r,i,o,s,a){let u=fe(),l=tt(),h=Hc(l.consts,o);return JP(u,l,n,e,t,r,i,h,s,a),ZP}var XP=eM;function eM(n,e,t,r){return Gf(!0),e[qe].createComment("")}var cs=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(cs||{}),tM=(()=>{class n{constructor(){this.impl=null}execute(){this.impl?.execute()}static{this.\u0275prov=Ke({token:n,providedIn:"root",factory:()=>new n})}}return n})(),wI=class n{constructor(){this.ngZone=ve($e),this.scheduler=ve(Ui),this.errorHandler=ve(ji,{optional:!0}),this.sequences=new Set,this.deferredRegistrations=new Set,this.executing=!1}static{this.PHASES=[cs.EarlyRead,cs.Write,cs.MixedReadWrite,cs.Read]}execute(){this.executing=!0;for(let e of n.PHASES)for(let t of this.sequences)if(!(t.erroredOrDestroyed||!t.hooks[e]))try{t.pipelinedValue=this.ngZone.runOutsideAngular(()=>t.hooks[e](t.pipelinedValue))}catch(r){t.erroredOrDestroyed=!0,this.errorHandler?.handleError(r)}this.executing=!1;for(let e of this.sequences)e.afterRun(),e.once&&(this.sequences.delete(e),e.destroy());for(let e of this.deferredRegistrations)this.sequences.add(e);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear()}register(e){this.executing?this.deferredRegistrations.add(e):(this.sequences.add(e),this.scheduler.notify(6))}unregister(e){this.executing&&this.sequences.has(e)?(e.erroredOrDestroyed=!0,e.pipelinedValue=void 0,e.once=!0):(this.sequences.delete(e),this.deferredRegistrations.delete(e))}static{this.\u0275prov=Ke({token:n,providedIn:"root",factory:()=>new n})}};function nM(n,e,t,r){let i=fe(),o=mu();if($r(i,o,e)){let s=tt(),a=Hf();k0(a,i,n,e,t,r)}return nM}function rM(n,e,t,r){return $r(n,mu(),t)?e+uu(t)+r:Hr}function Sc(n,e){return n<<17|e<<2}function qr(n){return n>>17&32767}function iM(n){return(n&2)==2}function oM(n,e){return n&131071|e<<17}function bf(n){return n|2}function $i(n){return(n&131068)>>2}function Rh(n,e){return n&-131069|e<<2}function sM(n){return(n&1)===1}function Cf(n){return n|1}function aM(n,e,t,r,i,o){let s=o?e.classBindings:e.styleBindings,a=qr(s),u=$i(s);n[r]=t;let l=!1,h;if(Array.isArray(t)){let p=t;h=p[1],(h===null||_s(p,h)>0)&&(l=!0)}else h=t;if(i)if(u!==0){let g=qr(n[a+1]);n[r+1]=Sc(g,a),g!==0&&(n[g+1]=Rh(n[g+1],r)),n[a+1]=oM(n[a+1],r)}else n[r+1]=Sc(a,0),a!==0&&(n[a+1]=Rh(n[a+1],r)),a=r;else n[r+1]=Sc(u,0),a===0?a=r:n[u+1]=Rh(n[u+1],r),u=r;l&&(n[r+1]=bf(n[r+1])),EI(n,h,r,!0),EI(n,h,r,!1),cM(e,h,n,r,o),s=Sc(a,u),o?e.classBindings=s:e.styleBindings=s}function cM(n,e,t,r,i){let o=i?n.residualClasses:n.residualStyles;o!=null&&typeof e=="string"&&_s(o,e)>=0&&(t[r+1]=Cf(t[r+1]))}function EI(n,e,t,r){let i=n[t+1],o=e===null,s=r?qr(i):$i(i),a=!1;for(;s!==0&&(a===!1||o);){let u=n[s],l=n[s+1];uM(u,e)&&(a=!0,n[s+1]=r?Cf(l):bf(l)),s=r?qr(l):$i(l)}a&&(n[t+1]=r?bf(i):Cf(i))}function uM(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?_s(n,e)>=0:!1}function lM(n,e,t){let r=fe(),i=mu();if($r(r,i,e)){let o=tt(),s=Hf();yE(o,s,r,n,e,r[qe],t,!1)}return lM}function TI(n,e,t,r,i){let o=e.inputs,s=i?"class":"style";rp(n,t,o[s],s,r)}function dM(n,e,t){return jE(n,e,t,!1),dM}function hM(n,e){return jE(n,e,null,!0),hM}function jE(n,e,t,r){let i=fe(),o=tt(),s=Jx(2);if(o.firstUpdatePass&&pM(o,n,s,r),e!==Hr&&$r(i,s,e)){let a=o.data[Hi()];_M(o,a,i,i[qe],n,i[s+1]=IM(e,t),r,s)}}function fM(n,e){return e>=n.expandoStartIndex}function pM(n,e,t,r){let i=n.data;if(i[t+1]===null){let o=i[Hi()],s=fM(n,t);wM(o,r)&&e===null&&!s&&(e=!1),e=mM(i,o,e,r),aM(i,o,e,t,s,r)}}function mM(n,e,t,r){let i=tR(n),o=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(t=Ph(null,n,e,t,r),t=gs(t,e.attrs,r),o=null);else{let s=e.directiveStylingLast;if(s===-1||n[s]!==i)if(t=Ph(i,n,e,t,r),o===null){let u=gM(n,e,r);u!==void 0&&Array.isArray(u)&&(u=Ph(null,n,e,u[1],r),u=gs(u,e.attrs,r),yM(n,e,r,u))}else o=vM(n,e,r)}return o!==void 0&&(r?e.residualClasses=o:e.residualStyles=o),t}function gM(n,e,t){let r=t?e.classBindings:e.styleBindings;if($i(r)!==0)return n[qr(r)]}function yM(n,e,t,r){let i=t?e.classBindings:e.styleBindings;n[qr(i)]=r}function vM(n,e,t){let r,i=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<i;o++){let s=n[o].hostAttrs;r=gs(r,s,t)}return gs(r,e.attrs,t)}function Ph(n,e,t,r,i){let o=null,s=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<s&&(o=e[a],r=gs(r,o.hostAttrs,i),o!==n);)a++;return n!==null&&(t.directiveStylingLast=a),r}function gs(n,e,t){let r=t?1:2,i=-1;if(e!==null)for(let o=0;o<e.length;o++){let s=e[o];typeof s=="number"?i=s:i===r&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),XN(n,s,t?!0:e[++o]))}return n===void 0?null:n}function _M(n,e,t,r,i,o,s,a){if(!(e.type&3))return;let u=n.data,l=u[a+1],h=sM(l)?bI(u,e,t,i,$i(l),s):void 0;if(!ou(h)){ou(o)||iM(l)&&(o=bI(u,null,t,i,a,s));let p=dw(Hi(),t);d0(r,s,p,i,o)}}function bI(n,e,t,r,i,o){let s=e===null,a;for(;i>0;){let u=n[i],l=Array.isArray(u),h=l?u[1]:u,p=h===null,g=t[i+1];g===Hr&&(g=p?Tt:void 0);let y=p?Eh(g,r):h===r?g:void 0;if(l&&!ou(y)&&(y=Eh(u,r)),ou(y)&&(a=y,s))return a;let D=n[i+1];i=s?qr(D):$i(D)}if(e!==null){let u=o?e.residualClasses:e.residualStyles;u!=null&&(a=Eh(u,r))}return a}function ou(n){return n!==void 0}function IM(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=yt(Jw(n)))),n}function wM(n,e){return(n.flags&(e?8:16))!==0}function EM(n,e,t,r,i,o){let s=e.consts,a=Hc(s,i),u=wu(e,n,2,r,a);return vE(e,t,u,Hc(s,o)),u.attrs!==null&&ff(u,u.attrs,!1),u.mergedAttrs!==null&&ff(u,u.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,u),u}function UE(n,e,t,r){let i=fe(),o=tt(),s=kt+n,a=i[qe],u=o.firstCreatePass?EM(s,o,i,e,t,r):o.data[s],l=bM(o,i,u,a,e,n);i[s]=l;let h=jf(u);return ws(u,!0),cE(a,l,u),!QP(u)&&zf()&&ep(o,i,l,u),Ux()===0&&jr(l,i),Bx(),h&&(pE(o,i,u),fE(o,u,i)),r!==null&&mE(i,u),UE}function BE(){let n=ft();Iw()?Wx():(n=n.parent,ws(n,!1));let e=n;Hx(e)&&zx(),$x();let t=tt();return t.firstCreatePass&&(Wf(t,n),ow(n)&&t.queries.elementEnd(n)),e.classesWithoutHost!=null&&uR(e)&&TI(t,e,fe(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&lR(e)&&TI(t,e,fe(),e.stylesWithoutHost,!1),BE}function TM(n,e,t,r){return UE(n,e,t,r),BE(),TM}var bM=(n,e,t,r,i,o)=>(Gf(!0),eE(r,i,oR()));function CH(){return fe()}var Nr=void 0;function CM(n){let e=n,t=Math.floor(Math.abs(n)),r=n.toString().replace(/^[^.]*\.?/,"").length;return t===1&&r===0?1:5}var DM=["en",[["a","p"],["AM","PM"],Nr],[["AM","PM"],Nr,Nr],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Nr,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Nr,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Nr,"{1} 'at' {0}",Nr],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",CM],Mh={};function DH(n){let e=AM(n),t=CI(e);if(t)return t;let r=e.split("-")[0];if(t=CI(r),t)return t;if(r==="en")return DM;throw new de(701,!1)}function CI(n){return n in Mh||(Mh[n]=Cc.ng&&Cc.ng.common&&Cc.ng.common.locales&&Cc.ng.common.locales[n]),Mh[n]}var SM=function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n}(SM||{});function AM(n){return n.toLowerCase().replace(/_/g,"-")}var su="en-US";var NM=su;function xM(n){typeof n=="string"&&(NM=n.toLowerCase().replace(/_/g,"-"))}var RM=(n,e,t)=>{};function PM(n,e,t,r){let i=fe(),o=tt(),s=ft();return $E(o,i,i[qe],s,n,e,r),PM}function MM(n,e,t,r){let i=n.cleanup;if(i!=null)for(let o=0;o<i.length-1;o+=2){let s=i[o];if(s===t&&i[o+1]===r){let a=e[Bc],u=i[o+2];return a.length>u?a[u]:null}typeof s=="string"&&(o+=2)}return null}function $E(n,e,t,r,i,o,s){let a=jf(r),l=n.firstCreatePass&&bE(n),h=e[Mt],p=TE(e),g=!0;if(r.type&3||s){let R=Ct(r,e),P=s?s(R):R,O=p.length,B=s?G=>s(Gt(G[r.index])):r.index,U=null;if(!s&&a&&(U=MM(n,e,i,r.index)),U!==null){let G=U.__ngLastListenerFn__||U;G.__ngNextListenerFn__=o,U.__ngLastListenerFn__=o,g=!1}else{o=SI(r,e,h,o),RM(R,i,o);let G=t.listen(P,i,o);p.push(o,G),l&&l.push(i,B,O,O+1)}}else o=SI(r,e,h,o);let y=r.outputs,D;if(g&&y!==null&&(D=y[i])){let R=D.length;if(R)for(let P=0;P<R;P+=2){let O=D[P],B=D[P+1],te=e[O][B].subscribe(o),H=p.length;p.push(o,te),l&&l.push(i,r.index,H,-(H+1))}}}function DI(n,e,t,r){let i=ue(null);try{return Bt(6,e,t),t(r)!==!1}catch(o){return CE(n,o),!1}finally{Bt(7,e,t),ue(i)}}function SI(n,e,t,r){return function i(o){if(o===Function)return r;let s=n.componentOffset>-1?Bn(n.index,e):e;op(s,5);let a=DI(e,t,r,o),u=i.__ngNextListenerFn__;for(;u;)a=DI(e,t,u,o)&&a,u=u.__ngNextListenerFn__;return a}}function SH(n=1){return rR(n)}function AH(n,e,t){RP(n,e,t)}function NH(n){let e=fe(),t=tt(),r=Ew();Bf(r+1);let i=up(t,r);if(n.dirty&&Lx(e)===((i.metadata.flags&2)===2)){if(i.matches===null)n.reset([]);else{let o=kP(e,r);n.reset(o,xR),n.notifyOnChanges()}return!0}return!1}function xH(){return NP(fe(),Ew())}function kM(n,e,t,r){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=r}function RH(n){let e=Kx();return fw(e,kt+n)}function PH(n,e=""){let t=fe(),r=tt(),i=n+kt,o=r.firstCreatePass?wu(r,i,1,e,null):r.data[i],s=OM(r,t,o,e,n);t[i]=s,zf()&&ep(r,t,s,o),ws(o,!1)}var OM=(n,e,t,r,i)=>(Gf(!0),KR(e[qe],r));function LM(n){return qE("",n,""),LM}function qE(n,e,t){let r=fe(),i=rM(r,n,e,t);return i!==Hr&&F0(r,Hi(),i),qE}function VM(n,e,t){VE(e)&&(e=e());let r=fe(),i=mu();if($r(r,i,e)){let o=tt(),s=Hf();yE(o,s,r,n,e,r[qe],t,!1)}return VM}function MH(n,e){let t=VE(n);return t&&n.set(e),t}function FM(n,e){let t=fe(),r=tt(),i=ft();return $E(r,t,t[qe],i,n,e),FM}function jM(n,e,t){let r=tt();if(r.firstCreatePass){let i=jn(n);Df(t,r.data,r.blueprint,i,!0),Df(e,r.data,r.blueprint,i,!1)}}function Df(n,e,t,r,i){if(n=lt(n),Array.isArray(n))for(let o=0;o<n.length;o++)Df(n[o],e,t,r,i);else{let o=tt(),s=fe(),a=ft(),u=Li(n)?n:lt(n.provide),l=nw(n),h=a.providerIndexes&1048575,p=a.directiveStart,g=a.providerIndexes>>20;if(Li(n)||!n.multi){let y=new Vr(l,i,_u),D=Oh(u,e,i?h:h+g,p);D===-1?(Qh(Kc(a,s),o,u),kh(o,n,e.length),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(y),s.push(y)):(t[D]=y,s[D]=y)}else{let y=Oh(u,e,h+g,p),D=Oh(u,e,h,h+g),R=y>=0&&t[y],P=D>=0&&t[D];if(i&&!P||!i&&!R){Qh(Kc(a,s),o,u);let O=$M(i?BM:UM,t.length,i,r,l);!i&&P&&(t[D].providerFactory=O),kh(o,n,e.length,0),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(O),s.push(O)}else{let O=HE(t[i?D:y],l,!i&&r);kh(o,n,y>-1?y:D,O)}!i&&r&&P&&t[D].componentProviders++}}}function kh(n,e,t,r){let i=Li(e),o=Ex(e);if(i||o){let u=(o?lt(e.useClass):e).prototype.ngOnDestroy;if(u){let l=n.destroyHooks||(n.destroyHooks=[]);if(!i&&e.multi){let h=l.indexOf(t);h===-1?l.push(t,[r,u]):l[h+1].push(r,u)}else l.push(t,u)}}}function HE(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function Oh(n,e,t,r){for(let i=t;i<r;i++)if(e[i]===n)return i;return-1}function UM(n,e,t,r){return Sf(this.multi,[])}function BM(n,e,t,r){let i=this.multi,o;if(this.providerFactory){let s=this.providerFactory.componentProviders,a=Fr(t,t[Z],this.providerFactory.index,r);o=a.slice(0,s),Sf(i,o);for(let u=s;u<a.length;u++)o.push(a[u])}else o=[],Sf(i,o);return o}function Sf(n,e){for(let t=0;t<n.length;t++){let r=n[t];e.push(r())}return e}function $M(n,e,t,r,i){let o=new Vr(n,t,_u);return o.multi=[],o.index=e,o.componentProviders=0,HE(o,i,r&&!t),o}function kH(n,e=[]){return t=>{t.providersResolver=(r,i)=>jM(r,i?i(n):n,e)}}var qM=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let r=ZI(!1,t.type),i=r.length>0?HP([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static{this.\u0275prov=Ke({token:n,providedIn:"environment",factory:()=>new n(qt(Fn))})}}return n})();function OH(n){Tu("NgStandalone"),n.getStandaloneInjector=e=>e.get(qM).getOrCreateStandaloneInjector(n)}function HM(n,e){let t=n[e];return t===Hr?void 0:t}function zM(n,e,t,r,i,o,s){let a=e+t;return KP(n,a,i,o)?WP(n,a+2,s?r.call(s,i,o):r(i,o)):HM(n,a+2)}function LH(n,e){let t=tt(),r,i=n+kt;t.firstCreatePass?(r=GM(e,t.pipeRegistry),t.data[i]=r,r.onDestroy&&(t.destroyHooks??=[]).push(i,r.onDestroy)):r=t.data[i];let o=r.factory||(r.factory=Rr(r.type,!0)),s,a=ht(_u);try{let u=Wc(!1),l=o();return Wc(u),kM(t,fe(),i,l),l}finally{ht(a)}}function GM(n,e){if(e)for(let t=e.length-1;t>=0;t--){let r=e[t];if(n===r.name)return r}}function VH(n,e,t,r){let i=n+kt,o=fe(),s=fw(o,i);return WM(o,i)?zM(o,Qx(),e,s.transform,t,r,s):s.transform(t,r)}function WM(n,e){return n[Z].data[e].pure}var ys=class{constructor(e){this.full=e;let t=e.split(".");this.major=t[0],this.minor=t[1],this.patch=t.slice(2).join(".")}},zE=new ys("18.2.14");var FH=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"platform"})}}return n})();var KM=new me("");function GE(n){return!!n&&typeof n.then=="function"}function QM(n){return!!n&&typeof n.subscribe=="function"}var YM=new me(""),WE=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r}),this.appInits=ve(YM,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let t=[];for(let i of this.appInits){let o=i();if(GE(o))t.push(o);else if(QM(o)){let s=new Promise((a,u)=>{o.subscribe({complete:a,error:u})});t.push(s)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),t.length===0&&r(),this.initialized=!0}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),JM=new me("");function ZM(){p_(()=>{throw new de(600,!1)})}function XM(n){return n.isBoundToModule}var ek=10;function tk(n,e,t){try{let r=t();return GE(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}var bu=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=ve(AR),this.afterRenderManager=ve(tM),this.zonelessEnabled=ve(ap),this.dirtyFlags=0,this.deferredDirtyFlags=0,this.externalTestViews=new Set,this.beforeRender=new Nn,this.afterTick=new Nn,this.componentTypes=[],this.components=[],this.isStable=ve(gu).hasPendingTasks.pipe(We(t=>!t)),this._injector=ve(Fn)}get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}whenStable(){let t;return new Promise(r=>{t=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{t.unsubscribe()})}get injector(){return this._injector}bootstrap(t,r){let i=t instanceof tu;if(!this._injector.get(WE).done){let g=!i&&gx(t),y=!1;throw new de(405,y)}let s;i?s=t:s=this._injector.get(Bi).resolveComponentFactory(t),this.componentTypes.push(s.componentType);let a=XM(s)?void 0:this._injector.get(Br),u=r||s.selector,l=s.create(Un.NULL,[],u,a),h=l.location.nativeElement,p=l.injector.get(KM,null);return p?.registerApplication(h),l.onDestroy(()=>{this.detachView(l.hostView),Mc(this.components,l),p?.unregisterApplication(h)}),this._loadComponent(l),l}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){if(this._runningTick)throw new de(101,!1);let t=ue(null);try{this._runningTick=!0,this.synchronize()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1,ue(t),this.afterTick.next()}}synchronize(){let t=null;this._injector.destroyed||(t=this._injector.get(nu,null,{optional:!0})),this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0;let r=0;for(;this.dirtyFlags!==0&&r++<ek;)this.synchronizeOnce(t)}synchronizeOnce(t){if(this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0,this.dirtyFlags&7){let r=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8,this.beforeRender.next(r);for(let{_lView:i,notifyErrorHandler:o}of this._views)nk(i,o,r,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&7)return}else t?.begin?.(),t?.end?.();this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>fu(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){let r=t;Mc(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);let r=this._injector.get(JM,[]);[...this._bootstrapListeners,...r].forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Mc(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new de(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function Mc(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function nk(n,e,t,r){if(!t&&!fu(n))return;AE(n,e,t&&!r?0:1)}var Af=class{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},jH=(()=>{class n{compileModuleSync(t){return new Tf(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let r=this.compileModuleSync(t),i=QI(t),o=Xw(i.declarations).reduce((s,a)=>{let u=Pr(a);return u&&s.push(new ms(u)),s},[]);return new Af(r,o)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var rk=(()=>{class n{constructor(){this.zone=ve($e),this.changeDetectionScheduler=ve(Ui),this.applicationRef=ve(bu)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),ik=new me("",{factory:()=>!1});function KE({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new $e(Ut(jt({},QE()),{scheduleInRootZone:t})),[{provide:$e,useFactory:n},{provide:Fc,multi:!0,useFactory:()=>{let r=ve(rk,{optional:!0});return()=>r.initialize()}},{provide:Fc,multi:!0,useFactory:()=>{let r=ve(ok);return()=>{r.initialize()}}},e===!0?{provide:PE,useValue:!0}:[],{provide:ME,useValue:t??Uw}]}function UH(n){let e=n?.ignoreChangesOutsideZone,t=n?.scheduleInRootZone,r=KE({ngZoneFactory:()=>{let i=QE(n);return i.scheduleInRootZone=t,i.shouldCoalesceEventChangeDetection&&Tu("NgZone_CoalesceEvent"),new $e(i)},ignoreChangesOutsideZone:e,scheduleInRootZone:t});return Is([{provide:ik,useValue:!0},{provide:ap,useValue:!1},r])}function QE(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var ok=(()=>{class n{constructor(){this.subscription=new Oe,this.initialized=!1,this.zone=ve($e),this.pendingTasks=ve(gu)}initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{$e.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{$e.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var sk=(()=>{class n{constructor(){this.appRef=ve(bu),this.taskService=ve(gu),this.ngZone=ve($e),this.zonelessEnabled=ve(ap),this.disableScheduling=ve(PE,{optional:!0})??!1,this.zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run,this.schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}],this.subscriptions=new Oe,this.angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Yc):null,this.scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(ve(ME,{optional:!0})??!1),this.cancelScheduledCallback=null,this.useMicrotaskScheduler=!1,this.runningTick=!1,this.pendingRenderTaskId=null,this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof ef||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&t===5)return;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 7:{this.appRef.deferredDirtyFlags|=8;break}case 9:case 8:case 6:case 10:default:this.appRef.dirtyFlags|=8}if(!this.shouldScheduleTick())return;let r=this.useMicrotaskScheduler?cI:$w;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>r(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(){return!(this.disableScheduling||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Yc+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){throw this.taskService.remove(t),r}finally{this.cleanup()}this.useMicrotaskScheduler=!0,cI(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function ak(){return typeof $localize<"u"&&$localize.locale||su}var YE=new me("",{providedIn:"root",factory:()=>ve(YE,oe.Optional|oe.SkipSelf)||ak()});var Nf=new me("");function Ac(n){return!n.moduleRef}function ck(n){let e=Ac(n)?n.r3Injector:n.moduleRef.injector,t=e.get($e);return t.run(()=>{Ac(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let r=e.get(ji,null),i;if(t.runOutsideAngular(()=>{i=t.onError.subscribe({next:o=>{r.handleError(o)}})}),Ac(n)){let o=()=>e.destroy(),s=n.platformInjector.get(Nf);s.add(o),e.onDestroy(()=>{i.unsubscribe(),s.delete(o)})}else{let o=()=>n.moduleRef.destroy(),s=n.platformInjector.get(Nf);s.add(o),n.moduleRef.onDestroy(()=>{Mc(n.allPlatformModules,n.moduleRef),i.unsubscribe(),s.delete(o)})}return tk(r,t,()=>{let o=e.get(WE);return o.runInitializers(),o.donePromise.then(()=>{let s=e.get(YE,su);if(xM(s||su),Ac(n)){let a=e.get(bu);return n.rootComponent!==void 0&&a.bootstrap(n.rootComponent),a}else return uk(n.moduleRef,n.allPlatformModules),n.moduleRef})})})}function uk(n,e){let t=n.injector.get(bu);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(r=>t.bootstrap(r));else if(n.instance.ngDoBootstrap)n.instance.ngDoBootstrap(t);else throw new de(-403,!1);e.push(n)}var kc=null,JE=new me("");function lk(n=[],e){return Un.create({name:e,providers:[{provide:tw,useValue:"platform"},{provide:Nf,useValue:new Set([()=>kc=null])},...n]})}function dk(n=[]){if(kc)return kc;let e=lk(n);return e.get(JE,!1)||(kc=e),ZM(),hk(e),e}function hk(n){n.get(VR,null)?.forEach(t=>t())}var BH=(()=>{class n{static{this.__NG_ELEMENT_ID__=fk}}return n})();function fk(n){return pk(ft(),fe(),(n&16)===16)}function pk(n,e,t){if(hu(n)&&!t){let r=Bn(n.index,e);return new Ur(r,r)}else if(n.type&175){let r=e[zt];return new Ur(r,e)}return null}var xf=class{constructor(){}supports(e){return FE(e)}create(e){return new Rf(e)}},mk=(n,e)=>e,Rf=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||mk}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,o=null;for(;t||r;){let s=!r||t&&t.currentIndex<AI(r,i,o)?t:r,a=AI(s,i,o),u=s.currentIndex;if(s===r)i--,r=r._nextRemoved;else if(t=t._next,s.previousIndex==null)i++;else{o||(o=[]);let l=a-i,h=u-i;if(l!=h){for(let g=0;g<l;g++){let y=g<o.length?o[g]:o[g]=0,D=y+g;h<=D&&D<l&&(o[g]=y+1)}let p=s.previousIndex;o[p]=h-l}}a!==u&&e(s,a,u)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!FE(e))throw new de(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,r=!1,i,o,s;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)o=e[a],s=this._trackByFn(a,o),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,o,s,a),r=!0):(r&&(t=this._verifyReinsertion(t,o,s,a)),Object.is(t.item,o)||this._addIdentityChange(t,o)),t=t._next}else i=0,zP(e,a=>{s=this._trackByFn(i,a),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,a,s,i),r=!0):(r&&(t=this._verifyReinsertion(t,a,s,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let o;return e===null?o=this._itTail:(o=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,i)):e=this._addAfter(new Pf(t,r),o,i)),e}_verifyReinsertion(e,t,r,i){let o=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return o!==null?e=this._reinsertAfter(o,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,o=e._nextRemoved;return i===null?this._removalsHead=o:i._nextRemoved=o,o===null?this._removalsTail=i:o._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){let i=t===null?this._itHead:t._next;return e._next=i,e._prev=t,i===null?this._itTail=e:i._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new au),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,r=e._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new au),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},Pf=class{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},Mf=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let t=e._prevDup,r=e._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},au=class{constructor(){this.map=new Map}put(e){let t=e.trackById,r=this.map.get(t);r||(r=new Mf,this.map.set(t,r)),r.add(e)}get(e,t){let r=e,i=this.map.get(r);return i?i.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function AI(n,e,t){let r=n.previousIndex;if(r===null)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}function NI(){return new gk([new xf])}var gk=(()=>{class n{static{this.\u0275prov=Ke({token:n,providedIn:"root",factory:NI})}constructor(t){this.factories=t}static create(t,r){if(r!=null){let i=r.factories.slice();t=t.concat(i)}return new n(t)}static extend(t){return{provide:n,useFactory:r=>n.create(t,r||NI()),deps:[[n,new QN,new ln]]}}find(t){let r=this.factories.find(i=>i.supports(t));if(r!=null)return r;throw new de(901,!1)}}return n})();function $H(n){let{rootComponent:e,appProviders:t,platformProviders:r,platformRef:i}=n;try{let o=i?.injector??dk(r);if(o.get(JE,!1)===!0&&!n.platformRef)throw new de(401,!1);let s=[KE({}),{provide:Ui,useExisting:sk},...t||[]],a=new iu({providers:s,parent:o,debugName:"",runEnvironmentInitializers:!1});return ck({r3Injector:a.injector,platformInjector:o,rootComponent:e})}catch(o){return Promise.reject(o)}}function qH(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}function HH(n,e){Tu("NgSignals");let t=d_(n);return e?.equal&&(t[an].equal=e.equal),t}function zH(n){let e=ue(null);try{return n()}finally{ue(e)}}var eT=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},yk=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let o=n[t++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){let o=n[t++],s=n[t++],a=n[t++],u=((i&7)<<18|(o&63)<<12|(s&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{let o=n[t++],s=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|s&63)}}return e.join("")},tT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let o=n[i],s=i+1<n.length,a=s?n[i+1]:0,u=i+2<n.length,l=u?n[i+2]:0,h=o>>2,p=(o&3)<<4|a>>4,g=(a&15)<<2|l>>6,y=l&63;u||(y=64,s||(g=64)),r.push(t[h],t[p],t[g],t[y])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(eT(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):yk(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let o=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;let l=i<n.length?t[n.charAt(i)]:64;++i;let p=i<n.length?t[n.charAt(i)]:64;if(++i,o==null||a==null||l==null||p==null)throw new dp;let g=o<<2|a>>4;if(r.push(g),l!==64){let y=a<<4&240|l>>2;if(r.push(y),p!==64){let D=l<<6&192|p;r.push(D)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},dp=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},vk=function(n){let e=eT(n);return tT.encodeByteArray(e,!0)},Es=function(n){return vk(n).replace(/\./g,"")},fp=function(n){try{return tT.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function _k(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var Ik=()=>_k().__FIREBASE_DEFAULTS__,wk=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Ek=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&fp(n[1]);return e&&JSON.parse(e)},Du=()=>{try{return Ik()||wk()||Ek()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},nT=n=>{var e,t;return(t=(e=Du())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},rT=n=>{let e=nT(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},pp=()=>{var n;return(n=Du())===null||n===void 0?void 0:n.config},iT=n=>{var e;return(e=Du())===null||e===void 0?void 0:e[`_${n}`]};var Cu=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function oT(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let s=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Es(JSON.stringify(t)),Es(JSON.stringify(s)),""].join(".")}function nt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function sT(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(nt())}function Tk(){var n;let e=(n=Du())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function aT(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function cT(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function mp(){return!Tk()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Su(){try{return typeof indexedDB=="object"}catch{return!1}}function uT(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var o;e(((o=i.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}var bk="FirebaseError",Dt=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=bk,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,fn.prototype.create)}},fn=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],s=o?Ck(o,r):"Error",a=`${this.serviceName}: ${s} (${i}).`;return new Dt(i,a,r)}};function Ck(n,e){return n.replace(Dk,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var Dk=/\{\$([^}]+)}/g;function Wt(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let o=n[i],s=e[i];if(XE(o)&&XE(s)){if(!Wt(o,s))return!1}else if(o!==s)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function XE(n){return n!==null&&typeof n=="object"}function gp(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function lT(n,e){let t=new hp(n,e);return t.subscribe.bind(t)}var hp=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");Sk(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=lp),i.error===void 0&&(i.error=lp),i.complete===void 0&&(i.complete=lp);let o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function Sk(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function lp(){}var WH=4*60*60*1e3;function Te(n){return n&&n._delegate?n._delegate:n}var St=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var zr="[DEFAULT]";var yp=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new Cu;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Nk(e))try{this.getOrInitializeService({instanceIdentifier:zr})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=zr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return w(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=zr){return this.instances.has(e)}getOptions(e=zr){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[o,s]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(o);r===a&&s.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),o=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;o.add(e),this.onInitCallbacks.set(i,o);let s=this.instances.get(i);return s&&e(s,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Ak(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=zr){return this.component?this.component.multipleInstances?e:zr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function Ak(n){return n===zr?void 0:n}function Nk(n){return n.instantiationMode==="EAGER"}var Au=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new yp(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var xk=[],ie=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(ie||{}),Rk={debug:ie.DEBUG,verbose:ie.VERBOSE,info:ie.INFO,warn:ie.WARN,error:ie.ERROR,silent:ie.SILENT},Pk=ie.INFO,Mk={[ie.DEBUG]:"log",[ie.VERBOSE]:"log",[ie.INFO]:"info",[ie.WARN]:"warn",[ie.ERROR]:"error"},kk=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=Mk[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},$n=class{constructor(e){this.name=e,this._logLevel=Pk,this._logHandler=kk,this._userLogHandler=null,xk.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ie))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Rk[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ie.DEBUG,...e),this._logHandler(this,ie.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ie.VERBOSE,...e),this._logHandler(this,ie.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ie.INFO,...e),this._logHandler(this,ie.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ie.WARN,...e),this._logHandler(this,ie.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ie.ERROR,...e),this._logHandler(this,ie.ERROR,...e)}};var Ok=(n,e)=>e.some(t=>n instanceof t),dT,hT;function Lk(){return dT||(dT=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Vk(){return hT||(hT=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var fT=new WeakMap,_p=new WeakMap,pT=new WeakMap,vp=new WeakMap,wp=new WeakMap;function Fk(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",s)},o=()=>{t(Kt(n.result)),i()},s=()=>{r(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",s)});return e.then(t=>{t instanceof IDBCursor&&fT.set(t,n)}).catch(()=>{}),wp.set(e,n),e}function jk(n){if(_p.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",s),n.removeEventListener("abort",s)},o=()=>{t(),i()},s=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",s),n.addEventListener("abort",s)});_p.set(n,e)}var Ip={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return _p.get(n);if(e==="objectStoreNames")return n.objectStoreNames||pT.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Kt(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function mT(n){Ip=n(Ip)}function Uk(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(Nu(this),e,...t);return pT.set(r,e.sort?e.sort():[e]),Kt(r)}:Vk().includes(n)?function(...e){return n.apply(Nu(this),e),Kt(fT.get(this))}:function(...e){return Kt(n.apply(Nu(this),e))}}function Bk(n){return typeof n=="function"?Uk(n):(n instanceof IDBTransaction&&jk(n),Ok(n,Lk())?new Proxy(n,Ip):n)}function Kt(n){if(n instanceof IDBRequest)return Fk(n);if(vp.has(n))return vp.get(n);let e=Bk(n);return e!==n&&(vp.set(n,e),wp.set(e,n)),e}var Nu=n=>wp.get(n);function yT(n,e,{blocked:t,upgrade:r,blocking:i,terminated:o}={}){let s=indexedDB.open(n,e),a=Kt(s);return r&&s.addEventListener("upgradeneeded",u=>{r(Kt(s.result),u.oldVersion,u.newVersion,Kt(s.transaction),u)}),t&&s.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),a.then(u=>{o&&u.addEventListener("close",()=>o()),i&&u.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}var $k=["get","getKey","getAll","getAllKeys","count"],qk=["put","add","delete","clear"],Ep=new Map;function gT(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Ep.get(e))return Ep.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=qk.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||$k.includes(t)))return;let o=function(s,...a){return w(this,null,function*(){let u=this.transaction(s,i?"readwrite":"readonly"),l=u.store;return r&&(l=l.index(a.shift())),(yield Promise.all([l[t](...a),i&&u.done]))[0]})};return Ep.set(e,o),o}mT(n=>Ut(jt({},n),{get:(e,t,r)=>gT(e,t)||n.get(e,t,r),has:(e,t)=>!!gT(e,t)||n.has(e,t)}));var bp=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Hk(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function Hk(n){let e=n.getComponent();return e?.type==="VERSION"}var Cp="@firebase/app",vT="0.10.8";var Gr=new $n("@firebase/app"),zk="@firebase/app-compat",Gk="@firebase/analytics-compat",Wk="@firebase/analytics",Kk="@firebase/app-check-compat",Qk="@firebase/app-check",Yk="@firebase/auth",Jk="@firebase/auth-compat",Zk="@firebase/database",Xk="@firebase/database-compat",eO="@firebase/functions",tO="@firebase/functions-compat",nO="@firebase/installations",rO="@firebase/installations-compat",iO="@firebase/messaging",oO="@firebase/messaging-compat",sO="@firebase/performance",aO="@firebase/performance-compat",cO="@firebase/remote-config",uO="@firebase/remote-config-compat",lO="@firebase/storage",dO="@firebase/storage-compat",hO="@firebase/firestore",fO="@firebase/vertexai-preview",pO="@firebase/firestore-compat",mO="firebase",gO="10.12.5";var xu="[DEFAULT]",yO={[Cp]:"fire-core",[zk]:"fire-core-compat",[Wk]:"fire-analytics",[Gk]:"fire-analytics-compat",[Qk]:"fire-app-check",[Kk]:"fire-app-check-compat",[Yk]:"fire-auth",[Jk]:"fire-auth-compat",[Zk]:"fire-rtdb",[Xk]:"fire-rtdb-compat",[eO]:"fire-fn",[tO]:"fire-fn-compat",[nO]:"fire-iid",[rO]:"fire-iid-compat",[iO]:"fire-fcm",[oO]:"fire-fcm-compat",[sO]:"fire-perf",[aO]:"fire-perf-compat",[cO]:"fire-rc",[uO]:"fire-rc-compat",[lO]:"fire-gcs",[dO]:"fire-gcs-compat",[hO]:"fire-fst",[pO]:"fire-fst-compat",[fO]:"fire-vertex","fire-js":"fire-js",[mO]:"fire-js-all"};var Ts=new Map,vO=new Map,Dp=new Map;function _T(n,e){try{n.container.addComponent(e)}catch(t){Gr.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Hn(n){let e=n.name;if(Dp.has(e))return Gr.debug(`There were multiple attempts to register component ${e}.`),!1;Dp.set(e,n);for(let t of Ts.values())_T(t,n);for(let t of vO.values())_T(t,n);return!0}function Cs(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function TT(n,e,t=xu){Cs(n,e).clearInstance(t)}function Gi(n){return n.settings!==void 0}var _O={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},qn=new fn("app","Firebase",_O);var Sp=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new St("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw qn.create("app-deleted",{appName:this._name})}};var Wi=gO;function xp(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:xu,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw qn.create("bad-app-name",{appName:String(i)});if(t||(t=pp()),!t)throw qn.create("no-options");let o=Ts.get(i);if(o){if(Wt(t,o.options)&&Wt(r,o.config))return o;throw qn.create("duplicate-app",{appName:i})}let s=new Au(i);for(let u of Dp.values())s.addComponent(u);let a=new Sp(t,r,s);return Ts.set(i,a),a}function Ds(n=xu){let e=Ts.get(n);if(!e&&n===xu&&pp())return xp();if(!e)throw qn.create("no-app",{appName:n});return e}function Ru(){return Array.from(Ts.values())}function He(n,e,t){var r;let i=(r=yO[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let o=i.match(/\s|\//),s=e.match(/\s|\//);if(o||s){let a=[`Unable to register library "${i}" with version "${e}":`];o&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&s&&a.push("and"),s&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Gr.warn(a.join(" "));return}Hn(new St(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var IO="firebase-heartbeat-database",wO=1,bs="firebase-heartbeat-store",Tp=null;function bT(){return Tp||(Tp=yT(IO,wO,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(bs)}catch(t){console.warn(t)}}}}).catch(n=>{throw qn.create("idb-open",{originalErrorMessage:n.message})})),Tp}function EO(n){return w(this,null,function*(){try{let t=(yield bT()).transaction(bs),r=yield t.objectStore(bs).get(CT(n));return yield t.done,r}catch(e){if(e instanceof Dt)Gr.warn(e.message);else{let t=qn.create("idb-get",{originalErrorMessage:e?.message});Gr.warn(t.message)}}})}function IT(n,e){return w(this,null,function*(){try{let r=(yield bT()).transaction(bs,"readwrite");yield r.objectStore(bs).put(e,CT(n)),yield r.done}catch(t){if(t instanceof Dt)Gr.warn(t.message);else{let r=qn.create("idb-set",{originalErrorMessage:t?.message});Gr.warn(r.message)}}})}function CT(n){return`${n.name}!${n.options.appId}`}var TO=1024,bO=30*24*60*60*1e3,Ap=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Np(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return w(this,null,function*(){var e,t;let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=wT();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(s=>s.date===o)))return this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(s=>{let a=new Date(s.date).valueOf();return Date.now()-a<=bO}),this._storage.overwrite(this._heartbeatsCache)})}getHeartbeatsHeader(){return w(this,null,function*(){var e;if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=wT(),{heartbeatsToSend:r,unsentEntries:i}=CO(this._heartbeatsCache.heartbeats),o=Es(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o})}};function wT(){return new Date().toISOString().substring(0,10)}function CO(n,e=TO){let t=[],r=n.slice();for(let i of n){let o=t.find(s=>s.agent===i.agent);if(o){if(o.dates.push(i.date),ET(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),ET(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var Np=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return w(this,null,function*(){return Su()?uT().then(()=>!0).catch(()=>!1):!1})}read(){return w(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield EO(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return w(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return IT(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return w(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return IT(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function ET(n){return Es(JSON.stringify({version:2,heartbeats:n})).length}function DO(n){Hn(new St("platform-logger",e=>new bp(e),"PRIVATE")),Hn(new St("heartbeat",e=>new Ap(e),"PRIVATE")),He(Cp,vT,n),He(Cp,vT,"esm2017"),He("fire-js","")}DO("");var SO="firebase",AO="10.12.5";He(SO,AO,"app");var Kr=new ys("ANGULARFIRE2_VERSION");function Pp(n,e,t){if(e){if(e.length===1)return e[0];let o=e.filter(s=>s.app===t);if(o.length===1)return o[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var Qi=(n,e)=>{let t=e?[e]:Ru(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(s=>{r.includes(s)||r.push(s)})}),r},Ss=class{constructor(){return Qi(NO)}},NO="app-check";function Ki(){}var Pu=class{zone;delegate;constructor(e,t=dh){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,o=function(s){i.runGuarded(()=>{e.apply(this,[s])})};return this.delegate.schedule(o,t,r)}},Rp=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Ki,{},Ki,Ki)),t.pipe(wh({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},As=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new Pu(Zone.current)),this.insideAngular=t.run(()=>new Pu(Zone.current,rc)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(qt($e))};static \u0275prov=Ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Mu(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function xO(n){return Mu().ngZone.runOutsideAngular(()=>n())}function Wr(n){return Mu().ngZone.run(()=>n())}function RO(n){return PO(Mu())(n)}function PO(n){return function(t){return t=t.lift(new Rp(n.ngZone)),t.pipe(Pn(n.outsideAngular),Rn(n.insideAngular))}}var MO=(n,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),Wr(()=>n.apply(void 0,r))},L=(n,e)=>function(){let t,r=arguments;for(let o=0;o<arguments.length;o++)typeof r[o]=="function"&&(e&&(t||=Wr(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Ki,{},Ki,Ki))),r[o]=MO(r[o],t));let i=xO(()=>n.apply(this,r));if(!e)if(i instanceof ne){let o=Mu();return i.pipe(Pn(o.outsideAngular),Rn(o.insideAngular))}else return Wr(()=>i);return i instanceof ne?i.pipe(RO):i instanceof Promise?Wr(()=>new Promise((o,s)=>i.then(a=>Wr(()=>o(a)),a=>Wr(()=>s(a))))):typeof i=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),i.apply(this,arguments)}:Wr(()=>i)};var Qr=class{constructor(e){return e}},Ns=class{constructor(){return Ru()}};function kO(n){return n&&n.length===1?n[0]:new Qr(Ds())}var Mp=new me("angularfire2._apps"),OO={provide:Qr,useFactory:kO,deps:[[new ln,Mp]]},LO={provide:Ns,deps:[[new ln,Mp]]};function VO(n){return(e,t)=>{let r=t.get(Qw);He("angularfire",Kr.full,"core"),He("angularfire",Kr.full,"app"),He("angular",zE.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new Qr(i)}}function Mz(n,...e){return Is([OO,LO,{provide:Mp,useFactory:VO(n),multi:!0,deps:[$e,Un,As,...e]}])}var kz=L(xp,!0);function MT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var kT=MT,OT=new fn("auth","Firebase",MT());var Vu=new $n("@firebase/auth");function FO(n,...e){Vu.logLevel<=ie.WARN&&Vu.warn(`Auth (${Wi}): ${n}`,...e)}function Ou(n,...e){Vu.logLevel<=ie.ERROR&&Vu.error(`Auth (${Wi}): ${n}`,...e)}function DT(n,...e){throw zp(n,...e)}function Hp(n,...e){return zp(n,...e)}function LT(n,e,t){let r=Object.assign(Object.assign({},kT()),{[e]:t});return new fn("auth","Firebase",r).create(e,{appName:n.name})}function Lu(n){return LT(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function zp(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return OT.create(n,...e)}function he(n,e,...t){if(!n)throw zp(e,...t)}function xs(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Ou(e),new Error(e)}function Fu(n,e){n||xs(e)}function jO(){return ST()==="http:"||ST()==="https:"}function ST(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function UO(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(jO()||aT()||"connection"in navigator)?navigator.onLine:!0}function BO(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Jr=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Fu(t>e,"Short delay should be less than long delay!"),this.isMobile=sT()||cT()}get(){return UO()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function $O(n,e){Fu(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var ju=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;xs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;xs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;xs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var qO={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var HO=new Jr(3e4,6e4);function VT(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function qu(o,s,a,u){return w(this,arguments,function*(n,e,t,r,i={}){return FT(n,i,()=>w(this,null,function*(){let l={},h={};r&&(e==="GET"?h=r:l={body:JSON.stringify(r)});let p=gp(Object.assign({key:n.config.apiKey},h)).slice(1),g=yield n._getAdditionalHeaders();return g["Content-Type"]="application/json",n.languageCode&&(g["X-Firebase-Locale"]=n.languageCode),ju.fetch()(jT(n,n.config.apiHost,t,p),Object.assign({method:e,headers:g,referrerPolicy:"no-referrer"},l))}))})}function FT(n,e,t){return w(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},qO),e);try{let i=new Lp(n),o=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let s=yield o.json();if("needConfirmation"in s)throw ku(n,"account-exists-with-different-credential",s);if(o.ok&&!("errorMessage"in s))return s;{let a=o.ok?s.errorMessage:s.error.message,[u,l]=a.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw ku(n,"credential-already-in-use",s);if(u==="EMAIL_EXISTS")throw ku(n,"email-already-in-use",s);if(u==="USER_DISABLED")throw ku(n,"user-disabled",s);let h=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw LT(n,h,l);DT(n,h)}}catch(i){if(i instanceof Dt)throw i;DT(n,"network-request-failed",{message:String(i)})}})}function jT(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?$O(n.config,i):`${n.config.apiScheme}://${i}`}var Lp=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Hp(this.auth,"network-request-failed")),HO.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function ku(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=Hp(n,e,r);return i.customData._tokenResponse=t,i}function zO(n,e){return w(this,null,function*(){return qu(n,"POST","/v1/accounts:delete",e)})}function UT(n,e){return w(this,null,function*(){return qu(n,"POST","/v1/accounts:lookup",e)})}function Rs(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function Gp(n,e=!1){return w(this,null,function*(){let t=Te(n),r=yield t.getIdToken(e),i=BT(r);he(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let o=typeof i.firebase=="object"?i.firebase:void 0,s=o?.sign_in_provider;return{claims:i,token:r,authTime:Rs(kp(i.auth_time)),issuedAtTime:Rs(kp(i.iat)),expirationTime:Rs(kp(i.exp)),signInProvider:s||null,signInSecondFactor:o?.sign_in_second_factor||null}})}function kp(n){return Number(n)*1e3}function BT(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Ou("JWT malformed, contained fewer than 3 sections"),null;try{let i=fp(t);return i?JSON.parse(i):(Ou("Failed to decode base64 JWT payload"),null)}catch(i){return Ou("Caught error parsing JWT payload as JSON",i?.toString()),null}}function AT(n){let e=BT(n);return he(e,"internal-error"),he(typeof e.exp<"u","internal-error"),he(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function Vp(n,e,t=!1){return w(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof Dt&&GO(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function GO({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var Fp=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>w(this,null,function*(){yield this.iteration()}),t)}iteration(){return w(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Ms=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Rs(this.lastLoginAt),this.creationTime=Rs(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Uu(n){return w(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield Vp(n,UT(t,{idToken:r}));he(i?.users.length,t,"internal-error");let o=i.users[0];n._notifyReloadListener(o);let s=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?$T(o.providerUserInfo):[],a=WO(n.providerData,s),u=n.isAnonymous,l=!(n.email&&o.passwordHash)&&!a?.length,h=u?l:!1,p={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:a,metadata:new Ms(o.createdAt,o.lastLoginAt),isAnonymous:h};Object.assign(n,p)})}function Wp(n){return w(this,null,function*(){let e=Te(n);yield Uu(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function WO(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function $T(n){return n.map(e=>{var{providerId:t}=e,r=hh(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function KO(n,e){return w(this,null,function*(){let t=yield FT(n,{},()=>w(this,null,function*(){let r=gp({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=n.config,s=jT(n,i,"/v1/token",`key=${o}`),a=yield n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",ju.fetch()(s,{method:"POST",headers:a,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function QO(n,e){return w(this,null,function*(){return qu(n,"POST","/v2/accounts:revokeToken",VT(n,e))})}var Ps=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){he(e.idToken,"internal-error"),he(typeof e.idToken<"u","internal-error"),he(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):AT(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){he(e.length!==0,"internal-error");let t=AT(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return w(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(he(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return w(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:o}=yield KO(e,t);this.updateTokensAndExpiration(r,i,Number(o))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:o}=t,s=new n;return r&&(he(typeof r=="string","internal-error",{appName:e}),s.refreshToken=r),i&&(he(typeof i=="string","internal-error",{appName:e}),s.accessToken=i),o&&(he(typeof o=="number","internal-error",{appName:e}),s.expirationTime=o),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return xs("not implemented")}};function zn(n,e){he(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var ks=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,o=hh(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Fp(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Ms(o.createdAt||void 0,o.lastLoginAt||void 0)}getIdToken(e){return w(this,null,function*(){let t=yield Vp(this,this.stsTokenManager.getToken(this.auth,e));return he(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return Gp(this,e)}reload(){return Wp(this)}_assign(e){this!==e&&(he(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){he(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return w(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield Uu(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return w(this,null,function*(){if(Gi(this.auth.app))return Promise.reject(Lu(this.auth));let e=yield this.getIdToken();return yield Vp(this,zO(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,o,s,a,u,l,h;let p=(r=t.displayName)!==null&&r!==void 0?r:void 0,g=(i=t.email)!==null&&i!==void 0?i:void 0,y=(o=t.phoneNumber)!==null&&o!==void 0?o:void 0,D=(s=t.photoURL)!==null&&s!==void 0?s:void 0,R=(a=t.tenantId)!==null&&a!==void 0?a:void 0,P=(u=t._redirectEventId)!==null&&u!==void 0?u:void 0,O=(l=t.createdAt)!==null&&l!==void 0?l:void 0,B=(h=t.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:U,emailVerified:G,isAnonymous:te,providerData:H,stsTokenManager:E}=t;he(U&&E,e,"internal-error");let v=Ps.fromJSON(this.name,E);he(typeof U=="string",e,"internal-error"),zn(p,e.name),zn(g,e.name),he(typeof G=="boolean",e,"internal-error"),he(typeof te=="boolean",e,"internal-error"),zn(y,e.name),zn(D,e.name),zn(R,e.name),zn(P,e.name),zn(O,e.name),zn(B,e.name);let _=new n({uid:U,auth:e,email:g,emailVerified:G,displayName:p,isAnonymous:te,photoURL:D,phoneNumber:y,tenantId:R,stsTokenManager:v,createdAt:O,lastLoginAt:B});return H&&Array.isArray(H)&&(_.providerData=H.map(T=>Object.assign({},T))),P&&(_._redirectEventId=P),_}static _fromIdTokenResponse(e,t,r=!1){return w(this,null,function*(){let i=new Ps;i.updateFromServerResponse(t);let o=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield Uu(o),o})}static _fromGetAccountInfoResponse(e,t,r){return w(this,null,function*(){let i=t.users[0];he(i.localId!==void 0,"internal-error");let o=i.providerUserInfo!==void 0?$T(i.providerUserInfo):[],s=!(i.email&&i.passwordHash)&&!o?.length,a=new Ps;a.updateFromIdToken(r);let u=new n({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:s}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Ms(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(u,l),u})}};var NT=new Map;function Yr(n){Fu(n instanceof Function,"Expected a class definition");let e=NT.get(n);return e?(Fu(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,NT.set(n,e),e)}var YO=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return w(this,null,function*(){return!0})}_set(t,r){return w(this,null,function*(){this.storage[t]=r})}_get(t){return w(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return w(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),jp=YO;function Op(n,e,t){return`firebase:${n}:${e}:${t}`}var Bu=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:o}=this.auth;this.fullUserKey=Op(this.userKey,i.apiKey,o),this.fullPersistenceKey=Op("persistence",i.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return w(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?ks._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return w(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return w(this,null,function*(){if(!t.length)return new n(Yr(jp),e,r);let i=(yield Promise.all(t.map(l=>w(this,null,function*(){if(yield l._isAvailable())return l})))).filter(l=>l),o=i[0]||Yr(jp),s=Op(r,e.config.apiKey,e.name),a=null;for(let l of t)try{let h=yield l._get(s);if(h){let p=ks._fromJSON(e,h);l!==o&&(a=p),o=l;break}}catch{}let u=i.filter(l=>l._shouldAllowMigration);return!o._shouldAllowMigration||!u.length?new n(o,e,r):(o=u[0],a&&(yield o._set(s,a.toJSON())),yield Promise.all(t.map(l=>w(this,null,function*(){if(l!==o)try{yield l._remove(s)}catch{}}))),new n(o,e,r))})}};function xT(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(e1(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(JO(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(n1(e))return"Blackberry";if(r1(e))return"Webos";if(ZO(e))return"Safari";if((e.includes("chrome/")||XO(e))&&!e.includes("edge/"))return"Chrome";if(t1(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function JO(n=nt()){return/firefox\//i.test(n)}function ZO(n=nt()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function XO(n=nt()){return/crios\//i.test(n)}function e1(n=nt()){return/iemobile/i.test(n)}function t1(n=nt()){return/android/i.test(n)}function n1(n=nt()){return/blackberry/i.test(n)}function r1(n=nt()){return/webos/i.test(n)}function qT(n,e=[]){let t;switch(n){case"Browser":t=xT(nt());break;case"Worker":t=`${xT(nt())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Wi}/${r}`}var Up=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=o=>new Promise((s,a)=>{try{let u=e(o);s(u)}catch(u){a(u)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return w(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function i1(t){return w(this,arguments,function*(n,e={}){return qu(n,"GET","/v2/passwordPolicy",VT(n,e))})}var o1=6,Bp=class{constructor(e){var t,r,i,o;let s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=s.minPasswordLength)!==null&&t!==void 0?t:o1,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),s.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),s.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),s.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),s.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,o,s,a;let u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(t=u.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(i=u.containsLowercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(o=u.containsUppercaseLetter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(s=u.containsNumericCharacter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(a=u.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),u}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}};var $p=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new $u(this),this.idTokenSubscription=new $u(this),this.beforeStateQueue=new Up(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=OT,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Yr(t)),this._initializationPromise=this.queue(()=>w(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield Bu.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return w(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return w(this,null,function*(){try{let t=yield UT(this,{idToken:e}),r=yield ks._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return w(this,null,function*(){var t;if(Gi(this.app)){let s=this.app.settings.authIdToken;return s?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(a,a))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,o=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let s=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=i?._redirectEventId,u=yield this.tryRedirectSignIn(e);(!s||s===a)&&u?.user&&(i=u.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{yield this.beforeStateQueue.runMiddleware(i)}catch(s){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return he(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return w(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return w(this,null,function*(){try{yield Uu(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=BO()}_delete(){return w(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return w(this,null,function*(){if(Gi(this.app))return Promise.reject(Lu(this));let t=e?Te(e):null;return t&&he(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return w(this,null,function*(){if(!this._deleted)return e&&he(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>w(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return w(this,null,function*(){return Gi(this.app)?Promise.reject(Lu(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return Gi(this.app)?Promise.reject(Lu(this)):this.queue(()=>w(this,null,function*(){yield this.assertedPersistence.setPersistence(Yr(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return w(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return w(this,null,function*(){let e=yield i1(this),t=new Bp(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new fn("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return w(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield QO(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return w(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return w(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&Yr(e)||this._popupRedirectResolver;he(t,this,"argument-error"),this.redirectPersistenceManager=yield Bu.create(this,[Yr(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return w(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>w(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return w(this,null,function*(){if(e===this.currentUser)return this.queue(()=>w(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let o=typeof t=="function"?t:t.next.bind(t),s=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(he(a,this,"internal-error"),a.then(()=>{s||o(this.currentUser)}),typeof t=="function"){let u=e.addObserver(t,r,i);return()=>{s=!0,u()}}else{let u=e.addObserver(t);return()=>{s=!0,u()}}}directlySetCurrentUser(e){return w(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return he(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=qT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return w(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return w(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&FO(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function s1(n){return Te(n)}var $u=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=lT(t=>this.observer=t)}get next(){return he(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var a1={loadJS(){return w(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function c1(n){a1=n}function u1(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function l1(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Yr);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}var Gz=u1("rcb"),Wz=new Jr(3e4,6e4);var Kz=new Jr(2e3,1e4);var Qz=10*60*1e3;var Yz=new Jr(3e4,6e4);var Jz=new Jr(5e3,15e3);var Zz=encodeURIComponent("fac");var RT="@firebase/auth",PT="1.7.6";var qp=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return w(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){he(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function d1(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function h1(n){Hn(new St("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:s,authDomain:a}=r.options;he(s&&!s.includes(":"),"invalid-api-key",{appName:r.name});let u={apiKey:s,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:qT(n)},l=new $p(r,i,o,u);return l1(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Hn(new St("auth-internal",e=>{let t=s1(e.getProvider("auth").getImmediate());return(r=>new qp(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),He(RT,PT,d1(n)),He(RT,PT,"esm2017")}var f1=5*60,Xz=iT("authIdTokenMaxAge")||f1;function p1(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}c1({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let o=Hp("internal-error");o.customData=i,t(o)},r.type="text/javascript",r.charset="UTF-8",p1().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});h1("Browser");var fL="auth";var Hu=class{constructor(){return Qi(fL)}};var HT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},zT={};var Gn,Kp;(function(){var n;function e(E,v){function _(){}_.prototype=v.prototype,E.D=v.prototype,E.prototype=new _,E.prototype.constructor=E,E.C=function(T,b,S){for(var I=Array(arguments.length-2),rn=2;rn<arguments.length;rn++)I[rn-2]=arguments[rn];return v.prototype[b].apply(T,I)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,v,_){_||(_=0);var T=Array(16);if(typeof v=="string")for(var b=0;16>b;++b)T[b]=v.charCodeAt(_++)|v.charCodeAt(_++)<<8|v.charCodeAt(_++)<<16|v.charCodeAt(_++)<<24;else for(b=0;16>b;++b)T[b]=v[_++]|v[_++]<<8|v[_++]<<16|v[_++]<<24;v=E.g[0],_=E.g[1],b=E.g[2];var S=E.g[3],I=v+(S^_&(b^S))+T[0]+3614090360&4294967295;v=_+(I<<7&4294967295|I>>>25),I=S+(b^v&(_^b))+T[1]+3905402710&4294967295,S=v+(I<<12&4294967295|I>>>20),I=b+(_^S&(v^_))+T[2]+606105819&4294967295,b=S+(I<<17&4294967295|I>>>15),I=_+(v^b&(S^v))+T[3]+3250441966&4294967295,_=b+(I<<22&4294967295|I>>>10),I=v+(S^_&(b^S))+T[4]+4118548399&4294967295,v=_+(I<<7&4294967295|I>>>25),I=S+(b^v&(_^b))+T[5]+1200080426&4294967295,S=v+(I<<12&4294967295|I>>>20),I=b+(_^S&(v^_))+T[6]+2821735955&4294967295,b=S+(I<<17&4294967295|I>>>15),I=_+(v^b&(S^v))+T[7]+4249261313&4294967295,_=b+(I<<22&4294967295|I>>>10),I=v+(S^_&(b^S))+T[8]+1770035416&4294967295,v=_+(I<<7&4294967295|I>>>25),I=S+(b^v&(_^b))+T[9]+2336552879&4294967295,S=v+(I<<12&4294967295|I>>>20),I=b+(_^S&(v^_))+T[10]+4294925233&4294967295,b=S+(I<<17&4294967295|I>>>15),I=_+(v^b&(S^v))+T[11]+2304563134&4294967295,_=b+(I<<22&4294967295|I>>>10),I=v+(S^_&(b^S))+T[12]+1804603682&4294967295,v=_+(I<<7&4294967295|I>>>25),I=S+(b^v&(_^b))+T[13]+4254626195&4294967295,S=v+(I<<12&4294967295|I>>>20),I=b+(_^S&(v^_))+T[14]+2792965006&4294967295,b=S+(I<<17&4294967295|I>>>15),I=_+(v^b&(S^v))+T[15]+1236535329&4294967295,_=b+(I<<22&4294967295|I>>>10),I=v+(b^S&(_^b))+T[1]+4129170786&4294967295,v=_+(I<<5&4294967295|I>>>27),I=S+(_^b&(v^_))+T[6]+3225465664&4294967295,S=v+(I<<9&4294967295|I>>>23),I=b+(v^_&(S^v))+T[11]+643717713&4294967295,b=S+(I<<14&4294967295|I>>>18),I=_+(S^v&(b^S))+T[0]+3921069994&4294967295,_=b+(I<<20&4294967295|I>>>12),I=v+(b^S&(_^b))+T[5]+3593408605&4294967295,v=_+(I<<5&4294967295|I>>>27),I=S+(_^b&(v^_))+T[10]+38016083&4294967295,S=v+(I<<9&4294967295|I>>>23),I=b+(v^_&(S^v))+T[15]+3634488961&4294967295,b=S+(I<<14&4294967295|I>>>18),I=_+(S^v&(b^S))+T[4]+3889429448&4294967295,_=b+(I<<20&4294967295|I>>>12),I=v+(b^S&(_^b))+T[9]+568446438&4294967295,v=_+(I<<5&4294967295|I>>>27),I=S+(_^b&(v^_))+T[14]+3275163606&4294967295,S=v+(I<<9&4294967295|I>>>23),I=b+(v^_&(S^v))+T[3]+4107603335&4294967295,b=S+(I<<14&4294967295|I>>>18),I=_+(S^v&(b^S))+T[8]+1163531501&4294967295,_=b+(I<<20&4294967295|I>>>12),I=v+(b^S&(_^b))+T[13]+2850285829&4294967295,v=_+(I<<5&4294967295|I>>>27),I=S+(_^b&(v^_))+T[2]+4243563512&4294967295,S=v+(I<<9&4294967295|I>>>23),I=b+(v^_&(S^v))+T[7]+1735328473&4294967295,b=S+(I<<14&4294967295|I>>>18),I=_+(S^v&(b^S))+T[12]+2368359562&4294967295,_=b+(I<<20&4294967295|I>>>12),I=v+(_^b^S)+T[5]+4294588738&4294967295,v=_+(I<<4&4294967295|I>>>28),I=S+(v^_^b)+T[8]+2272392833&4294967295,S=v+(I<<11&4294967295|I>>>21),I=b+(S^v^_)+T[11]+1839030562&4294967295,b=S+(I<<16&4294967295|I>>>16),I=_+(b^S^v)+T[14]+4259657740&4294967295,_=b+(I<<23&4294967295|I>>>9),I=v+(_^b^S)+T[1]+2763975236&4294967295,v=_+(I<<4&4294967295|I>>>28),I=S+(v^_^b)+T[4]+1272893353&4294967295,S=v+(I<<11&4294967295|I>>>21),I=b+(S^v^_)+T[7]+4139469664&4294967295,b=S+(I<<16&4294967295|I>>>16),I=_+(b^S^v)+T[10]+3200236656&4294967295,_=b+(I<<23&4294967295|I>>>9),I=v+(_^b^S)+T[13]+681279174&4294967295,v=_+(I<<4&4294967295|I>>>28),I=S+(v^_^b)+T[0]+3936430074&4294967295,S=v+(I<<11&4294967295|I>>>21),I=b+(S^v^_)+T[3]+3572445317&4294967295,b=S+(I<<16&4294967295|I>>>16),I=_+(b^S^v)+T[6]+76029189&4294967295,_=b+(I<<23&4294967295|I>>>9),I=v+(_^b^S)+T[9]+3654602809&4294967295,v=_+(I<<4&4294967295|I>>>28),I=S+(v^_^b)+T[12]+3873151461&4294967295,S=v+(I<<11&4294967295|I>>>21),I=b+(S^v^_)+T[15]+530742520&4294967295,b=S+(I<<16&4294967295|I>>>16),I=_+(b^S^v)+T[2]+3299628645&4294967295,_=b+(I<<23&4294967295|I>>>9),I=v+(b^(_|~S))+T[0]+4096336452&4294967295,v=_+(I<<6&4294967295|I>>>26),I=S+(_^(v|~b))+T[7]+1126891415&4294967295,S=v+(I<<10&4294967295|I>>>22),I=b+(v^(S|~_))+T[14]+2878612391&4294967295,b=S+(I<<15&4294967295|I>>>17),I=_+(S^(b|~v))+T[5]+4237533241&4294967295,_=b+(I<<21&4294967295|I>>>11),I=v+(b^(_|~S))+T[12]+1700485571&4294967295,v=_+(I<<6&4294967295|I>>>26),I=S+(_^(v|~b))+T[3]+2399980690&4294967295,S=v+(I<<10&4294967295|I>>>22),I=b+(v^(S|~_))+T[10]+4293915773&4294967295,b=S+(I<<15&4294967295|I>>>17),I=_+(S^(b|~v))+T[1]+2240044497&4294967295,_=b+(I<<21&4294967295|I>>>11),I=v+(b^(_|~S))+T[8]+1873313359&4294967295,v=_+(I<<6&4294967295|I>>>26),I=S+(_^(v|~b))+T[15]+4264355552&4294967295,S=v+(I<<10&4294967295|I>>>22),I=b+(v^(S|~_))+T[6]+2734768916&4294967295,b=S+(I<<15&4294967295|I>>>17),I=_+(S^(b|~v))+T[13]+1309151649&4294967295,_=b+(I<<21&4294967295|I>>>11),I=v+(b^(_|~S))+T[4]+4149444226&4294967295,v=_+(I<<6&4294967295|I>>>26),I=S+(_^(v|~b))+T[11]+3174756917&4294967295,S=v+(I<<10&4294967295|I>>>22),I=b+(v^(S|~_))+T[2]+718787259&4294967295,b=S+(I<<15&4294967295|I>>>17),I=_+(S^(b|~v))+T[9]+3951481745&4294967295,E.g[0]=E.g[0]+v&4294967295,E.g[1]=E.g[1]+(b+(I<<21&4294967295|I>>>11))&4294967295,E.g[2]=E.g[2]+b&4294967295,E.g[3]=E.g[3]+S&4294967295}r.prototype.u=function(E,v){v===void 0&&(v=E.length);for(var _=v-this.blockSize,T=this.B,b=this.h,S=0;S<v;){if(b==0)for(;S<=_;)i(this,E,S),S+=this.blockSize;if(typeof E=="string"){for(;S<v;)if(T[b++]=E.charCodeAt(S++),b==this.blockSize){i(this,T),b=0;break}}else for(;S<v;)if(T[b++]=E[S++],b==this.blockSize){i(this,T),b=0;break}}this.h=b,this.o+=v},r.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var v=1;v<E.length-8;++v)E[v]=0;var _=8*this.o;for(v=E.length-8;v<E.length;++v)E[v]=_&255,_/=256;for(this.u(E),E=Array(16),v=_=0;4>v;++v)for(var T=0;32>T;T+=8)E[_++]=this.g[v]>>>T&255;return E};function o(E,v){var _=a;return Object.prototype.hasOwnProperty.call(_,E)?_[E]:_[E]=v(E)}function s(E,v){this.h=v;for(var _=[],T=!0,b=E.length-1;0<=b;b--){var S=E[b]|0;T&&S==v||(_[b]=S,T=!1)}this.g=_}var a={};function u(E){return-128<=E&&128>E?o(E,function(v){return new s([v|0],0>v?-1:0)}):new s([E|0],0>E?-1:0)}function l(E){if(isNaN(E)||!isFinite(E))return p;if(0>E)return P(l(-E));for(var v=[],_=1,T=0;E>=_;T++)v[T]=E/_|0,_*=4294967296;return new s(v,0)}function h(E,v){if(E.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(E.charAt(0)=="-")return P(h(E.substring(1),v));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=l(Math.pow(v,8)),T=p,b=0;b<E.length;b+=8){var S=Math.min(8,E.length-b),I=parseInt(E.substring(b,b+S),v);8>S?(S=l(Math.pow(v,S)),T=T.j(S).add(l(I))):(T=T.j(_),T=T.add(l(I)))}return T}var p=u(0),g=u(1),y=u(16777216);n=s.prototype,n.m=function(){if(R(this))return-P(this).m();for(var E=0,v=1,_=0;_<this.g.length;_++){var T=this.i(_);E+=(0<=T?T:4294967296+T)*v,v*=4294967296}return E},n.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(D(this))return"0";if(R(this))return"-"+P(this).toString(E);for(var v=l(Math.pow(E,6)),_=this,T="";;){var b=G(_,v).g;_=O(_,b.j(v));var S=((0<_.g.length?_.g[0]:_.h)>>>0).toString(E);if(_=b,D(_))return S+T;for(;6>S.length;)S="0"+S;T=S+T}},n.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function D(E){if(E.h!=0)return!1;for(var v=0;v<E.g.length;v++)if(E.g[v]!=0)return!1;return!0}function R(E){return E.h==-1}n.l=function(E){return E=O(this,E),R(E)?-1:D(E)?0:1};function P(E){for(var v=E.g.length,_=[],T=0;T<v;T++)_[T]=~E.g[T];return new s(_,~E.h).add(g)}n.abs=function(){return R(this)?P(this):this},n.add=function(E){for(var v=Math.max(this.g.length,E.g.length),_=[],T=0,b=0;b<=v;b++){var S=T+(this.i(b)&65535)+(E.i(b)&65535),I=(S>>>16)+(this.i(b)>>>16)+(E.i(b)>>>16);T=I>>>16,S&=65535,I&=65535,_[b]=I<<16|S}return new s(_,_[_.length-1]&-2147483648?-1:0)};function O(E,v){return E.add(P(v))}n.j=function(E){if(D(this)||D(E))return p;if(R(this))return R(E)?P(this).j(P(E)):P(P(this).j(E));if(R(E))return P(this.j(P(E)));if(0>this.l(y)&&0>E.l(y))return l(this.m()*E.m());for(var v=this.g.length+E.g.length,_=[],T=0;T<2*v;T++)_[T]=0;for(T=0;T<this.g.length;T++)for(var b=0;b<E.g.length;b++){var S=this.i(T)>>>16,I=this.i(T)&65535,rn=E.i(b)>>>16,Lo=E.i(b)&65535;_[2*T+2*b]+=I*Lo,B(_,2*T+2*b),_[2*T+2*b+1]+=S*Lo,B(_,2*T+2*b+1),_[2*T+2*b+1]+=I*rn,B(_,2*T+2*b+1),_[2*T+2*b+2]+=S*rn,B(_,2*T+2*b+2)}for(T=0;T<v;T++)_[T]=_[2*T+1]<<16|_[2*T];for(T=v;T<2*v;T++)_[T]=0;return new s(_,0)};function B(E,v){for(;(E[v]&65535)!=E[v];)E[v+1]+=E[v]>>>16,E[v]&=65535,v++}function U(E,v){this.g=E,this.h=v}function G(E,v){if(D(v))throw Error("division by zero");if(D(E))return new U(p,p);if(R(E))return v=G(P(E),v),new U(P(v.g),P(v.h));if(R(v))return v=G(E,P(v)),new U(P(v.g),v.h);if(30<E.g.length){if(R(E)||R(v))throw Error("slowDivide_ only works with positive integers.");for(var _=g,T=v;0>=T.l(E);)_=te(_),T=te(T);var b=H(_,1),S=H(T,1);for(T=H(T,2),_=H(_,2);!D(T);){var I=S.add(T);0>=I.l(E)&&(b=b.add(_),S=I),T=H(T,1),_=H(_,1)}return v=O(E,b.j(v)),new U(b,v)}for(b=p;0<=E.l(v);){for(_=Math.max(1,Math.floor(E.m()/v.m())),T=Math.ceil(Math.log(_)/Math.LN2),T=48>=T?1:Math.pow(2,T-48),S=l(_),I=S.j(v);R(I)||0<I.l(E);)_-=T,S=l(_),I=S.j(v);D(S)&&(S=g),b=b.add(S),E=O(E,I)}return new U(b,E)}n.A=function(E){return G(this,E).h},n.and=function(E){for(var v=Math.max(this.g.length,E.g.length),_=[],T=0;T<v;T++)_[T]=this.i(T)&E.i(T);return new s(_,this.h&E.h)},n.or=function(E){for(var v=Math.max(this.g.length,E.g.length),_=[],T=0;T<v;T++)_[T]=this.i(T)|E.i(T);return new s(_,this.h|E.h)},n.xor=function(E){for(var v=Math.max(this.g.length,E.g.length),_=[],T=0;T<v;T++)_[T]=this.i(T)^E.i(T);return new s(_,this.h^E.h)};function te(E){for(var v=E.g.length+1,_=[],T=0;T<v;T++)_[T]=E.i(T)<<1|E.i(T-1)>>>31;return new s(_,E.h)}function H(E,v){var _=v>>5;v%=32;for(var T=E.g.length-_,b=[],S=0;S<T;S++)b[S]=0<v?E.i(S+_)>>>v|E.i(S+_+1)<<32-v:E.i(S+_);return new s(b,E.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Kp=zT.Md5=r,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=l,s.fromString=h,Gn=zT.Integer=s}).apply(typeof HT<"u"?HT:typeof self<"u"?self:typeof window<"u"?window:{});var zu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},pn={};var Qp,Yp,Yi,Jp,Os,Gu,Zp,Xp,em;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,d,f){return c==Array.prototype||c==Object.prototype||(c[d]=f.value),c};function t(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof zu=="object"&&zu];for(var d=0;d<c.length;++d){var f=c[d];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=t(this);function i(c,d){if(d)e:{var f=r;c=c.split(".");for(var m=0;m<c.length-1;m++){var C=c[m];if(!(C in f))break e;f=f[C]}c=c[c.length-1],m=f[c],d=d(m),d!=m&&d!=null&&e(f,c,{configurable:!0,writable:!0,value:d})}}function o(c,d){c instanceof String&&(c+="");var f=0,m=!1,C={next:function(){if(!m&&f<c.length){var x=f++;return{value:d(x,c[x]),done:!1}}return m=!0,{done:!0,value:void 0}}};return C[Symbol.iterator]=function(){return C},C}i("Array.prototype.values",function(c){return c||function(){return o(this,function(d,f){return f})}});var s=s||{},a=this||self;function u(c){var d=typeof c;return d=d!="object"?d:c?Array.isArray(c)?"array":d:"null",d=="array"||d=="object"&&typeof c.length=="number"}function l(c){var d=typeof c;return d=="object"&&c!=null||d=="function"}function h(c,d,f){return c.call.apply(c.bind,arguments)}function p(c,d,f){if(!c)throw Error();if(2<arguments.length){var m=Array.prototype.slice.call(arguments,2);return function(){var C=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(C,m),c.apply(d,C)}}return function(){return c.apply(d,arguments)}}function g(c,d,f){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:p,g.apply(null,arguments)}function y(c,d){var f=Array.prototype.slice.call(arguments,1);return function(){var m=f.slice();return m.push.apply(m,arguments),c.apply(this,m)}}function D(c,d){function f(){}f.prototype=d.prototype,c.aa=d.prototype,c.prototype=new f,c.prototype.constructor=c,c.Qb=function(m,C,x){for(var F=Array(arguments.length-2),ye=2;ye<arguments.length;ye++)F[ye-2]=arguments[ye];return d.prototype[C].apply(m,F)}}function R(c){let d=c.length;if(0<d){let f=Array(d);for(let m=0;m<d;m++)f[m]=c[m];return f}return[]}function P(c,d){for(let f=1;f<arguments.length;f++){let m=arguments[f];if(u(m)){let C=c.length||0,x=m.length||0;c.length=C+x;for(let F=0;F<x;F++)c[C+F]=m[F]}else c.push(m)}}class O{constructor(d,f){this.i=d,this.j=f,this.h=0,this.g=null}get(){let d;return 0<this.h?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function B(c){return/^[\s\xa0]*$/.test(c)}function U(){var c=a.navigator;return c&&(c=c.userAgent)?c:""}function G(c){return G[" "](c),c}G[" "]=function(){};var te=U().indexOf("Gecko")!=-1&&!(U().toLowerCase().indexOf("webkit")!=-1&&U().indexOf("Edge")==-1)&&!(U().indexOf("Trident")!=-1||U().indexOf("MSIE")!=-1)&&U().indexOf("Edge")==-1;function H(c,d,f){for(let m in c)d.call(f,c[m],m,c)}function E(c,d){for(let f in c)d.call(void 0,c[f],f,c)}function v(c){let d={};for(let f in c)d[f]=c[f];return d}let _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function T(c,d){let f,m;for(let C=1;C<arguments.length;C++){m=arguments[C];for(f in m)c[f]=m[f];for(let x=0;x<_.length;x++)f=_[x],Object.prototype.hasOwnProperty.call(m,f)&&(c[f]=m[f])}}function b(c){var d=1;c=c.split(":");let f=[];for(;0<d&&c.length;)f.push(c.shift()),d--;return c.length&&f.push(c.join(":")),f}function S(c){a.setTimeout(()=>{throw c},0)}function I(){var c=wd;let d=null;return c.g&&(d=c.g,c.g=c.g.next,c.g||(c.h=null),d.next=null),d}class rn{constructor(){this.h=this.g=null}add(d,f){let m=Lo.get();m.set(d,f),this.h?this.h.next=m:this.g=m,this.h=m}}var Lo=new O(()=>new nA,c=>c.reset());class nA{constructor(){this.next=this.g=this.h=null}set(d,f){this.h=d,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let Vo,Fo=!1,wd=new rn,ev=()=>{let c=a.Promise.resolve(void 0);Vo=()=>{c.then(rA)}};var rA=()=>{for(var c;c=I();){try{c.h.call(c.g)}catch(f){S(f)}var d=Lo;d.j(c),100>d.h&&(d.h++,c.next=d.g,d.g=c)}Fo=!1};function Cn(){this.s=this.s,this.C=this.C}Cn.prototype.s=!1,Cn.prototype.ma=function(){this.s||(this.s=!0,this.N())},Cn.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ye(c,d){this.type=c,this.g=this.target=d,this.defaultPrevented=!1}Ye.prototype.h=function(){this.defaultPrevented=!0};var iA=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var c=!1,d=Object.defineProperty({},"passive",{get:function(){c=!0}});try{let f=()=>{};a.addEventListener("test",f,d),a.removeEventListener("test",f,d)}catch{}return c}();function jo(c,d){if(Ye.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var f=this.type=c.type,m=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=d,d=c.relatedTarget){if(te){e:{try{G(d.nodeName);var C=!0;break e}catch{}C=!1}C||(d=null)}}else f=="mouseover"?d=c.fromElement:f=="mouseout"&&(d=c.toElement);this.relatedTarget=d,m?(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:oA[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&jo.aa.h.call(this)}}D(jo,Ye);var oA={2:"touch",3:"pen",4:"mouse"};jo.prototype.h=function(){jo.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var Uo="closure_listenable_"+(1e6*Math.random()|0),sA=0;function aA(c,d,f,m,C){this.listener=c,this.proxy=null,this.src=d,this.type=f,this.capture=!!m,this.ha=C,this.key=++sA,this.da=this.fa=!1}function Da(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function Sa(c){this.src=c,this.g={},this.h=0}Sa.prototype.add=function(c,d,f,m,C){var x=c.toString();c=this.g[x],c||(c=this.g[x]=[],this.h++);var F=Td(c,d,m,C);return-1<F?(d=c[F],f||(d.fa=!1)):(d=new aA(d,this.src,x,!!m,C),d.fa=f,c.push(d)),d};function Ed(c,d){var f=d.type;if(f in c.g){var m=c.g[f],C=Array.prototype.indexOf.call(m,d,void 0),x;(x=0<=C)&&Array.prototype.splice.call(m,C,1),x&&(Da(d),c.g[f].length==0&&(delete c.g[f],c.h--))}}function Td(c,d,f,m){for(var C=0;C<c.length;++C){var x=c[C];if(!x.da&&x.listener==d&&x.capture==!!f&&x.ha==m)return C}return-1}var bd="closure_lm_"+(1e6*Math.random()|0),Cd={};function tv(c,d,f,m,C){if(m&&m.once)return rv(c,d,f,m,C);if(Array.isArray(d)){for(var x=0;x<d.length;x++)tv(c,d[x],f,m,C);return null}return f=Nd(f),c&&c[Uo]?c.K(d,f,l(m)?!!m.capture:!!m,C):nv(c,d,f,!1,m,C)}function nv(c,d,f,m,C,x){if(!d)throw Error("Invalid event type");var F=l(C)?!!C.capture:!!C,ye=Sd(c);if(ye||(c[bd]=ye=new Sa(c)),f=ye.add(d,f,m,F,x),f.proxy)return f;if(m=cA(),f.proxy=m,m.src=c,m.listener=f,c.addEventListener)iA||(C=F),C===void 0&&(C=!1),c.addEventListener(d.toString(),m,C);else if(c.attachEvent)c.attachEvent(ov(d.toString()),m);else if(c.addListener&&c.removeListener)c.addListener(m);else throw Error("addEventListener and attachEvent are unavailable.");return f}function cA(){function c(f){return d.call(c.src,c.listener,f)}let d=uA;return c}function rv(c,d,f,m,C){if(Array.isArray(d)){for(var x=0;x<d.length;x++)rv(c,d[x],f,m,C);return null}return f=Nd(f),c&&c[Uo]?c.L(d,f,l(m)?!!m.capture:!!m,C):nv(c,d,f,!0,m,C)}function iv(c,d,f,m,C){if(Array.isArray(d))for(var x=0;x<d.length;x++)iv(c,d[x],f,m,C);else m=l(m)?!!m.capture:!!m,f=Nd(f),c&&c[Uo]?(c=c.i,d=String(d).toString(),d in c.g&&(x=c.g[d],f=Td(x,f,m,C),-1<f&&(Da(x[f]),Array.prototype.splice.call(x,f,1),x.length==0&&(delete c.g[d],c.h--)))):c&&(c=Sd(c))&&(d=c.g[d.toString()],c=-1,d&&(c=Td(d,f,m,C)),(f=-1<c?d[c]:null)&&Dd(f))}function Dd(c){if(typeof c!="number"&&c&&!c.da){var d=c.src;if(d&&d[Uo])Ed(d.i,c);else{var f=c.type,m=c.proxy;d.removeEventListener?d.removeEventListener(f,m,c.capture):d.detachEvent?d.detachEvent(ov(f),m):d.addListener&&d.removeListener&&d.removeListener(m),(f=Sd(d))?(Ed(f,c),f.h==0&&(f.src=null,d[bd]=null)):Da(c)}}}function ov(c){return c in Cd?Cd[c]:Cd[c]="on"+c}function uA(c,d){if(c.da)c=!0;else{d=new jo(d,this);var f=c.listener,m=c.ha||c.src;c.fa&&Dd(c),c=f.call(m,d)}return c}function Sd(c){return c=c[bd],c instanceof Sa?c:null}var Ad="__closure_events_fn_"+(1e9*Math.random()>>>0);function Nd(c){return typeof c=="function"?c:(c[Ad]||(c[Ad]=function(d){return c.handleEvent(d)}),c[Ad])}function Je(){Cn.call(this),this.i=new Sa(this),this.M=this,this.F=null}D(Je,Cn),Je.prototype[Uo]=!0,Je.prototype.removeEventListener=function(c,d,f,m){iv(this,c,d,f,m)};function at(c,d){var f,m=c.F;if(m)for(f=[];m;m=m.F)f.push(m);if(c=c.M,m=d.type||d,typeof d=="string")d=new Ye(d,c);else if(d instanceof Ye)d.target=d.target||c;else{var C=d;d=new Ye(m,c),T(d,C)}if(C=!0,f)for(var x=f.length-1;0<=x;x--){var F=d.g=f[x];C=Aa(F,m,!0,d)&&C}if(F=d.g=c,C=Aa(F,m,!0,d)&&C,C=Aa(F,m,!1,d)&&C,f)for(x=0;x<f.length;x++)F=d.g=f[x],C=Aa(F,m,!1,d)&&C}Je.prototype.N=function(){if(Je.aa.N.call(this),this.i){var c=this.i,d;for(d in c.g){for(var f=c.g[d],m=0;m<f.length;m++)Da(f[m]);delete c.g[d],c.h--}}this.F=null},Je.prototype.K=function(c,d,f,m){return this.i.add(String(c),d,!1,f,m)},Je.prototype.L=function(c,d,f,m){return this.i.add(String(c),d,!0,f,m)};function Aa(c,d,f,m){if(d=c.i.g[String(d)],!d)return!0;d=d.concat();for(var C=!0,x=0;x<d.length;++x){var F=d[x];if(F&&!F.da&&F.capture==f){var ye=F.listener,Ge=F.ha||F.src;F.fa&&Ed(c.i,F),C=ye.call(Ge,m)!==!1&&C}}return C&&!m.defaultPrevented}function sv(c,d,f){if(typeof c=="function")f&&(c=g(c,f));else if(c&&typeof c.handleEvent=="function")c=g(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(d)?-1:a.setTimeout(c,d||0)}function av(c){c.g=sv(()=>{c.g=null,c.i&&(c.i=!1,av(c))},c.l);let d=c.h;c.h=null,c.m.apply(null,d)}class lA extends Cn{constructor(d,f){super(),this.m=d,this.l=f,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:av(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Bo(c){Cn.call(this),this.h=c,this.g={}}D(Bo,Cn);var cv=[];function uv(c){H(c.g,function(d,f){this.g.hasOwnProperty(f)&&Dd(d)},c),c.g={}}Bo.prototype.N=function(){Bo.aa.N.call(this),uv(this)},Bo.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var xd=a.JSON.stringify,dA=a.JSON.parse,hA=class{stringify(c){return a.JSON.stringify(c,void 0)}parse(c){return a.JSON.parse(c,void 0)}};function Rd(){}Rd.prototype.h=null;function lv(c){return c.h||(c.h=c.i())}function dv(){}var $o={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Pd(){Ye.call(this,"d")}D(Pd,Ye);function Md(){Ye.call(this,"c")}D(Md,Ye);var vr={},hv=null;function Na(){return hv=hv||new Je}vr.La="serverreachability";function fv(c){Ye.call(this,vr.La,c)}D(fv,Ye);function qo(c){let d=Na();at(d,new fv(d))}vr.STAT_EVENT="statevent";function pv(c,d){Ye.call(this,vr.STAT_EVENT,c),this.stat=d}D(pv,Ye);function ct(c){let d=Na();at(d,new pv(d,c))}vr.Ma="timingevent";function mv(c,d){Ye.call(this,vr.Ma,c),this.size=d}D(mv,Ye);function Ho(c,d){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){c()},d)}function zo(){this.g=!0}zo.prototype.xa=function(){this.g=!1};function fA(c,d,f,m,C,x){c.info(function(){if(c.g)if(x)for(var F="",ye=x.split("&"),Ge=0;Ge<ye.length;Ge++){var le=ye[Ge].split("=");if(1<le.length){var Ze=le[0];le=le[1];var Xe=Ze.split("_");F=2<=Xe.length&&Xe[1]=="type"?F+(Ze+"="+le+"&"):F+(Ze+"=redacted&")}}else F=null;else F=x;return"XMLHTTP REQ ("+m+") [attempt "+C+"]: "+d+`
`+f+`
`+F})}function pA(c,d,f,m,C,x,F){c.info(function(){return"XMLHTTP RESP ("+m+") [ attempt "+C+"]: "+d+`
`+f+`
`+x+" "+F})}function vi(c,d,f,m){c.info(function(){return"XMLHTTP TEXT ("+d+"): "+gA(c,f)+(m?" "+m:"")})}function mA(c,d){c.info(function(){return"TIMEOUT: "+d})}zo.prototype.info=function(){};function gA(c,d){if(!c.g)return d;if(!d)return null;try{var f=JSON.parse(d);if(f){for(c=0;c<f.length;c++)if(Array.isArray(f[c])){var m=f[c];if(!(2>m.length)){var C=m[1];if(Array.isArray(C)&&!(1>C.length)){var x=C[0];if(x!="noop"&&x!="stop"&&x!="close")for(var F=1;F<C.length;F++)C[F]=""}}}}return xd(f)}catch{return d}}var xa={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},gv={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},kd;function Ra(){}D(Ra,Rd),Ra.prototype.g=function(){return new XMLHttpRequest},Ra.prototype.i=function(){return{}},kd=new Ra;function Dn(c,d,f,m){this.j=c,this.i=d,this.l=f,this.R=m||1,this.U=new Bo(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new yv}function yv(){this.i=null,this.g="",this.h=!1}var vv={},Od={};function Ld(c,d,f){c.L=1,c.v=Oa(on(d)),c.m=f,c.P=!0,_v(c,null)}function _v(c,d){c.F=Date.now(),Pa(c),c.A=on(c.v);var f=c.A,m=c.R;Array.isArray(m)||(m=[String(m)]),Mv(f.i,"t",m),c.C=0,f=c.j.J,c.h=new yv,c.g=Jv(c.j,f?d:null,!c.m),0<c.O&&(c.M=new lA(g(c.Y,c,c.g),c.O)),d=c.U,f=c.g,m=c.ca;var C="readystatechange";Array.isArray(C)||(C&&(cv[0]=C.toString()),C=cv);for(var x=0;x<C.length;x++){var F=tv(f,C[x],m||d.handleEvent,!1,d.h||d);if(!F)break;d.g[F.key]=F}d=c.H?v(c.H):{},c.m?(c.u||(c.u="POST"),d["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,d)):(c.u="GET",c.g.ea(c.A,c.u,null,d)),qo(),fA(c.i,c.u,c.A,c.l,c.R,c.m)}Dn.prototype.ca=function(c){c=c.target;let d=this.M;d&&sn(c)==3?d.j():this.Y(c)},Dn.prototype.Y=function(c){try{if(c==this.g)e:{let Xe=sn(this.g);var d=this.g.Ba();let wi=this.g.Z();if(!(3>Xe)&&(Xe!=3||this.g&&(this.h.h||this.g.oa()||Uv(this.g)))){this.J||Xe!=4||d==7||(d==8||0>=wi?qo(3):qo(2)),Vd(this);var f=this.g.Z();this.X=f;t:if(Iv(this)){var m=Uv(this.g);c="";var C=m.length,x=sn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){_r(this),Go(this);var F="";break t}this.h.i=new a.TextDecoder}for(d=0;d<C;d++)this.h.h=!0,c+=this.h.i.decode(m[d],{stream:!(x&&d==C-1)});m.length=0,this.h.g+=c,this.C=0,F=this.h.g}else F=this.g.oa();if(this.o=f==200,pA(this.i,this.u,this.A,this.l,this.R,Xe,f),this.o){if(this.T&&!this.K){t:{if(this.g){var ye,Ge=this.g;if((ye=Ge.g?Ge.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!B(ye)){var le=ye;break t}}le=null}if(f=le)vi(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Fd(this,f);else{this.o=!1,this.s=3,ct(12),_r(this),Go(this);break e}}if(this.P){f=!0;let Nt;for(;!this.J&&this.C<F.length;)if(Nt=yA(this,F),Nt==Od){Xe==4&&(this.s=4,ct(14),f=!1),vi(this.i,this.l,null,"[Incomplete Response]");break}else if(Nt==vv){this.s=4,ct(15),vi(this.i,this.l,F,"[Invalid Chunk]"),f=!1;break}else vi(this.i,this.l,Nt,null),Fd(this,Nt);if(Iv(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Xe!=4||F.length!=0||this.h.h||(this.s=1,ct(16),f=!1),this.o=this.o&&f,!f)vi(this.i,this.l,F,"[Invalid Chunked Response]"),_r(this),Go(this);else if(0<F.length&&!this.W){this.W=!0;var Ze=this.j;Ze.g==this&&Ze.ba&&!Ze.M&&(Ze.j.info("Great, no buffering proxy detected. Bytes received: "+F.length),Hd(Ze),Ze.M=!0,ct(11))}}else vi(this.i,this.l,F,null),Fd(this,F);Xe==4&&_r(this),this.o&&!this.J&&(Xe==4?Wv(this.j,this):(this.o=!1,Pa(this)))}else kA(this.g),f==400&&0<F.indexOf("Unknown SID")?(this.s=3,ct(12)):(this.s=0,ct(13)),_r(this),Go(this)}}}catch{}finally{}};function Iv(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function yA(c,d){var f=c.C,m=d.indexOf(`
`,f);return m==-1?Od:(f=Number(d.substring(f,m)),isNaN(f)?vv:(m+=1,m+f>d.length?Od:(d=d.slice(m,m+f),c.C=m+f,d)))}Dn.prototype.cancel=function(){this.J=!0,_r(this)};function Pa(c){c.S=Date.now()+c.I,wv(c,c.I)}function wv(c,d){if(c.B!=null)throw Error("WatchDog timer not null");c.B=Ho(g(c.ba,c),d)}function Vd(c){c.B&&(a.clearTimeout(c.B),c.B=null)}Dn.prototype.ba=function(){this.B=null;let c=Date.now();0<=c-this.S?(mA(this.i,this.A),this.L!=2&&(qo(),ct(17)),_r(this),this.s=2,Go(this)):wv(this,this.S-c)};function Go(c){c.j.G==0||c.J||Wv(c.j,c)}function _r(c){Vd(c);var d=c.M;d&&typeof d.ma=="function"&&d.ma(),c.M=null,uv(c.U),c.g&&(d=c.g,c.g=null,d.abort(),d.ma())}function Fd(c,d){try{var f=c.j;if(f.G!=0&&(f.g==c||jd(f.h,c))){if(!c.K&&jd(f.h,c)&&f.G==3){try{var m=f.Da.g.parse(d)}catch{m=null}if(Array.isArray(m)&&m.length==3){var C=m;if(C[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<c.F)Ua(f),Fa(f);else break e;qd(f),ct(18)}}else f.za=C[1],0<f.za-f.T&&37500>C[2]&&f.F&&f.v==0&&!f.C&&(f.C=Ho(g(f.Za,f),6e3));if(1>=bv(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else wr(f,11)}else if((c.K||f.g==c)&&Ua(f),!B(d))for(C=f.Da.g.parse(d),d=0;d<C.length;d++){let le=C[d];if(f.T=le[0],le=le[1],f.G==2)if(le[0]=="c"){f.K=le[1],f.ia=le[2];let Ze=le[3];Ze!=null&&(f.la=Ze,f.j.info("VER="+f.la));let Xe=le[4];Xe!=null&&(f.Aa=Xe,f.j.info("SVER="+f.Aa));let wi=le[5];wi!=null&&typeof wi=="number"&&0<wi&&(m=1.5*wi,f.L=m,f.j.info("backChannelRequestTimeoutMs_="+m)),m=f;let Nt=c.g;if(Nt){let $a=Nt.g?Nt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if($a){var x=m.h;x.g||$a.indexOf("spdy")==-1&&$a.indexOf("quic")==-1&&$a.indexOf("h2")==-1||(x.j=x.l,x.g=new Set,x.h&&(Ud(x,x.h),x.h=null))}if(m.D){let zd=Nt.g?Nt.g.getResponseHeader("X-HTTP-Session-Id"):null;zd&&(m.ya=zd,we(m.I,m.D,zd))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-c.F,f.j.info("Handshake RTT: "+f.R+"ms")),m=f;var F=c;if(m.qa=Yv(m,m.J?m.ia:null,m.W),F.K){Cv(m.h,F);var ye=F,Ge=m.L;Ge&&(ye.I=Ge),ye.B&&(Vd(ye),Pa(ye)),m.g=F}else zv(m);0<f.i.length&&ja(f)}else le[0]!="stop"&&le[0]!="close"||wr(f,7);else f.G==3&&(le[0]=="stop"||le[0]=="close"?le[0]=="stop"?wr(f,7):$d(f):le[0]!="noop"&&f.l&&f.l.ta(le),f.v=0)}}qo(4)}catch{}}var vA=class{constructor(c,d){this.g=c,this.map=d}};function Ev(c){this.l=c||10,a.PerformanceNavigationTiming?(c=a.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Tv(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function bv(c){return c.h?1:c.g?c.g.size:0}function jd(c,d){return c.h?c.h==d:c.g?c.g.has(d):!1}function Ud(c,d){c.g?c.g.add(d):c.h=d}function Cv(c,d){c.h&&c.h==d?c.h=null:c.g&&c.g.has(d)&&c.g.delete(d)}Ev.prototype.cancel=function(){if(this.i=Dv(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let c of this.g.values())c.cancel();this.g.clear()}};function Dv(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let d=c.i;for(let f of c.g.values())d=d.concat(f.D);return d}return R(c.i)}function _A(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(u(c)){for(var d=[],f=c.length,m=0;m<f;m++)d.push(c[m]);return d}d=[],f=0;for(m in c)d[f++]=c[m];return d}function IA(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(u(c)||typeof c=="string"){var d=[];c=c.length;for(var f=0;f<c;f++)d.push(f);return d}d=[],f=0;for(let m in c)d[f++]=m;return d}}}function Sv(c,d){if(c.forEach&&typeof c.forEach=="function")c.forEach(d,void 0);else if(u(c)||typeof c=="string")Array.prototype.forEach.call(c,d,void 0);else for(var f=IA(c),m=_A(c),C=m.length,x=0;x<C;x++)d.call(void 0,m[x],f&&f[x],c)}var Av=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function wA(c,d){if(c){c=c.split("&");for(var f=0;f<c.length;f++){var m=c[f].indexOf("="),C=null;if(0<=m){var x=c[f].substring(0,m);C=c[f].substring(m+1)}else x=c[f];d(x,C?decodeURIComponent(C.replace(/\+/g," ")):"")}}}function Ir(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof Ir){this.h=c.h,Ma(this,c.j),this.o=c.o,this.g=c.g,ka(this,c.s),this.l=c.l;var d=c.i,f=new Qo;f.i=d.i,d.g&&(f.g=new Map(d.g),f.h=d.h),Nv(this,f),this.m=c.m}else c&&(d=String(c).match(Av))?(this.h=!1,Ma(this,d[1]||"",!0),this.o=Wo(d[2]||""),this.g=Wo(d[3]||"",!0),ka(this,d[4]),this.l=Wo(d[5]||"",!0),Nv(this,d[6]||"",!0),this.m=Wo(d[7]||"")):(this.h=!1,this.i=new Qo(null,this.h))}Ir.prototype.toString=function(){var c=[],d=this.j;d&&c.push(Ko(d,xv,!0),":");var f=this.g;return(f||d=="file")&&(c.push("//"),(d=this.o)&&c.push(Ko(d,xv,!0),"@"),c.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&c.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&c.push("/"),c.push(Ko(f,f.charAt(0)=="/"?bA:TA,!0))),(f=this.i.toString())&&c.push("?",f),(f=this.m)&&c.push("#",Ko(f,DA)),c.join("")};function on(c){return new Ir(c)}function Ma(c,d,f){c.j=f?Wo(d,!0):d,c.j&&(c.j=c.j.replace(/:$/,""))}function ka(c,d){if(d){if(d=Number(d),isNaN(d)||0>d)throw Error("Bad port number "+d);c.s=d}else c.s=null}function Nv(c,d,f){d instanceof Qo?(c.i=d,SA(c.i,c.h)):(f||(d=Ko(d,CA)),c.i=new Qo(d,c.h))}function we(c,d,f){c.i.set(d,f)}function Oa(c){return we(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function Wo(c,d){return c?d?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function Ko(c,d,f){return typeof c=="string"?(c=encodeURI(c).replace(d,EA),f&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function EA(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var xv=/[#\/\?@]/g,TA=/[#\?:]/g,bA=/[#\?]/g,CA=/[#\?@]/g,DA=/#/g;function Qo(c,d){this.h=this.g=null,this.i=c||null,this.j=!!d}function Sn(c){c.g||(c.g=new Map,c.h=0,c.i&&wA(c.i,function(d,f){c.add(decodeURIComponent(d.replace(/\+/g," ")),f)}))}n=Qo.prototype,n.add=function(c,d){Sn(this),this.i=null,c=_i(this,c);var f=this.g.get(c);return f||this.g.set(c,f=[]),f.push(d),this.h+=1,this};function Rv(c,d){Sn(c),d=_i(c,d),c.g.has(d)&&(c.i=null,c.h-=c.g.get(d).length,c.g.delete(d))}function Pv(c,d){return Sn(c),d=_i(c,d),c.g.has(d)}n.forEach=function(c,d){Sn(this),this.g.forEach(function(f,m){f.forEach(function(C){c.call(d,C,m,this)},this)},this)},n.na=function(){Sn(this);let c=Array.from(this.g.values()),d=Array.from(this.g.keys()),f=[];for(let m=0;m<d.length;m++){let C=c[m];for(let x=0;x<C.length;x++)f.push(d[m])}return f},n.V=function(c){Sn(this);let d=[];if(typeof c=="string")Pv(this,c)&&(d=d.concat(this.g.get(_i(this,c))));else{c=Array.from(this.g.values());for(let f=0;f<c.length;f++)d=d.concat(c[f])}return d},n.set=function(c,d){return Sn(this),this.i=null,c=_i(this,c),Pv(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[d]),this.h+=1,this},n.get=function(c,d){return c?(c=this.V(c),0<c.length?String(c[0]):d):d};function Mv(c,d,f){Rv(c,d),0<f.length&&(c.i=null,c.g.set(_i(c,d),R(f)),c.h+=f.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let c=[],d=Array.from(this.g.keys());for(var f=0;f<d.length;f++){var m=d[f];let x=encodeURIComponent(String(m)),F=this.V(m);for(m=0;m<F.length;m++){var C=x;F[m]!==""&&(C+="="+encodeURIComponent(String(F[m]))),c.push(C)}}return this.i=c.join("&")};function _i(c,d){return d=String(d),c.j&&(d=d.toLowerCase()),d}function SA(c,d){d&&!c.j&&(Sn(c),c.i=null,c.g.forEach(function(f,m){var C=m.toLowerCase();m!=C&&(Rv(this,m),Mv(this,C,f))},c)),c.j=d}function AA(c,d){let f=new zo;if(a.Image){let m=new Image;m.onload=y(An,f,"TestLoadImage: loaded",!0,d,m),m.onerror=y(An,f,"TestLoadImage: error",!1,d,m),m.onabort=y(An,f,"TestLoadImage: abort",!1,d,m),m.ontimeout=y(An,f,"TestLoadImage: timeout",!1,d,m),a.setTimeout(function(){m.ontimeout&&m.ontimeout()},1e4),m.src=c}else d(!1)}function NA(c,d){let f=new zo,m=new AbortController,C=setTimeout(()=>{m.abort(),An(f,"TestPingServer: timeout",!1,d)},1e4);fetch(c,{signal:m.signal}).then(x=>{clearTimeout(C),x.ok?An(f,"TestPingServer: ok",!0,d):An(f,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(C),An(f,"TestPingServer: error",!1,d)})}function An(c,d,f,m,C){try{C&&(C.onload=null,C.onerror=null,C.onabort=null,C.ontimeout=null),m(f)}catch{}}function xA(){this.g=new hA}function RA(c,d,f){let m=f||"";try{Sv(c,function(C,x){let F=C;l(C)&&(F=xd(C)),d.push(m+x+"="+encodeURIComponent(F))})}catch(C){throw d.push(m+"type="+encodeURIComponent("_badmap")),C}}function Yo(c){this.l=c.Ub||null,this.j=c.eb||!1}D(Yo,Rd),Yo.prototype.g=function(){return new La(this.l,this.j)},Yo.prototype.i=function(c){return function(){return c}}({});function La(c,d){Je.call(this),this.D=c,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}D(La,Je),n=La.prototype,n.open=function(c,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=d,this.readyState=1,Zo(this)},n.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let d={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(d.body=c),(this.D||a).fetch(new Request(this.A,d)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Jo(this)),this.readyState=0},n.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,Zo(this)),this.g&&(this.readyState=3,Zo(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;kv(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function kv(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}n.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var d=c.value?c.value:new Uint8Array(0);(d=this.v.decode(d,{stream:!c.done}))&&(this.response=this.responseText+=d)}c.done?Jo(this):Zo(this),this.readyState==3&&kv(this)}},n.Ra=function(c){this.g&&(this.response=this.responseText=c,Jo(this))},n.Qa=function(c){this.g&&(this.response=c,Jo(this))},n.ga=function(){this.g&&Jo(this)};function Jo(c){c.readyState=4,c.l=null,c.j=null,c.v=null,Zo(c)}n.setRequestHeader=function(c,d){this.u.append(c,d)},n.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let c=[],d=this.h.entries();for(var f=d.next();!f.done;)f=f.value,c.push(f[0]+": "+f[1]),f=d.next();return c.join(`\r
`)};function Zo(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(La.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function Ov(c){let d="";return H(c,function(f,m){d+=m,d+=":",d+=f,d+=`\r
`}),d}function Bd(c,d,f){e:{for(m in f){var m=!1;break e}m=!0}m||(f=Ov(f),typeof c=="string"?f!=null&&encodeURIComponent(String(f)):we(c,d,f))}function Ce(c){Je.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}D(Ce,Je);var PA=/^https?$/i,MA=["POST","PUT"];n=Ce.prototype,n.Ha=function(c){this.J=c},n.ea=function(c,d,f,m){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);d=d?d.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():kd.g(),this.v=this.o?lv(this.o):lv(kd),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(d,String(c),!0),this.B=!1}catch(x){Lv(this,x);return}if(c=f||"",f=new Map(this.headers),m)if(Object.getPrototypeOf(m)===Object.prototype)for(var C in m)f.set(C,m[C]);else if(typeof m.keys=="function"&&typeof m.get=="function")for(let x of m.keys())f.set(x,m.get(x));else throw Error("Unknown input type for opt_headers: "+String(m));m=Array.from(f.keys()).find(x=>x.toLowerCase()=="content-type"),C=a.FormData&&c instanceof a.FormData,!(0<=Array.prototype.indexOf.call(MA,d,void 0))||m||C||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[x,F]of f)this.g.setRequestHeader(x,F);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{jv(this),this.u=!0,this.g.send(c),this.u=!1}catch(x){Lv(this,x)}};function Lv(c,d){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=d,c.m=5,Vv(c),Va(c)}function Vv(c){c.A||(c.A=!0,at(c,"complete"),at(c,"error"))}n.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,at(this,"complete"),at(this,"abort"),Va(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Va(this,!0)),Ce.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Fv(this):this.bb())},n.bb=function(){Fv(this)};function Fv(c){if(c.h&&typeof s<"u"&&(!c.v[1]||sn(c)!=4||c.Z()!=2)){if(c.u&&sn(c)==4)sv(c.Ea,0,c);else if(at(c,"readystatechange"),sn(c)==4){c.h=!1;try{let F=c.Z();e:switch(F){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var f;if(!(f=d)){var m;if(m=F===0){var C=String(c.D).match(Av)[1]||null;!C&&a.self&&a.self.location&&(C=a.self.location.protocol.slice(0,-1)),m=!PA.test(C?C.toLowerCase():"")}f=m}if(f)at(c,"complete"),at(c,"success");else{c.m=6;try{var x=2<sn(c)?c.g.statusText:""}catch{x=""}c.l=x+" ["+c.Z()+"]",Vv(c)}}finally{Va(c)}}}}function Va(c,d){if(c.g){jv(c);let f=c.g,m=c.v[0]?()=>{}:null;c.g=null,c.v=null,d||at(c,"ready");try{f.onreadystatechange=m}catch{}}}function jv(c){c.I&&(a.clearTimeout(c.I),c.I=null)}n.isActive=function(){return!!this.g};function sn(c){return c.g?c.g.readyState:0}n.Z=function(){try{return 2<sn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(c){if(this.g){var d=this.g.responseText;return c&&d.indexOf(c)==0&&(d=d.substring(c.length)),dA(d)}};function Uv(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function kA(c){let d={};c=(c.g&&2<=sn(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let m=0;m<c.length;m++){if(B(c[m]))continue;var f=b(c[m]);let C=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();let x=d[C]||[];d[C]=x,x.push(f)}E(d,function(m){return m.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Xo(c,d,f){return f&&f.internalChannelParams&&f.internalChannelParams[c]||d}function Bv(c){this.Aa=0,this.i=[],this.j=new zo,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Xo("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Xo("baseRetryDelayMs",5e3,c),this.cb=Xo("retryDelaySeedMs",1e4,c),this.Wa=Xo("forwardChannelMaxRetries",2,c),this.wa=Xo("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new Ev(c&&c.concurrentRequestLimit),this.Da=new xA,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Bv.prototype,n.la=8,n.G=1,n.connect=function(c,d,f,m){ct(0),this.W=c,this.H=d||{},f&&m!==void 0&&(this.H.OSID=f,this.H.OAID=m),this.F=this.X,this.I=Yv(this,null,this.W),ja(this)};function $d(c){if($v(c),c.G==3){var d=c.U++,f=on(c.I);if(we(f,"SID",c.K),we(f,"RID",d),we(f,"TYPE","terminate"),es(c,f),d=new Dn(c,c.j,d),d.L=2,d.v=Oa(on(f)),f=!1,a.navigator&&a.navigator.sendBeacon)try{f=a.navigator.sendBeacon(d.v.toString(),"")}catch{}!f&&a.Image&&(new Image().src=d.v,f=!0),f||(d.g=Jv(d.j,null),d.g.ea(d.v)),d.F=Date.now(),Pa(d)}Qv(c)}function Fa(c){c.g&&(Hd(c),c.g.cancel(),c.g=null)}function $v(c){Fa(c),c.u&&(a.clearTimeout(c.u),c.u=null),Ua(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&a.clearTimeout(c.s),c.s=null)}function ja(c){if(!Tv(c.h)&&!c.s){c.s=!0;var d=c.Ga;Vo||ev(),Fo||(Vo(),Fo=!0),wd.add(d,c),c.B=0}}function OA(c,d){return bv(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=d.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=Ho(g(c.Ga,c,d),Kv(c,c.B)),c.B++,!0)}n.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;let C=new Dn(this,this.j,c),x=this.o;if(this.S&&(x?(x=v(x),T(x,this.S)):x=this.S),this.m!==null||this.O||(C.H=x,x=null),this.P)e:{for(var d=0,f=0;f<this.i.length;f++){t:{var m=this.i[f];if("__data__"in m.map&&(m=m.map.__data__,typeof m=="string")){m=m.length;break t}m=void 0}if(m===void 0)break;if(d+=m,4096<d){d=f;break e}if(d===4096||f===this.i.length-1){d=f+1;break e}}d=1e3}else d=1e3;d=Hv(this,C,d),f=on(this.I),we(f,"RID",c),we(f,"CVER",22),this.D&&we(f,"X-HTTP-Session-Id",this.D),es(this,f),x&&(this.O?d="headers="+encodeURIComponent(String(Ov(x)))+"&"+d:this.m&&Bd(f,this.m,x)),Ud(this.h,C),this.Ua&&we(f,"TYPE","init"),this.P?(we(f,"$req",d),we(f,"SID","null"),C.T=!0,Ld(C,f,null)):Ld(C,f,d),this.G=2}}else this.G==3&&(c?qv(this,c):this.i.length==0||Tv(this.h)||qv(this))};function qv(c,d){var f;d?f=d.l:f=c.U++;let m=on(c.I);we(m,"SID",c.K),we(m,"RID",f),we(m,"AID",c.T),es(c,m),c.m&&c.o&&Bd(m,c.m,c.o),f=new Dn(c,c.j,f,c.B+1),c.m===null&&(f.H=c.o),d&&(c.i=d.D.concat(c.i)),d=Hv(c,f,1e3),f.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),Ud(c.h,f),Ld(f,m,d)}function es(c,d){c.H&&H(c.H,function(f,m){we(d,m,f)}),c.l&&Sv({},function(f,m){we(d,m,f)})}function Hv(c,d,f){f=Math.min(c.i.length,f);var m=c.l?g(c.l.Na,c.l,c):null;e:{var C=c.i;let x=-1;for(;;){let F=["count="+f];x==-1?0<f?(x=C[0].g,F.push("ofs="+x)):x=0:F.push("ofs="+x);let ye=!0;for(let Ge=0;Ge<f;Ge++){let le=C[Ge].g,Ze=C[Ge].map;if(le-=x,0>le)x=Math.max(0,C[Ge].g-100),ye=!1;else try{RA(Ze,F,"req"+le+"_")}catch{m&&m(Ze)}}if(ye){m=F.join("&");break e}}}return c=c.i.splice(0,f),d.D=c,m}function zv(c){if(!c.g&&!c.u){c.Y=1;var d=c.Fa;Vo||ev(),Fo||(Vo(),Fo=!0),wd.add(d,c),c.v=0}}function qd(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=Ho(g(c.Fa,c),Kv(c,c.v)),c.v++,!0)}n.Fa=function(){if(this.u=null,Gv(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=Ho(g(this.ab,this),c)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ct(10),Fa(this),Gv(this))};function Hd(c){c.A!=null&&(a.clearTimeout(c.A),c.A=null)}function Gv(c){c.g=new Dn(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var d=on(c.qa);we(d,"RID","rpc"),we(d,"SID",c.K),we(d,"AID",c.T),we(d,"CI",c.F?"0":"1"),!c.F&&c.ja&&we(d,"TO",c.ja),we(d,"TYPE","xmlhttp"),es(c,d),c.m&&c.o&&Bd(d,c.m,c.o),c.L&&(c.g.I=c.L);var f=c.g;c=c.ia,f.L=1,f.v=Oa(on(d)),f.m=null,f.P=!0,_v(f,c)}n.Za=function(){this.C!=null&&(this.C=null,Fa(this),qd(this),ct(19))};function Ua(c){c.C!=null&&(a.clearTimeout(c.C),c.C=null)}function Wv(c,d){var f=null;if(c.g==d){Ua(c),Hd(c),c.g=null;var m=2}else if(jd(c.h,d))f=d.D,Cv(c.h,d),m=1;else return;if(c.G!=0){if(d.o)if(m==1){f=d.m?d.m.length:0,d=Date.now()-d.F;var C=c.B;m=Na(),at(m,new mv(m,f)),ja(c)}else zv(c);else if(C=d.s,C==3||C==0&&0<d.X||!(m==1&&OA(c,d)||m==2&&qd(c)))switch(f&&0<f.length&&(d=c.h,d.i=d.i.concat(f)),C){case 1:wr(c,5);break;case 4:wr(c,10);break;case 3:wr(c,6);break;default:wr(c,2)}}}function Kv(c,d){let f=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(f*=2),f*d}function wr(c,d){if(c.j.info("Error code "+d),d==2){var f=g(c.fb,c),m=c.Xa;let C=!m;m=new Ir(m||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Ma(m,"https"),Oa(m),C?AA(m.toString(),f):NA(m.toString(),f)}else ct(2);c.G=0,c.l&&c.l.sa(d),Qv(c),$v(c)}n.fb=function(c){c?(this.j.info("Successfully pinged google.com"),ct(2)):(this.j.info("Failed to ping google.com"),ct(1))};function Qv(c){if(c.G=0,c.ka=[],c.l){let d=Dv(c.h);(d.length!=0||c.i.length!=0)&&(P(c.ka,d),P(c.ka,c.i),c.h.i.length=0,R(c.i),c.i.length=0),c.l.ra()}}function Yv(c,d,f){var m=f instanceof Ir?on(f):new Ir(f);if(m.g!="")d&&(m.g=d+"."+m.g),ka(m,m.s);else{var C=a.location;m=C.protocol,d=d?d+"."+C.hostname:C.hostname,C=+C.port;var x=new Ir(null);m&&Ma(x,m),d&&(x.g=d),C&&ka(x,C),f&&(x.l=f),m=x}return f=c.D,d=c.ya,f&&d&&we(m,f,d),we(m,"VER",c.la),es(c,m),m}function Jv(c,d,f){if(d&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return d=c.Ca&&!c.pa?new Ce(new Yo({eb:f})):new Ce(c.pa),d.Ha(c.J),d}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Zv(){}n=Zv.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Ba(){}Ba.prototype.g=function(c,d){return new gt(c,d)};function gt(c,d){Je.call(this),this.g=new Bv(d),this.l=c,this.h=d&&d.messageUrlParams||null,c=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(c?c["X-WebChannel-Content-Type"]=d.messageContentType:c={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.va&&(c?c["X-WebChannel-Client-Profile"]=d.va:c={"X-WebChannel-Client-Profile":d.va}),this.g.S=c,(c=d&&d.Sb)&&!B(c)&&(this.g.m=c),this.v=d&&d.supportsCrossDomainXhr||!1,this.u=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!B(d)&&(this.g.D=d,c=this.h,c!==null&&d in c&&(c=this.h,d in c&&delete c[d])),this.j=new Ii(this)}D(gt,Je),gt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},gt.prototype.close=function(){$d(this.g)},gt.prototype.o=function(c){var d=this.g;if(typeof c=="string"){var f={};f.__data__=c,c=f}else this.u&&(f={},f.__data__=xd(c),c=f);d.i.push(new vA(d.Ya++,c)),d.G==3&&ja(d)},gt.prototype.N=function(){this.g.l=null,delete this.j,$d(this.g),delete this.g,gt.aa.N.call(this)};function Xv(c){Pd.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var d=c.__sm__;if(d){e:{for(let f in d){c=f;break e}c=void 0}(this.i=c)&&(c=this.i,d=d!==null&&c in d?d[c]:void 0),this.data=d}else this.data=c}D(Xv,Pd);function e_(){Md.call(this),this.status=1}D(e_,Md);function Ii(c){this.g=c}D(Ii,Zv),Ii.prototype.ua=function(){at(this.g,"a")},Ii.prototype.ta=function(c){at(this.g,new Xv(c))},Ii.prototype.sa=function(c){at(this.g,new e_)},Ii.prototype.ra=function(){at(this.g,"b")},Ba.prototype.createWebChannel=Ba.prototype.g,gt.prototype.send=gt.prototype.o,gt.prototype.open=gt.prototype.m,gt.prototype.close=gt.prototype.close,em=pn.createWebChannelTransport=function(){return new Ba},Xp=pn.getStatEventTarget=function(){return Na()},Zp=pn.Event=vr,Gu=pn.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},xa.NO_ERROR=0,xa.TIMEOUT=8,xa.HTTP_ERROR=6,Os=pn.ErrorCode=xa,gv.COMPLETE="complete",Jp=pn.EventType=gv,dv.EventType=$o,$o.OPEN="a",$o.CLOSE="b",$o.ERROR="c",$o.MESSAGE="d",Je.prototype.listen=Je.prototype.K,Yi=pn.WebChannel=dv,Yp=pn.FetchXmlHttpFactory=Yo,Ce.prototype.listenOnce=Ce.prototype.L,Ce.prototype.getLastError=Ce.prototype.Ka,Ce.prototype.getLastErrorCode=Ce.prototype.Ba,Ce.prototype.getStatus=Ce.prototype.Z,Ce.prototype.getResponseJson=Ce.prototype.Oa,Ce.prototype.getResponseText=Ce.prototype.oa,Ce.prototype.send=Ce.prototype.ea,Ce.prototype.setWithCredentials=Ce.prototype.Ha,Qp=pn.XhrIo=Ce}).apply(typeof zu<"u"?zu:typeof self<"u"?self:typeof window<"u"?window:{});var GT="@firebase/firestore";var Fe=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Fe.UNAUTHENTICATED=new Fe(null),Fe.GOOGLE_CREDENTIALS=new Fe("google-credentials-uid"),Fe.FIRST_PARTY=new Fe("first-party-uid"),Fe.MOCK_USER=new Fe("mock-user");var No="10.12.5";var Xn=new $n("@firebase/firestore");function to(){return Xn.logLevel}function Yb(n){Xn.setLogLevel(n)}function k(n,...e){if(Xn.logLevel<=ie.DEBUG){let t=e.map(dy);Xn.debug(`Firestore (${No}): ${n}`,...t)}}function Ne(n,...e){if(Xn.logLevel<=ie.ERROR){let t=e.map(dy);Xn.error(`Firestore (${No}): ${n}`,...t)}}function wt(n,...e){if(Xn.logLevel<=ie.WARN){let t=e.map(dy);Xn.warn(`Firestore (${No}): ${n}`,...t)}}function dy(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function $(n="Unexpected state"){let e=`FIRESTORE (${No}) INTERNAL ASSERTION FAILED: `+n;throw Ne(e),new Error(e)}function q(n,e){n||$()}function XG(n,e){n||$()}function V(n,e){return n}var N={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},M=class extends Dt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var xe=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var ol=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},om=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Fe.UNAUTHENTICATED))}shutdown(){}},sm=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},am=class{constructor(e){this.t=e,this.currentUser=Fe.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i,i=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve(),o=new xe;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new xe,e.enqueueRetryable(()=>i(this.currentUser))};let s=()=>{let u=o;e.enqueueRetryable(()=>w(this,null,function*(){yield u.promise,yield i(this.currentUser)}))},a=u=>{k("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit(u=>a(u)),setTimeout(()=>{if(!this.auth){let u=this.t.getImmediate({optional:!0});u?a(u):(k("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new xe)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(k("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(q(typeof r.accessToken=="string"),new ol(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return q(e===null||typeof e=="string"),new Fe(e)}},cm=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Fe.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},um=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new cm(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Fe.FIRST_PARTY))}shutdown(){}invalidateToken(){}},sl=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},lm=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){let r=o=>{o.error!=null&&k("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let s=o.token!==this.R;return this.R=o.token,k("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{k("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.A.getImmediate({optional:!0});o?i(o):k("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(q(typeof t.token=="string"),this.R=t.token,new sl(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}},WT=class{getToken(){return Promise.resolve(new sl(""))}invalidateToken(){}start(e,t){}shutdown(){}};function pL(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var al=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=pL(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%e.length))}return r}};function K(n,e){return n<e?-1:n>e?1:0}function uo(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function Jb(n){return n+"\0"}var Re=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new M(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new M(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new M(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new M(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?K(this.nanoseconds,e.nanoseconds):K(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var z=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new Re(0,0))}static max(){return new n(new Re(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var cl=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&$(),r===void 0?r=e.length-t:r>e.length-t&&$(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=e.get(i),s=t.get(i);if(o<s)return-1;if(o>s)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},ce=class n extends cl{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new M(N.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},mL=/^[_a-zA-Z][_a-zA-Z0-9]*$/,je=class n extends cl{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return mL.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,o=()=>{if(r.length===0)throw new M(N.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},s=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new M(N.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new M(N.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else a==="`"?(s=!s,i++):a!=="."||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new M(N.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var j=class n{constructor(e){this.path=e}static fromPath(e){return new n(ce.fromString(e))}static fromName(e){return new n(ce.fromString(e).popFirst(5))}static empty(){return new n(ce.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ce.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ce.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new ce(e.slice()))}};var er=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};function dm(n){return n.fields.find(e=>e.kind===2)}function Xr(n){return n.fields.filter(e=>e.kind!==2)}function gL(n,e){let t=K(n.collectionGroup,e.collectionGroup);if(t!==0)return t;for(let r=0;r<Math.min(n.fields.length,e.fields.length);++r)if(t=yL(n.fields[r],e.fields[r]),t!==0)return t;return K(n.fields.length,e.fields.length)}er.UNKNOWN_ID=-1;var yn=class{constructor(e,t){this.fieldPath=e,this.kind=t}};function yL(n,e){let t=je.comparator(n.fieldPath,e.fieldPath);return t!==0?t:K(n.kind,e.kind)}var lo=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,At.min())}};function Zb(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=z.fromTimestamp(r===1e9?new Re(t+1,0):new Re(t,r));return new At(i,j.empty(),e)}function Xb(n){return new At(n.readTime,n.key,-1)}var At=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(z.min(),j.empty(),-1)}static max(){return new n(z.max(),j.empty(),-1)}};function hy(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=j.comparator(n.documentKey,e.documentKey),t!==0?t:K(n.largestBatchId,e.largestBatchId))}var eC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ul=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function fr(n){return w(this,null,function*(){if(n.code!==N.FAILED_PRECONDITION||n.message!==eC)throw n;k("LocalStore","Unexpectedly lost primary lease")})}var A=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&$(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,o=0,s=!1;e.forEach(a=>{++i,a.next(()=>{++o,s&&o===i&&t()},u=>r(u))}),s=!0,o===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let o=e.length,s=new Array(o),a=0;for(let u=0;u<o;u++){let l=u;t(e[l]).next(h=>{s[l]=h,++a,a===o&&r(s)},h=>i(h))}})}static doWhile(e,t){return new n((r,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}};var ll=class n{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new xe,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new oi(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=fy(r.target.error);this.V.reject(new oi(e,i))}}static open(e,t,r,i){try{return new n(t,e.transaction(i,r))}catch(o){throw new oi(t,o)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(k("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new fm(t)}},tr=class n{constructor(e,t,r){this.name=e,this.version=t,this.p=r,n.S(nt())===12.2&&Ne("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return k("SimpleDb","Removing database:",e),ei(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Su())return!1;if(n.C())return!0;let e=nt(),t=n.S(e),r=0<t&&t<10,i=tC(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.v)==="YES"}static F(e,t){return e.store(t)}static S(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}M(e){return w(this,null,function*(){return this.db||(k("SimpleDb","Opening database:",this.name),this.db=yield new Promise((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=o=>{let s=o.target.result;t(s)},i.onblocked=()=>{r(new oi(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=o=>{let s=o.target.error;s.name==="VersionError"?r(new M(N.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):s.name==="InvalidStateError"?r(new M(N.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+s)):r(new oi(e,s))},i.onupgradeneeded=o=>{k("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);let s=o.target.result;this.p.O(s,i.transaction,o.oldVersion,this.version).next(()=>{k("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db})}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){return w(this,null,function*(){let o=t==="readonly",s=0;for(;;){++s;try{this.db=yield this.M(e);let a=ll.open(this.db,e,o?"readonly":"readwrite",r),u=i(a).next(l=>(a.g(),l)).catch(l=>(a.abort(l),A.reject(l))).toPromise();return u.catch(()=>{}),yield a.m,u}catch(a){let u=a,l=u.name!=="FirebaseError"&&s<3;if(k("SimpleDb","Transaction failed with error:",u.message,"Retrying:",l),this.close(),!l)return Promise.reject(u)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function tC(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var hm=class{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return ei(this.B.delete())}},oi=class extends M{constructor(e,t){super(N.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function pr(n){return n.name==="IndexedDbTransactionError"}var fm=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(k("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(k("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ei(r)}add(e){return k("SimpleDb","ADD",this.store.name,e,e),ei(this.store.add(e))}get(e){return ei(this.store.get(e)).next(t=>(t===void 0&&(t=null),k("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return k("SimpleDb","DELETE",this.store.name,e),ei(this.store.delete(e))}count(){return k("SimpleDb","COUNT",this.store.name),ei(this.store.count())}U(e,t){let r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let o=i.getAll(r.range);return new A((s,a)=>{o.onerror=u=>{a(u.target.error)},o.onsuccess=u=>{s(u.target.result)}})}{let o=this.cursor(r),s=[];return this.W(o,(a,u)=>{s.push(u)}).next(()=>s)}}G(e,t){let r=this.store.getAll(e,t===null?void 0:t);return new A((i,o)=>{r.onerror=s=>{o(s.target.error)},r.onsuccess=s=>{i(s.target.result)}})}j(e,t){k("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,t);r.H=!1;let i=this.cursor(r);return this.W(i,(o,s,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.W(i,t)}Y(e){let t=this.cursor({});return new A((r,i)=>{t.onerror=o=>{let s=fy(o.target.error);i(s)},t.onsuccess=o=>{let s=o.target.result;s?e(s.primaryKey,s.value).next(a=>{a?s.continue():r()}):r()}})}W(e,t){let r=[];return new A((i,o)=>{e.onerror=s=>{o(s.target.error)},e.onsuccess=s=>{let a=s.target.result;if(!a)return void i();let u=new hm(a),l=t(a.primaryKey,a.value,u);if(l instanceof A){let h=l.catch(p=>(u.done(),A.reject(p)));r.push(h)}u.isDone?i():u.K===null?a.continue():a.continue(u.K)}}).next(()=>A.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function ei(n){return new A((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=fy(r.target.error);t(i)}})}var KT=!1;function fy(n){let e=tr.S(nt());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new M("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return KT||(KT=!0,setTimeout(()=>{throw r},0)),r}}return n}var pm=class{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){k("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>w(this,null,function*(){this.task=null;try{k("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(t){pr(t)?k("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):yield fr(t)}yield this.X(6e4)}))}},mm=class{constructor(e,t){this.localStore=e,this.persistence=t}ee(e=50){return w(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))})}te(e,t){let r=new Set,i=t,o=!0;return A.doWhile(()=>o===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(s=>{if(s!==null&&!r.has(s))return k("IndexBackfiller",`Processing collection: ${s}`),this.ne(e,s,i).next(a=>{i-=a,r.add(s)});o=!1})).next(()=>t-i)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(o=>{let s=o.changes;return this.localStore.indexManager.updateIndexEntries(e,s).next(()=>this.re(i,o)).next(a=>(k("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>s.size)}))}re(e,t){let r=e;return t.changes.forEach((i,o)=>{let s=Xb(o);hy(s,r)>0&&(r=s)}),new At(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}};var _t=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function ya(n){return n==null}function Ws(n){return n===0&&1/n==-1/0}function nC(n){return typeof n=="number"&&Number.isInteger(n)&&!Ws(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function ot(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=QT(e)),e=vL(n.get(t),e);return QT(e)}function vL(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let o=n.charAt(i);switch(o){case"\0":t+="";break;case"":t+="";break;default:t+=o}}return t}function QT(n){return n+""}function Qt(n){let e=n.length;if(q(e>=2),e===2)return q(n.charAt(0)===""&&n.charAt(1)===""),ce.emptyPath();let t=e-2,r=[],i="";for(let o=0;o<e;){let s=n.indexOf("",o);switch((s<0||s>t)&&$(),n.charAt(s+1)){case"":let a=n.substring(o,s),u;i.length===0?u=a:(i+=a,u=i,i=""),r.push(u);break;case"":i+=n.substring(o,s),i+="\0";break;case"":i+=n.substring(o,s+1);break;default:$()}o=s+2}return new ce(r)}var YT=["userId","batchId"];function Zu(n,e){return[n,ot(e)]}function rC(n,e,t){return[n,ot(e),t]}var _L={},IL=["prefixPath","collectionGroup","readTime","documentId"],wL=["prefixPath","collectionGroup","documentId"],EL=["collectionGroup","readTime","prefixPath","documentId"],TL=["canonicalId","targetId"],bL=["targetId","path"],CL=["path","targetId"],DL=["collectionId","parent"],SL=["indexId","uid"],AL=["uid","sequenceNumber"],NL=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],xL=["indexId","uid","orderedDocumentKey"],RL=["userId","collectionPath","documentId"],PL=["userId","collectionPath","largestBatchId"],ML=["userId","collectionGroup","largestBatchId"],iC=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],kL=[...iC,"documentOverlays"],oC=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],sC=oC,py=[...sC,"indexConfiguration","indexState","indexEntries"],OL=py,LL=[...py,"globals"];var Ks=class extends ul{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}};function ze(n,e){let t=V(n);return tr.F(t._e,e)}function JT(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function mr(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function aC(n,e){let t=[];for(let r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.push(e(n[r],r,n));return t}function cC(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Ee=class n{constructor(e,t){this.comparator=e,this.root=t||Jt.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Jt.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Jt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new oo(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new oo(this.root,e,this.comparator,!1)}getReverseIterator(){return new oo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new oo(this.root,e,this.comparator,!0)}},oo=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Jt=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw $();let e=this.left.check();if(e!==this.right.check())throw $();return e+(this.isRed()?0:1)}};Jt.EMPTY=null,Jt.RED=!0,Jt.BLACK=!1;Jt.EMPTY=new class{constructor(){this.size=0}get key(){throw $()}get value(){throw $()}get color(){throw $()}get left(){throw $()}get right(){throw $()}copy(e,t,r,i,o){return this}insert(e,t,r){return new Jt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Ie=class n{constructor(e){this.comparator=e,this.data=new Ee(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new dl(this.data.getIterator())}getIteratorFrom(e){return new dl(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},dl=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function Ji(n){return n.hasNext()?n.getNext():void 0}var It=class n{constructor(e){this.fields=e,e.sort(je.comparator)}static empty(){return new n([])}unionWith(e){let t=new Ie(je.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return uo(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var hl=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function t4(){return typeof atob<"u"}var ke=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new hl("Invalid base64 string: "+o):o}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return K(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};ke.EMPTY_BYTE_STRING=new ke("");var VL=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function vn(n){if(q(!!n),typeof n=="string"){let e=0,t=VL.exec(n);if(q(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Se(n.seconds),nanos:Se(n.nanos)}}function Se(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function _n(n){return typeof n=="string"?ke.fromBase64String(n):ke.fromUint8Array(n)}function id(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function od(n){let e=n.mapValue.fields.__previous_value__;return id(e)?od(e):e}function Qs(n){let e=vn(n.mapValue.fields.__local_write_time__.timestampValue);return new Re(e.seconds,e.nanos)}var gm=class{constructor(e,t,r,i,o,s,a,u,l){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=l}},ho=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Zn={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Xu={nullValue:"NULL_VALUE"};function nr(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?id(n)?4:uC(n)?9007199254740991:10:$()}function en(n,e){if(n===e)return!0;let t=nr(n);if(t!==nr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Qs(n).isEqual(Qs(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let s=vn(i.timestampValue),a=vn(o.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,o){return _n(i.bytesValue).isEqual(_n(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,o){return Se(i.geoPointValue.latitude)===Se(o.geoPointValue.latitude)&&Se(i.geoPointValue.longitude)===Se(o.geoPointValue.longitude)}(n,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return Se(i.integerValue)===Se(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let s=Se(i.doubleValue),a=Se(o.doubleValue);return s===a?Ws(s)===Ws(a):isNaN(s)&&isNaN(a)}return!1}(n,e);case 9:return uo(n.arrayValue.values||[],e.arrayValue.values||[],en);case 10:return function(i,o){let s=i.mapValue.fields||{},a=o.mapValue.fields||{};if(JT(s)!==JT(a))return!1;for(let u in s)if(s.hasOwnProperty(u)&&(a[u]===void 0||!en(s[u],a[u])))return!1;return!0}(n,e);default:return $()}}function Ys(n,e){return(n.values||[]).find(t=>en(t,e))!==void 0}function rr(n,e){if(n===e)return 0;let t=nr(n),r=nr(e);if(t!==r)return K(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return K(n.booleanValue,e.booleanValue);case 2:return function(o,s){let a=Se(o.integerValue||o.doubleValue),u=Se(s.integerValue||s.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(n,e);case 3:return ZT(n.timestampValue,e.timestampValue);case 4:return ZT(Qs(n),Qs(e));case 5:return K(n.stringValue,e.stringValue);case 6:return function(o,s){let a=_n(o),u=_n(s);return a.compareTo(u)}(n.bytesValue,e.bytesValue);case 7:return function(o,s){let a=o.split("/"),u=s.split("/");for(let l=0;l<a.length&&l<u.length;l++){let h=K(a[l],u[l]);if(h!==0)return h}return K(a.length,u.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,s){let a=K(Se(o.latitude),Se(s.latitude));return a!==0?a:K(Se(o.longitude),Se(s.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(o,s){let a=o.values||[],u=s.values||[];for(let l=0;l<a.length&&l<u.length;++l){let h=rr(a[l],u[l]);if(h)return h}return K(a.length,u.length)}(n.arrayValue,e.arrayValue);case 10:return function(o,s){if(o===Zn.mapValue&&s===Zn.mapValue)return 0;if(o===Zn.mapValue)return 1;if(s===Zn.mapValue)return-1;let a=o.fields||{},u=Object.keys(a),l=s.fields||{},h=Object.keys(l);u.sort(),h.sort();for(let p=0;p<u.length&&p<h.length;++p){let g=K(u[p],h[p]);if(g!==0)return g;let y=rr(a[u[p]],l[h[p]]);if(y!==0)return y}return K(u.length,h.length)}(n.mapValue,e.mapValue);default:throw $()}}function ZT(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return K(n,e);let t=vn(n),r=vn(e),i=K(t.seconds,r.seconds);return i!==0?i:K(t.nanos,r.nanos)}function fo(n){return ym(n)}function ym(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=vn(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return _n(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return j.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let o of t.values||[])i?i=!1:r+=",",r+=ym(o);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let s of r)o?o=!1:i+=",",i+=`${s}:${ym(t.fields[s])}`;return i+"}"}(n.mapValue):$()}function el(n){switch(nr(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=od(n);return e?16+el(e):16;case 5:return 2*n.stringValue.length;case 6:return _n(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,o)=>i+el(o),0)}(n.arrayValue);case 10:return function(r){let i=0;return mr(r.fields,(o,s)=>{i+=o.length+el(s)}),i}(n.mapValue);default:throw $()}}function si(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function vm(n){return!!n&&"integerValue"in n}function Js(n){return!!n&&"arrayValue"in n}function XT(n){return!!n&&"nullValue"in n}function eb(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function tl(n){return!!n&&"mapValue"in n}function $s(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return mr(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=$s(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=$s(n.arrayValue.values[t]);return e}return Object.assign({},n)}function uC(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function FL(n){return"nullValue"in n?Xu:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?si(ho.empty(),j.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:$()}function jL(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?si(ho.empty(),j.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?Zn:$()}function tb(n,e){let t=rr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function nb(n,e){let t=rr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var it=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!tl(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=$s(t)}setAll(e){let t=je.emptyPath(),r={},i=[];e.forEach((s,a)=>{if(!t.isImmediateParentOf(a)){let u=this.getFieldsMap(t);this.applyChanges(u,r,i),r={},i=[],t=a.popLast()}s?r[a.lastSegment()]=$s(s):i.push(a.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){let t=this.field(e.popLast());tl(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return en(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];tl(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){mr(t,(i,o)=>e[i]=o);for(let i of r)delete e[i]}clone(){return new n($s(this.value))}};function lC(n){let e=[];return mr(n.fields,(t,r)=>{let i=new je([t]);if(tl(r)){let o=lC(r.mapValue).fields;if(o.length===0)e.push(i);else for(let s of o)e.push(i.child(s))}else e.push(i)}),new It(e)}var Ue=class n{constructor(e,t,r,i,o,s,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(e){return new n(e,0,z.min(),z.min(),z.min(),it.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,z.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,z.min(),z.min(),it.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,z.min(),z.min(),it.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(z.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=it.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=it.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=z.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var tn=class{constructor(e,t){this.position=e,this.inclusive=t}};function rb(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let o=e[i],s=n.position[i];if(o.field.isKeyField()?r=j.comparator(j.fromName(s.referenceValue),t.key):r=rr(s,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function ib(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!en(n.position[t],e.position[t]))return!1;return!0}var ai=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function UL(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var fl=class{},se=class n extends fl{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new wm(e,t,r):t==="array-contains"?new bm(e,r):t==="in"?new pl(e,r):t==="not-in"?new Cm(e,r):t==="array-contains-any"?new Dm(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Em(e,r):new Tm(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(rr(t,this.value)):t!==null&&nr(this.value)===nr(t)&&this.matchesComparison(rr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return $()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},ge=class n extends fl{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return po(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function po(n){return n.op==="and"}function _m(n){return n.op==="or"}function my(n){return dC(n)&&po(n)}function dC(n){for(let e of n.filters)if(e instanceof ge)return!1;return!0}function Im(n){if(n instanceof se)return n.field.canonicalString()+n.op.toString()+fo(n.value);if(my(n))return n.filters.map(e=>Im(e)).join(",");{let e=n.filters.map(t=>Im(t)).join(",");return`${n.op}(${e})`}}function hC(n,e){return n instanceof se?function(r,i){return i instanceof se&&r.op===i.op&&r.field.isEqual(i.field)&&en(r.value,i.value)}(n,e):n instanceof ge?function(r,i){return i instanceof ge&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,s,a)=>o&&hC(s,i.filters[a]),!0):!1}(n,e):void $()}function fC(n,e){let t=n.filters.concat(e);return ge.create(t,n.op)}function pC(n){return n instanceof se?function(t){return`${t.field.canonicalString()} ${t.op} ${fo(t.value)}`}(n):n instanceof ge?function(t){return t.op.toString()+" {"+t.getFilters().map(pC).join(" ,")+"}"}(n):"Filter"}var wm=class extends se{constructor(e,t,r){super(e,t,r),this.key=j.fromName(r.referenceValue)}matches(e){let t=j.comparator(e.key,this.key);return this.matchesComparison(t)}},Em=class extends se{constructor(e,t){super(e,"in",t),this.keys=mC("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},Tm=class extends se{constructor(e,t){super(e,"not-in",t),this.keys=mC("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function mC(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>j.fromName(r.referenceValue))}var bm=class extends se{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Js(t)&&Ys(t.arrayValue,this.value)}},pl=class extends se{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Ys(this.value.arrayValue,t)}},Cm=class extends se{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ys(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Ys(this.value.arrayValue,t)}},Dm=class extends se{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Js(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Ys(this.value.arrayValue,r))}};var Sm=class{constructor(e,t=null,r=[],i=[],o=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=s,this.endAt=a,this.ue=null}};function Am(n,e=null,t=[],r=[],i=null,o=null,s=null){return new Sm(n,e,t,r,i,o,s)}function ci(n){let e=V(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Im(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),ya(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>fo(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>fo(r)).join(",")),e.ue=t}return e.ue}function va(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!UL(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!hC(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!ib(n.startAt,e.startAt)&&ib(n.endAt,e.endAt)}function ml(n){return j.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function gl(n,e){return n.filters.filter(t=>t instanceof se&&t.field.isEqual(e))}function ob(n,e,t){let r=Xu,i=!0;for(let o of gl(n,e)){let s=Xu,a=!0;switch(o.op){case"<":case"<=":s=FL(o.value);break;case"==":case"in":case">=":s=o.value;break;case">":s=o.value,a=!1;break;case"!=":case"not-in":s=Xu}tb({value:r,inclusive:i},{value:s,inclusive:a})<0&&(r=s,i=a)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){let s=t.position[o];tb({value:r,inclusive:i},{value:s,inclusive:t.inclusive})<0&&(r=s,i=t.inclusive);break}}return{value:r,inclusive:i}}function sb(n,e,t){let r=Zn,i=!0;for(let o of gl(n,e)){let s=Zn,a=!0;switch(o.op){case">=":case">":s=jL(o.value),a=!1;break;case"==":case"in":case"<=":s=o.value;break;case"<":s=o.value,a=!1;break;case"!=":case"not-in":s=Zn}nb({value:r,inclusive:i},{value:s,inclusive:a})>0&&(r=s,i=a)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){let s=t.position[o];nb({value:r,inclusive:i},{value:s,inclusive:t.inclusive})>0&&(r=s,i=t.inclusive);break}}return{value:r,inclusive:i}}var Lt=class{constructor(e,t=null,r=[],i=[],o=null,s="F",a=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function gC(n,e,t,r,i,o,s,a){return new Lt(n,e,t,r,i,o,s,a)}function xo(n){return new Lt(n)}function ab(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function gy(n){return n.collectionGroup!==null}function so(n){let e=V(n);if(e.ce===null){e.ce=[];let t=new Set;for(let o of e.explicitOrderBy)e.ce.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let a=new Ie(je.comparator);return s.filters.forEach(u=>{u.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.ce.push(new ai(o,r))}),t.has(je.keyField().canonicalString())||e.ce.push(new ai(je.keyField(),r))}return e.ce}function st(n){let e=V(n);return e.le||(e.le=vC(e,so(n))),e.le}function yC(n){let e=V(n);return e.he||(e.he=vC(e,n.explicitOrderBy)),e.he}function vC(n,e){if(n.limitType==="F")return Am(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new ai(i.field,o)});let t=n.endAt?new tn(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new tn(n.startAt.position,n.startAt.inclusive):null;return Am(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Nm(n,e){let t=n.filters.concat([e]);return new Lt(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function yl(n,e,t){return new Lt(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function _a(n,e){return va(st(n),st(e))&&n.limitType===e.limitType}function _C(n){return`${ci(st(n))}|lt:${n.limitType}`}function no(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>pC(i)).join(", ")}]`),ya(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>fo(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>fo(i)).join(",")),`Target(${r})`}(st(n))}; limitType=${n.limitType})`}function Ia(n,e){return e.isFoundDocument()&&function(r,i){let o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):j.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(n,e)&&function(r,i){for(let o of so(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let o of r.filters)if(!o.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(s,a,u){let l=rb(s,a,u);return s.inclusive?l<=0:l<0}(r.startAt,so(r),i)||r.endAt&&!function(s,a,u){let l=rb(s,a,u);return s.inclusive?l>=0:l>0}(r.endAt,so(r),i))}(n,e)}function IC(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function wC(n){return(e,t)=>{let r=!1;for(let i of so(n)){let o=BL(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function BL(n,e,t){let r=n.field.isKeyField()?j.comparator(e.key,t.key):function(o,s,a){let u=s.data.field(o),l=a.data.field(o);return u!==null&&l!==null?rr(u,l):$()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return $()}}var Vt=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){mr(this.inner,(t,r)=>{for(let[i,o]of r)e(i,o)})}isEmpty(){return cC(this.inner)}size(){return this.innerSize}};var $L=new Ee(j.comparator);function mt(){return $L}var EC=new Ee(j.comparator);function Us(...n){let e=EC;for(let t of n)e=e.insert(t.key,t);return e}function TC(n){let e=EC;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Yt(){return qs()}function bC(){return qs()}function qs(){return new Vt(n=>n.toString(),(n,e)=>n.isEqual(e))}var qL=new Ee(j.comparator),HL=new Ie(j.comparator);function J(...n){let e=HL;for(let t of n)e=e.add(t);return e}var zL=new Ie(K);function yy(){return zL}function CC(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ws(e)?"-0":e}}function DC(n){return{integerValue:""+n}}function SC(n,e){return nC(e)?DC(e):CC(n,e)}var mo=class{constructor(){this._=void 0}};function GL(n,e,t){return n instanceof ir?function(i,o){let s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&id(o)&&(o=od(o)),o&&(s.fields.__previous_value__=o),{mapValue:s}}(t,e):n instanceof In?NC(n,e):n instanceof wn?xC(n,e):function(i,o){let s=AC(i,o),a=cb(s)+cb(i.Pe);return vm(s)&&vm(i.Pe)?DC(a):CC(i.serializer,a)}(n,e)}function WL(n,e,t){return n instanceof In?NC(n,e):n instanceof wn?xC(n,e):t}function AC(n,e){return n instanceof or?function(r){return vm(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}var ir=class extends mo{},In=class extends mo{constructor(e){super(),this.elements=e}};function NC(n,e){let t=RC(e);for(let r of n.elements)t.some(i=>en(i,r))||t.push(r);return{arrayValue:{values:t}}}var wn=class extends mo{constructor(e){super(),this.elements=e}};function xC(n,e){let t=RC(e);for(let r of n.elements)t=t.filter(i=>!en(i,r));return{arrayValue:{values:t}}}var or=class extends mo{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function cb(n){return Se(n.integerValue||n.doubleValue)}function RC(n){return Js(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var ui=class{constructor(e,t){this.field=e,this.transform=t}};function KL(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof In&&i instanceof In||r instanceof wn&&i instanceof wn?uo(r.elements,i.elements,en):r instanceof or&&i instanceof or?en(r.Pe,i.Pe):r instanceof ir&&i instanceof ir}(n.transform,e.transform)}var xm=class{constructor(e,t){this.version=e,this.transformResults=t}},Ae=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function nl(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var go=class{};function PC(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new ar(n.key,Ae.none()):new sr(n.key,n.data,Ae.none());{let t=n.data,r=it.empty(),i=new Ie(je.comparator);for(let o of e.fields)if(!i.has(o)){let s=t.field(o);s===null&&o.length>1&&(o=o.popLast(),s=t.field(o)),s===null?r.delete(o):r.set(o,s),i=i.add(o)}return new Ft(n.key,r,new It(i.toArray()),Ae.none())}}function QL(n,e,t){n instanceof sr?function(i,o,s){let a=i.value.clone(),u=lb(i.fieldTransforms,o,s.transformResults);a.setAll(u),o.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Ft?function(i,o,s){if(!nl(i.precondition,o))return void o.convertToUnknownDocument(s.version);let a=lb(i.fieldTransforms,o,s.transformResults),u=o.data;u.setAll(MC(i)),u.setAll(a),o.convertToFoundDocument(s.version,u).setHasCommittedMutations()}(n,e,t):function(i,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,t)}function Hs(n,e,t,r){return n instanceof sr?function(o,s,a,u){if(!nl(o.precondition,s))return a;let l=o.value.clone(),h=db(o.fieldTransforms,u,s);return l.setAll(h),s.convertToFoundDocument(s.version,l).setHasLocalMutations(),null}(n,e,t,r):n instanceof Ft?function(o,s,a,u){if(!nl(o.precondition,s))return a;let l=db(o.fieldTransforms,u,s),h=s.data;return h.setAll(MC(o)),h.setAll(l),s.convertToFoundDocument(s.version,h).setHasLocalMutations(),a===null?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(p=>p.field))}(n,e,t,r):function(o,s,a){return nl(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a}(n,e,t)}function YL(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),o=AC(r.transform,i||null);o!=null&&(t===null&&(t=it.empty()),t.set(r.field,o))}return t||null}function ub(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&uo(r,i,(o,s)=>KL(o,s))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var sr=class extends go{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Ft=class extends go{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function MC(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function lb(n,e,t){let r=new Map;q(n.length===t.length);for(let i=0;i<t.length;i++){let o=n[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,WL(s,a,t[i]))}return r}function db(n,e,t){let r=new Map;for(let i of n){let o=i.transform,s=t.data.field(i.field);r.set(i.field,GL(o,s,e))}return r}var ar=class extends go{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Zs=class extends go{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Xs=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&QL(o,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Hs(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Hs(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=bC();return this.mutations.forEach(i=>{let o=e.get(i.key),s=o.overlayedDocument,a=this.applyToLocalView(s,o.mutatedFields);a=t.has(i.key)?null:a;let u=PC(s,a);u!==null&&r.set(i.key,u),s.isValidDocument()||s.convertToNoDocument(z.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),J())}isEqual(e){return this.batchId===e.batchId&&uo(this.mutations,e.mutations,(t,r)=>ub(t,r))&&uo(this.baseMutations,e.baseMutations,(t,r)=>ub(t,r))}},Rm=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){q(e.mutations.length===r.length);let i=function(){return qL}(),o=e.mutations;for(let s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new n(e,t,r,i)}};var ea=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var vl=class{constructor(e,t,r){this.alias=e,this.aggregateType=t,this.fieldPath=r}};var Pm=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var Le,ae;function kC(n){switch(n){default:return $();case N.CANCELLED:case N.UNKNOWN:case N.DEADLINE_EXCEEDED:case N.RESOURCE_EXHAUSTED:case N.INTERNAL:case N.UNAVAILABLE:case N.UNAUTHENTICATED:return!1;case N.INVALID_ARGUMENT:case N.NOT_FOUND:case N.ALREADY_EXISTS:case N.PERMISSION_DENIED:case N.FAILED_PRECONDITION:case N.ABORTED:case N.OUT_OF_RANGE:case N.UNIMPLEMENTED:case N.DATA_LOSS:return!0}}function OC(n){if(n===void 0)return Ne("GRPC error has no .code"),N.UNKNOWN;switch(n){case Le.OK:return N.OK;case Le.CANCELLED:return N.CANCELLED;case Le.UNKNOWN:return N.UNKNOWN;case Le.DEADLINE_EXCEEDED:return N.DEADLINE_EXCEEDED;case Le.RESOURCE_EXHAUSTED:return N.RESOURCE_EXHAUSTED;case Le.INTERNAL:return N.INTERNAL;case Le.UNAVAILABLE:return N.UNAVAILABLE;case Le.UNAUTHENTICATED:return N.UNAUTHENTICATED;case Le.INVALID_ARGUMENT:return N.INVALID_ARGUMENT;case Le.NOT_FOUND:return N.NOT_FOUND;case Le.ALREADY_EXISTS:return N.ALREADY_EXISTS;case Le.PERMISSION_DENIED:return N.PERMISSION_DENIED;case Le.FAILED_PRECONDITION:return N.FAILED_PRECONDITION;case Le.ABORTED:return N.ABORTED;case Le.OUT_OF_RANGE:return N.OUT_OF_RANGE;case Le.UNIMPLEMENTED:return N.UNIMPLEMENTED;case Le.DATA_LOSS:return N.DATA_LOSS;default:return $()}}(ae=Le||(Le={}))[ae.OK=0]="OK",ae[ae.CANCELLED=1]="CANCELLED",ae[ae.UNKNOWN=2]="UNKNOWN",ae[ae.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ae[ae.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ae[ae.NOT_FOUND=5]="NOT_FOUND",ae[ae.ALREADY_EXISTS=6]="ALREADY_EXISTS",ae[ae.PERMISSION_DENIED=7]="PERMISSION_DENIED",ae[ae.UNAUTHENTICATED=16]="UNAUTHENTICATED",ae[ae.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ae[ae.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ae[ae.ABORTED=10]="ABORTED",ae[ae.OUT_OF_RANGE=11]="OUT_OF_RANGE",ae[ae.UNIMPLEMENTED=12]="UNIMPLEMENTED",ae[ae.INTERNAL=13]="INTERNAL",ae[ae.UNAVAILABLE=14]="UNAVAILABLE",ae[ae.DATA_LOSS=15]="DATA_LOSS";var _l=null;function LC(){return new TextEncoder}var JL=new Gn([4294967295,4294967295],0);function hb(n){let e=LC().encode(n),t=new Kp;return t.update(e),new Uint8Array(t.digest())}function fb(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Gn([t,r],0),new Gn([i,o],0)]}var Mm=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new ii(`Invalid padding: ${t}`);if(r<0)throw new ii(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ii(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new ii(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Gn.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(Gn.fromNumber(r)));return i.compare(JL)===1&&(i=new Gn([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=hb(e),[r,i]=fb(t);for(let o=0;o<this.hashCount;o++){let s=this.Ee(r,i,o);if(!this.de(s))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new n(o,i,t);return r.forEach(a=>s.insert(a)),s}insert(e){if(this.Ie===0)return;let t=hb(e),[r,i]=fb(t);for(let o=0;o<this.hashCount;o++){let s=this.Ee(r,i,o);this.Ae(s)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},ii=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var ta=class n{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,na.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(z.min(),i,new Ee(K),mt(),J())}},na=class n{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,J(),J(),J())}};var ao=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},Il=class{constructor(e,t){this.targetId=e,this.me=t}},wl=class{constructor(e,t,r=ke.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},El=class{constructor(){this.fe=0,this.ge=mb(),this.pe=ke.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=J(),t=J(),r=J();return this.ge.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:$()}}),new na(this.pe,this.ye,e,t,r)}ve(){this.we=!1,this.ge=mb()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,q(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},km=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=mt(),this.qe=pb(),this.Qe=new Ee(K)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.ve(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:$()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let o=i.target;if(ml(o))if(r===0){let s=new j(o.path);this.Ue(t,s,Ue.newNoDocument(s,z.min()))}else q(r===1);else{let s=this.Ye(t);if(s!==r){let a=this.Ze(e),u=a?this.Xe(a,e,s):1;if(u!==0){this.je(t);let l=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,l)}_l?.et(function(h,p,g,y,D){var R,P,O,B,U,G;let te={localCacheCount:h,existenceFilterCount:p.count,databaseId:g.database,projectId:g.projectId},H=p.unchangedNames;return H&&(te.bloomFilter={applied:D===0,hashCount:(R=H?.hashCount)!==null&&R!==void 0?R:0,bitmapLength:(B=(O=(P=H?.bits)===null||P===void 0?void 0:P.bitmap)===null||O===void 0?void 0:O.length)!==null&&B!==void 0?B:0,padding:(G=(U=H?.bits)===null||U===void 0?void 0:U.padding)!==null&&G!==void 0?G:0,mightContain:E=>{var v;return(v=y?.mightContain(E))!==null&&v!==void 0&&v}}),te}(s,e.me,this.Le.tt(),a,u))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t,s,a;try{s=_n(r).toUint8Array()}catch(u){if(u instanceof hl)return wt("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new Mm(s,i,o)}catch(u){return wt(u instanceof ii?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(o=>{let s=this.Le.tt(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,o,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((o,s)=>{let a=this.Je(s);if(a){if(o.current&&ml(a.target)){let u=new j(a.target.path);this.ke.get(u)!==null||this.it(s,u)||this.Ue(s,u,Ue.newNoDocument(u,e))}o.be&&(t.set(s,o.Ce()),o.ve())}});let r=J();this.qe.forEach((o,s)=>{let a=!0;s.forEachWhile(u=>{let l=this.Je(u);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(o))}),this.ke.forEach((o,s)=>s.setReadTime(e));let i=new ta(e,t,this.Qe,this.ke,r);return this.ke=mt(),this.qe=pb(),this.Qe=new Ee(K),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new El,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Ie(K),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||k("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new El),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function pb(){return new Ee(j.comparator)}function mb(){return new Ee(j.comparator)}var ZL={asc:"ASCENDING",desc:"DESCENDING"},XL={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},eV={and:"AND",or:"OR"},Om=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Lm(n,e){return n.useProto3Json||ya(e)?e:{value:e}}function yo(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function VC(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function tV(n,e){return yo(n,e.toTimestamp())}function Pe(n){return q(!!n),z.fromTimestamp(function(t){let r=vn(t);return new Re(r.seconds,r.nanos)}(n))}function vy(n,e){return Vm(n,e).canonicalString()}function Vm(n,e){let t=function(i){return new ce(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function FC(n){let e=ce.fromString(n);return q(KC(e)),e}function ra(n,e){return vy(n.databaseId,e.path)}function Zt(n,e){let t=FC(e);if(t.get(1)!==n.databaseId.projectId)throw new M(N.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new M(N.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new j(BC(t))}function jC(n,e){return vy(n.databaseId,e)}function UC(n){let e=FC(n);return e.length===4?ce.emptyPath():BC(e)}function Fm(n){return new ce(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function BC(n){return q(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function gb(n,e,t){return{name:ra(n,e),fields:t.value.mapValue.fields}}function $C(n,e,t){let r=Zt(n,e.name),i=Pe(e.updateTime),o=e.createTime?Pe(e.createTime):z.min(),s=new it({mapValue:{fields:e.fields}}),a=Ue.newFoundDocument(r,i,o,s);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function nV(n,e){return"found"in e?function(r,i){q(!!i.found),i.found.name,i.found.updateTime;let o=Zt(r,i.found.name),s=Pe(i.found.updateTime),a=i.found.createTime?Pe(i.found.createTime):z.min(),u=new it({mapValue:{fields:i.found.fields}});return Ue.newFoundDocument(o,s,a,u)}(n,e):"missing"in e?function(r,i){q(!!i.missing),q(!!i.readTime);let o=Zt(r,i.missing),s=Pe(i.readTime);return Ue.newNoDocument(o,s)}(n,e):$()}function rV(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:$()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(l,h){return l.useProto3Json?(q(h===void 0||typeof h=="string"),ke.fromBase64String(h||"")):(q(h===void 0||h instanceof Buffer||h instanceof Uint8Array),ke.fromUint8Array(h||new Uint8Array))}(n,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&function(l){let h=l.code===void 0?N.UNKNOWN:OC(l.code);return new M(h,l.message||"")}(s);t=new wl(r,i,o,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Zt(n,r.document.name),o=Pe(r.document.updateTime),s=r.document.createTime?Pe(r.document.createTime):z.min(),a=new it({mapValue:{fields:r.document.fields}}),u=Ue.newFoundDocument(i,o,s,a),l=r.targetIds||[],h=r.removedTargetIds||[];t=new ao(l,h,u.key,u)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Zt(n,r.document),o=r.readTime?Pe(r.readTime):z.min(),s=Ue.newNoDocument(i,o),a=r.removedTargetIds||[];t=new ao([],a,s.key,s)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Zt(n,r.document),o=r.removedTargetIds||[];t=new ao([],o,i,null)}else{if(!("filter"in e))return $();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:o}=r,s=new Pm(i,o),a=r.targetId;t=new Il(a,s)}}return t}function ia(n,e){let t;if(e instanceof sr)t={update:gb(n,e.key,e.value)};else if(e instanceof ar)t={delete:ra(n,e.key)};else if(e instanceof Ft)t={update:gb(n,e.key,e.data),updateMask:uV(e.fieldMask)};else{if(!(e instanceof Zs))return $();t={verify:ra(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(o,s){let a=s.transform;if(a instanceof ir)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof In)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof wn)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof or)return{fieldPath:s.field.canonicalString(),increment:a.Pe};throw $()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:tV(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:$()}(n,e.precondition)),t}function jm(n,e){let t=e.currentDocument?function(o){return o.updateTime!==void 0?Ae.updateTime(Pe(o.updateTime)):o.exists!==void 0?Ae.exists(o.exists):Ae.none()}(e.currentDocument):Ae.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(s,a){let u=null;if("setToServerValue"in a)q(a.setToServerValue==="REQUEST_TIME"),u=new ir;else if("appendMissingElements"in a){let h=a.appendMissingElements.values||[];u=new In(h)}else if("removeAllFromArray"in a){let h=a.removeAllFromArray.values||[];u=new wn(h)}else"increment"in a?u=new or(s,a.increment):$();let l=je.fromServerFormat(a.fieldPath);return new ui(l,u)}(n,i)):[];if(e.update){e.update.name;let i=Zt(n,e.update.name),o=new it({mapValue:{fields:e.update.fields}});if(e.updateMask){let s=function(u){let l=u.fieldPaths||[];return new It(l.map(h=>je.fromServerFormat(h)))}(e.updateMask);return new Ft(i,o,s,t,r)}return new sr(i,o,t,r)}if(e.delete){let i=Zt(n,e.delete);return new ar(i,t)}if(e.verify){let i=Zt(n,e.verify);return new Zs(i,t)}return $()}function iV(n,e){return n&&n.length>0?(q(e!==void 0),n.map(t=>function(i,o){let s=i.updateTime?Pe(i.updateTime):Pe(o);return s.isEqual(z.min())&&(s=Pe(o)),new xm(s,i.transformResults||[])}(t,e))):[]}function qC(n,e){return{documents:[jC(n,e.path)]}}function sd(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=jC(n,i);let o=function(l){if(l.length!==0)return WC(ge.create(l,"and"))}(e.filters);o&&(t.structuredQuery.where=o);let s=function(l){if(l.length!==0)return l.map(h=>function(g){return{field:Qn(g.field),direction:sV(g.dir)}}(h))}(e.orderBy);s&&(t.structuredQuery.orderBy=s);let a=Lm(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{_t:t,parent:i}}function HC(n,e,t,r){let{_t:i,parent:o}=sd(n,e),s={},a=[],u=0;return t.forEach(l=>{let h=r?l.alias:"aggregate_"+u++;s[h]=l.alias,l.aggregateType==="count"?a.push({alias:h,count:{}}):l.aggregateType==="avg"?a.push({alias:h,avg:{field:Qn(l.fieldPath)}}):l.aggregateType==="sum"&&a.push({alias:h,sum:{field:Qn(l.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:a,structuredQuery:i.structuredQuery},parent:i.parent},ut:s,parent:o}}function zC(n){let e=UC(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){q(r===1);let h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let o=[];t.where&&(o=function(p){let g=GC(p);return g instanceof ge&&my(g)?g.getFilters():[g]}(t.where));let s=[];t.orderBy&&(s=function(p){return p.map(g=>function(D){return new ai(ro(D.field),function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(D.direction))}(g))}(t.orderBy));let a=null;t.limit&&(a=function(p){let g;return g=typeof p=="object"?p.value:p,ya(g)?null:g}(t.limit));let u=null;t.startAt&&(u=function(p){let g=!!p.before,y=p.values||[];return new tn(y,g)}(t.startAt));let l=null;return t.endAt&&(l=function(p){let g=!p.before,y=p.values||[];return new tn(y,g)}(t.endAt)),gC(e,i,s,o,a,"F",u,l)}function oV(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return $()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function GC(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=ro(t.unaryFilter.field);return se.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=ro(t.unaryFilter.field);return se.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=ro(t.unaryFilter.field);return se.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let s=ro(t.unaryFilter.field);return se.create(s,"!=",{nullValue:"NULL_VALUE"});default:return $()}}(n):n.fieldFilter!==void 0?function(t){return se.create(ro(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return $()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return ge.create(t.compositeFilter.filters.map(r=>GC(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return $()}}(t.compositeFilter.op))}(n):$()}function sV(n){return ZL[n]}function aV(n){return XL[n]}function cV(n){return eV[n]}function Qn(n){return{fieldPath:n.canonicalString()}}function ro(n){return je.fromServerFormat(n.fieldPath)}function WC(n){return n instanceof se?function(t){if(t.op==="=="){if(eb(t.value))return{unaryFilter:{field:Qn(t.field),op:"IS_NAN"}};if(XT(t.value))return{unaryFilter:{field:Qn(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(eb(t.value))return{unaryFilter:{field:Qn(t.field),op:"IS_NOT_NAN"}};if(XT(t.value))return{unaryFilter:{field:Qn(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Qn(t.field),op:aV(t.op),value:t.value}}}(n):n instanceof ge?function(t){let r=t.getFilters().map(i=>WC(i));return r.length===1?r[0]:{compositeFilter:{op:cV(t.op),filters:r}}}(n):$()}function uV(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function KC(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var vo=class n{constructor(e,t,r,i,o=z.min(),s=z.min(),a=ke.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Tl=class{constructor(e){this.ct=e}};function lV(n,e){let t;if(e.document)t=$C(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=j.fromSegments(e.noDocument.path),i=di(e.noDocument.readTime);t=Ue.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return $();{let r=j.fromSegments(e.unknownDocument.path),i=di(e.unknownDocument.version);t=Ue.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){let o=new Re(i[0],i[1]);return z.fromTimestamp(o)}(e.readTime)),t}function yb(n,e){let t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:bl(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(o,s){return{name:ra(o,s.key),fields:s.data.value.mapValue.fields,updateTime:yo(o,s.version.toTimestamp()),createTime:yo(o,s.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:li(e.version)};else{if(!e.isUnknownDocument())return $();r.unknownDocument={path:t.path.toArray(),version:li(e.version)}}return r}function bl(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function li(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function di(n){let e=new Re(n.seconds,n.nanoseconds);return z.fromTimestamp(e)}function ti(n,e){let t=(e.baseMutations||[]).map(o=>jm(n.ct,o));for(let o=0;o<e.mutations.length-1;++o){let s=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){let a=e.mutations[o+1];s.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}let r=e.mutations.map(o=>jm(n.ct,o)),i=Re.fromMillis(e.localWriteTimeMs);return new Xs(e.batchId,i,t,r)}function Bs(n){let e=di(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?di(n.lastLimboFreeSnapshotVersion):z.min(),r;return r=function(o){return o.documents!==void 0}(n.query)?function(o){return q(o.documents.length===1),st(xo(UC(o.documents[0])))}(n.query):function(o){return st(zC(o))}(n.query),new vo(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,ke.fromBase64String(n.resumeToken))}function QC(n,e){let t=li(e.snapshotVersion),r=li(e.lastLimboFreeSnapshotVersion),i;i=ml(e.target)?qC(n.ct,e.target):sd(n.ct,e.target)._t;let o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ci(e.target),readTime:t,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function _y(n){let e=zC({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?yl(e,e.limit,"L"):e}function tm(n,e){return new ea(e.largestBatchId,jm(n.ct,e.overlayMutation))}function vb(n,e){let t=e.path.lastSegment();return[n,ot(e.path.popLast()),t]}function _b(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:li(r.readTime),documentKey:ot(r.documentKey.path),largestBatchId:r.largestBatchId}}var Um=class{getBundleMetadata(e,t){return Ib(e).get(t).next(r=>{if(r)return function(o){return{id:o.bundleId,createTime:di(o.createTime),version:o.version}}(r)})}saveBundleMetadata(e,t){return Ib(e).put(function(i){return{bundleId:i.id,createTime:li(Pe(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return wb(e).get(t).next(r=>{if(r)return function(o){return{name:o.name,query:_y(o.bundledQuery),readTime:di(o.readTime)}}(r)})}saveNamedQuery(e,t){return wb(e).put(function(i){return{name:i.name,readTime:li(Pe(i.readTime)),bundledQuery:i.bundledQuery}}(t))}};function Ib(n){return ze(n,"bundles")}function wb(n){return ze(n,"namedQueries")}var Cl=class n{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){let r=t.uid||"";return new n(e,r)}getOverlay(e,t){return Ls(e).get(vb(this.userId,t)).next(r=>r?tm(this.serializer,r):null)}getOverlays(e,t){let r=Yt();return A.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){let i=[];return r.forEach((o,s)=>{let a=new ea(t,s);i.push(this.ht(e,a))}),A.waitFor(i)}removeOverlaysForBatchId(e,t,r){let i=new Set;t.forEach(s=>i.add(ot(s.getCollectionPath())));let o=[];return i.forEach(s=>{let a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,r+1],!1,!0);o.push(Ls(e).j("collectionPathOverlayIndex",a))}),A.waitFor(o)}getOverlaysForCollection(e,t,r){let i=Yt(),o=ot(t),s=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,Number.POSITIVE_INFINITY],!0);return Ls(e).U("collectionPathOverlayIndex",s).next(a=>{for(let u of a){let l=tm(this.serializer,u);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,t,r,i){let o=Yt(),s,a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Ls(e).J({index:"collectionGroupOverlayIndex",range:a},(u,l,h)=>{let p=tm(this.serializer,l);o.size()<i||p.largestBatchId===s?(o.set(p.getKey(),p),s=p.largestBatchId):h.done()}).next(()=>o)}ht(e,t){return Ls(e).put(function(i,o,s){let[a,u,l]=vb(o,s.mutation.key);return{userId:o,collectionPath:u,documentId:l,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:ia(i.ct,s.mutation)}}(this.serializer,this.userId,t))}};function Ls(n){return ze(n,"documentOverlays")}var Bm=class{Pt(e){return ze(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{let r=t?.value;return r?ke.fromUint8Array(r):ke.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}};var mn=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Se(e.integerValue));else if("doubleValue"in e){let r=Se(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),Ws(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=vn(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(_n(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?uC(e)?this.dt(t,Number.MAX_SAFE_INTEGER):(this.wt(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.St(e.arrayValue,t),this.ft(t)):$()}Vt(e,t){this.dt(t,25),this.bt(e,t)}bt(e,t){t.Rt(e)}wt(e,t){let r=e.fields||{};this.dt(t,55);for(let i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}St(e,t){let r=e.values||[];this.dt(t,50);for(let i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),j.fromName(e).path.forEach(r=>{this.dt(t,60),this.bt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};mn.Dt=new mn;function dV(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function Eb(n){let e=64-function(r){let i=0;for(let o=0;o<8;++o){let s=dV(255&r[o]);if(i+=s,s!==8)break}return i}(n);return Math.ceil(e/8)}var $m=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.vt(r.value),r=t.next();this.Ft()}Mt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.xt(r.value),r=t.next();this.Ot()}Nt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.vt(r);else if(r<2048)this.vt(960|r>>>6),this.vt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.vt(480|r>>>12),this.vt(128|63&r>>>6),this.vt(128|63&r);else{let i=t.codePointAt(0);this.vt(240|i>>>18),this.vt(128|63&i>>>12),this.vt(128|63&i>>>6),this.vt(128|63&i)}}this.Ft()}Lt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.xt(r);else if(r<2048)this.xt(960|r>>>6),this.xt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.xt(480|r>>>12),this.xt(128|63&r>>>6),this.xt(128|63&r);else{let i=t.codePointAt(0);this.xt(240|i>>>18),this.xt(128|63&i>>>12),this.xt(128|63&i>>>6),this.xt(128|63&i)}}this.Ot()}Bt(e){let t=this.kt(e),r=Eb(t);this.qt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Qt(e){let t=this.kt(e),r=Eb(t);this.qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}Kt(){this.$t(255),this.$t(255)}Ut(){this.Wt(255),this.Wt(255)}reset(){this.position=0}seed(e){this.qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Gt(){return this.buffer.slice(0,this.position)}kt(e){let t=function(o){let s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,o,!1),new Uint8Array(s.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}vt(e){let t=255&e;t===0?(this.$t(0),this.$t(255)):t===255?(this.$t(255),this.$t(0)):this.$t(t)}xt(e){let t=255&e;t===0?(this.Wt(0),this.Wt(255)):t===255?(this.Wt(255),this.Wt(0)):this.Wt(e)}Ft(){this.$t(0),this.$t(1)}Ot(){this.Wt(0),this.Wt(1)}$t(e){this.qt(1),this.buffer[this.position++]=e}Wt(e){this.qt(1),this.buffer[this.position++]=~e}qt(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},qm=class{constructor(e){this.zt=e}gt(e){this.zt.Ct(e)}Rt(e){this.zt.Nt(e)}At(e){this.zt.Bt(e)}Et(){this.zt.Kt()}},Hm=class{constructor(e){this.zt=e}gt(e){this.zt.Mt(e)}Rt(e){this.zt.Lt(e)}At(e){this.zt.Qt(e)}Et(){this.zt.Ut()}},ni=class{constructor(){this.zt=new $m,this.jt=new qm(this.zt),this.Ht=new Hm(this.zt)}seed(e){this.zt.seed(e)}Jt(e){return e===0?this.jt:this.Ht}Gt(){return this.zt.Gt()}reset(){this.zt.reset()}};var ri=class n{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Yt(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new n(this.indexId,this.documentKey,this.arrayValue,r)}};function Wn(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=Tb(n.arrayValue,e.arrayValue),t!==0?t:(t=Tb(n.directionalValue,e.directionalValue),t!==0?t:j.comparator(n.documentKey,e.documentKey)))}function Tb(n,e){for(let t=0;t<n.length&&t<e.length;++t){let r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}var Dl=class{constructor(e){this.Zt=new Ie((t,r)=>je.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Xt=e.orderBy,this.en=[];for(let t of e.filters){let r=t;r.isInequality()?this.Zt=this.Zt.add(r):this.en.push(r)}}get tn(){return this.Zt.size>1}nn(e){if(q(e.collectionGroup===this.collectionId),this.tn)return!1;let t=dm(e);if(t!==void 0&&!this.rn(t))return!1;let r=Xr(e),i=new Set,o=0,s=0;for(;o<r.length&&this.rn(r[o]);++o)i=i.add(r[o].fieldPath.canonicalString());if(o===r.length)return!0;if(this.Zt.size>0){let a=this.Zt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let u=r[o];if(!this.sn(a,u)||!this.on(this.Xt[s++],u))return!1}++o}for(;o<r.length;++o){let a=r[o];if(s>=this.Xt.length||!this.on(this.Xt[s++],a))return!1}return!0}_n(){if(this.tn)return null;let e=new Ie(je.comparator),t=[];for(let r of this.en)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new yn(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new yn(r.field,0))}for(let r of this.Xt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new yn(r.field,r.dir==="asc"?0:1)));return new er(er.UNKNOWN_ID,this.collectionId,t,lo.empty())}rn(e){for(let t of this.en)if(this.sn(t,e))return!0;return!1}sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}on(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function YC(n){var e,t;if(q(n instanceof se||n instanceof ge),n instanceof se){if(n instanceof pl){let i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(o=>se.create(n.field,"==",o)))||[];return ge.create(i,"or")}return n}let r=n.filters.map(i=>YC(i));return ge.create(r,n.op)}function hV(n){if(n.getFilters().length===0)return[];let e=Wm(YC(n));return q(JC(e)),zm(e)||Gm(e)?[e]:e.getFilters()}function zm(n){return n instanceof se}function Gm(n){return n instanceof ge&&my(n)}function JC(n){return zm(n)||Gm(n)||function(t){if(t instanceof ge&&_m(t)){for(let r of t.getFilters())if(!zm(r)&&!Gm(r))return!1;return!0}return!1}(n)}function Wm(n){if(q(n instanceof se||n instanceof ge),n instanceof se)return n;if(n.filters.length===1)return Wm(n.filters[0]);let e=n.filters.map(r=>Wm(r)),t=ge.create(e,n.op);return t=Sl(t),JC(t)?t:(q(t instanceof ge),q(po(t)),q(t.filters.length>1),t.filters.reduce((r,i)=>Iy(r,i)))}function Iy(n,e){let t;return q(n instanceof se||n instanceof ge),q(e instanceof se||e instanceof ge),t=n instanceof se?e instanceof se?function(i,o){return ge.create([i,o],"and")}(n,e):bb(n,e):e instanceof se?bb(e,n):function(i,o){if(q(i.filters.length>0&&o.filters.length>0),po(i)&&po(o))return fC(i,o.getFilters());let s=_m(i)?i:o,a=_m(i)?o:i,u=s.filters.map(l=>Iy(l,a));return ge.create(u,"or")}(n,e),Sl(t)}function bb(n,e){if(po(e))return fC(e,n.getFilters());{let t=e.filters.map(r=>Iy(n,r));return ge.create(t,"or")}}function Sl(n){if(q(n instanceof se||n instanceof ge),n instanceof se)return n;let e=n.getFilters();if(e.length===1)return Sl(e[0]);if(dC(n))return n;let t=e.map(i=>Sl(i)),r=[];return t.forEach(i=>{i instanceof se?r.push(i):i instanceof ge&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:ge.create(r,n.op)}var Km=class{constructor(){this.an=new oa}addToCollectionParentIndex(e,t){return this.an.add(t),A.resolve()}getCollectionParents(e,t){return A.resolve(this.an.getEntries(t))}addFieldIndex(e,t){return A.resolve()}deleteFieldIndex(e,t){return A.resolve()}deleteAllFieldIndexes(e){return A.resolve()}createTargetIndexes(e,t){return A.resolve()}getDocumentsMatchingTarget(e,t){return A.resolve(null)}getIndexType(e,t){return A.resolve(0)}getFieldIndexes(e,t){return A.resolve([])}getNextCollectionGroupToUpdate(e){return A.resolve(null)}getMinOffset(e,t){return A.resolve(At.min())}getMinOffsetFromCollectionGroup(e,t){return A.resolve(At.min())}updateCollectionGroup(e,t,r){return A.resolve()}updateIndexEntries(e,t){return A.resolve()}},oa=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Ie(ce.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ie(ce.comparator)).toArray()}};var Wu=new Uint8Array(0),Qm=class{constructor(e,t){this.databaseId=t,this.un=new oa,this.cn=new Vt(r=>ci(r),(r,i)=>va(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.un.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.un.add(t)});let o={collectionId:r,parent:ot(i)};return Cb(e).put(o)}return A.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[Jb(t),""],!1,!0);return Cb(e).U(i).next(o=>{for(let s of o){if(s.collectionId!==t)break;r.push(Qt(s.parent))}return r})}addFieldIndex(e,t){let r=Vs(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])}}(t);delete i.indexId;let o=r.add(i);if(t.indexState){let s=Xi(e);return o.next(a=>{s.put(_b(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return o.next()}deleteFieldIndex(e,t){let r=Vs(e),i=Xi(e),o=Zi(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=Vs(e),r=Zi(e),i=Xi(e);return t.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,t){return A.forEach(this.ln(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let o=new Dl(r)._n();if(o!=null)return this.addFieldIndex(e,o)}}))}getDocumentsMatchingTarget(e,t){let r=Zi(e),i=!0,o=new Map;return A.forEach(this.ln(t),s=>this.hn(e,s).next(a=>{i&&(i=!!a),o.set(s,a)})).next(()=>{if(i){let s=J(),a=[];return A.forEach(o,(u,l)=>{k("IndexedDbIndexManager",`Using index ${function(U){return`id=${U.indexId}|cg=${U.collectionGroup}|f=${U.fields.map(G=>`${G.fieldPath}:${G.kind}`).join(",")}`}(u)} to execute ${ci(t)}`);let h=function(U,G){let te=dm(G);if(te===void 0)return null;for(let H of gl(U,te.fieldPath))switch(H.op){case"array-contains-any":return H.value.arrayValue.values||[];case"array-contains":return[H.value]}return null}(l,u),p=function(U,G){let te=new Map;for(let H of Xr(G))for(let E of gl(U,H.fieldPath))switch(E.op){case"==":case"in":te.set(H.fieldPath.canonicalString(),E.value);break;case"not-in":case"!=":return te.set(H.fieldPath.canonicalString(),E.value),Array.from(te.values())}return null}(l,u),g=function(U,G){let te=[],H=!0;for(let E of Xr(G)){let v=E.kind===0?ob(U,E.fieldPath,U.startAt):sb(U,E.fieldPath,U.startAt);te.push(v.value),H&&(H=v.inclusive)}return new tn(te,H)}(l,u),y=function(U,G){let te=[],H=!0;for(let E of Xr(G)){let v=E.kind===0?sb(U,E.fieldPath,U.endAt):ob(U,E.fieldPath,U.endAt);te.push(v.value),H&&(H=v.inclusive)}return new tn(te,H)}(l,u),D=this.Pn(u,l,g),R=this.Pn(u,l,y),P=this.In(u,l,p),O=this.Tn(u.indexId,h,D,g.inclusive,R,y.inclusive,P);return A.forEach(O,B=>r.G(B,t.limit).next(U=>{U.forEach(G=>{let te=j.fromSegments(G.documentKey);s.has(te)||(s=s.add(te),a.push(te))})}))}).next(()=>a)}return A.resolve(null)})}ln(e){let t=this.cn.get(e);return t||(e.filters.length===0?t=[e]:t=hV(ge.create(e.filters,"and")).map(r=>Am(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.cn.set(e,t),t)}Tn(e,t,r,i,o,s,a){let u=(t!=null?t.length:1)*Math.max(r.length,o.length),l=u/(t!=null?t.length:1),h=[];for(let p=0;p<u;++p){let g=t?this.En(t[p/l]):Wu,y=this.dn(e,g,r[p%l],i),D=this.An(e,g,o[p%l],s),R=a.map(P=>this.dn(e,g,P,!0));h.push(...this.createRange(y,D,R))}return h}dn(e,t,r,i){let o=new ri(e,j.empty(),t,r);return i?o:o.Yt()}An(e,t,r,i){let o=new ri(e,j.empty(),t,r);return i?o.Yt():o}hn(e,t){let r=new Dl(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(o=>{let s=null;for(let a of o)r.nn(a)&&(!s||a.fields.length>s.fields.length)&&(s=a);return s})}getIndexType(e,t){let r=2,i=this.ln(t);return A.forEach(i,o=>this.hn(e,o).next(s=>{s?r!==0&&s.fields.length<function(u){let l=new Ie(je.comparator),h=!1;for(let p of u.filters)for(let g of p.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?h=!0:l=l.add(g.field));for(let p of u.orderBy)p.field.isKeyField()||(l=l.add(p.field));return l.size+(h?1:0)}(o)&&(r=1):r=0})).next(()=>function(s){return s.limit!==null}(t)&&i.length>1&&r===2?1:r)}Rn(e,t){let r=new ni;for(let i of Xr(e)){let o=t.data.field(i.fieldPath);if(o==null)return null;let s=r.Jt(i.kind);mn.Dt.It(o,s)}return r.Gt()}En(e){let t=new ni;return mn.Dt.It(e,t.Jt(0)),t.Gt()}Vn(e,t){let r=new ni;return mn.Dt.It(si(this.databaseId,t),r.Jt(function(o){let s=Xr(o);return s.length===0?0:s[s.length-1].kind}(e))),r.Gt()}In(e,t,r){if(r===null)return[];let i=[];i.push(new ni);let o=0;for(let s of Xr(e)){let a=r[o++];for(let u of i)if(this.mn(t,s.fieldPath)&&Js(a))i=this.fn(i,s,a);else{let l=u.Jt(s.kind);mn.Dt.It(a,l)}}return this.gn(i)}Pn(e,t,r){return this.In(e,t,r.position)}gn(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Gt();return t}fn(e,t,r){let i=[...e],o=[];for(let s of r.arrayValue.values||[])for(let a of i){let u=new ni;u.seed(a.Gt()),mn.Dt.It(s,u.Jt(t.kind)),o.push(u)}return o}mn(e,t){return!!e.filters.find(r=>r instanceof se&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){let r=Vs(e),i=Xi(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(o=>{let s=[];return A.forEach(o,a=>i.get([a.indexId,this.uid]).next(u=>{s.push(function(h,p){let g=p?new lo(p.sequenceNumber,new At(di(p.readTime),new j(Qt(p.documentKey)),p.largestBatchId)):lo.empty(),y=h.fields.map(([D,R])=>new yn(je.fromServerFormat(D),R));return new er(h.indexId,h.collectionGroup,y,g)}(a,u))})).next(()=>s)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{let o=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return o!==0?o:K(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){let i=Vs(e),o=Xi(e);return this.pn(e).next(s=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>A.forEach(a,u=>o.put(_b(u.indexId,this.uid,s,r)))))}updateIndexEntries(e,t){let r=new Map;return A.forEach(t,(i,o)=>{let s=r.get(i.collectionGroup);return(s?A.resolve(s):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),A.forEach(a,u=>this.yn(e,i,u).next(l=>{let h=this.wn(o,u);return l.isEqual(h)?A.resolve():this.Sn(e,o,u,l,h)}))))})}bn(e,t,r,i){return Zi(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Vn(r,t.key),documentKey:t.key.path.toArray()})}Dn(e,t,r,i){return Zi(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Vn(r,t.key),t.key.path.toArray()])}yn(e,t,r){let i=Zi(e),o=new Ie(Wn);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.Vn(r,t)])},(s,a)=>{o=o.add(new ri(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>o)}wn(e,t){let r=new Ie(Wn),i=this.Rn(t,e);if(i==null)return r;let o=dm(t);if(o!=null){let s=e.data.field(o.fieldPath);if(Js(s))for(let a of s.arrayValue.values||[])r=r.add(new ri(t.indexId,e.key,this.En(a),i))}else r=r.add(new ri(t.indexId,e.key,Wu,i));return r}Sn(e,t,r,i,o){k("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);let s=[];return function(u,l,h,p,g){let y=u.getIterator(),D=l.getIterator(),R=Ji(y),P=Ji(D);for(;R||P;){let O=!1,B=!1;if(R&&P){let U=h(R,P);U<0?B=!0:U>0&&(O=!0)}else R!=null?B=!0:O=!0;O?(p(P),P=Ji(D)):B?(g(R),R=Ji(y)):(R=Ji(y),P=Ji(D))}}(i,o,Wn,a=>{s.push(this.bn(e,t,r,a))},a=>{s.push(this.Dn(e,t,r,a))}),A.waitFor(s)}pn(e){let t=1;return Xi(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,o)=>{o.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((s,a)=>Wn(s,a)).filter((s,a,u)=>!a||Wn(s,u[a-1])!==0);let i=[];i.push(e);for(let s of r){let a=Wn(s,e),u=Wn(s,t);if(a===0)i[0]=e.Yt();else if(a>0&&u<0)i.push(s),i.push(s.Yt());else if(u>0)break}i.push(t);let o=[];for(let s=0;s<i.length;s+=2){if(this.Cn(i[s],i[s+1]))return[];let a=[i[s].indexId,this.uid,i[s].arrayValue,i[s].directionalValue,Wu,[]],u=[i[s+1].indexId,this.uid,i[s+1].arrayValue,i[s+1].directionalValue,Wu,[]];o.push(IDBKeyRange.bound(a,u))}return o}Cn(e,t){return Wn(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Db)}getMinOffset(e,t){return A.mapArray(this.ln(t),r=>this.hn(e,r).next(i=>i||$())).next(Db)}};function Cb(n){return ze(n,"collectionParents")}function Zi(n){return ze(n,"indexEntries")}function Vs(n){return ze(n,"indexConfiguration")}function Xi(n){return ze(n,"indexState")}function Db(n){q(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){let i=n[r].indexState.offset;hy(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new At(e.readTime,e.documentKey,t)}var Sb={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},pt=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function ZC(n,e,t){let r=n.store("mutations"),i=n.store("documentMutations"),o=[],s=IDBKeyRange.only(t.batchId),a=0,u=r.J({range:s},(h,p,g)=>(a++,g.delete()));o.push(u.next(()=>{q(a===1)}));let l=[];for(let h of t.mutations){let p=rC(e,h.key.path,t.batchId);o.push(i.delete(p)),l.push(h.key)}return A.waitFor(o).next(()=>l)}function Al(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw $();e=n.noDocument}return JSON.stringify(e).length}pt.DEFAULT_COLLECTION_PERCENTILE=10,pt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,pt.DEFAULT=new pt(41943040,pt.DEFAULT_COLLECTION_PERCENTILE,pt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),pt.DISABLED=new pt(-1,0,0);var Nl=class n{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.vn={}}static lt(e,t,r,i){q(e.uid!=="");let o=e.isAuthenticated()?e.uid:"";return new n(o,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Kn(e).J({index:"userMutationsIndex",range:r},(i,o,s)=>{t=!1,s.done()}).next(()=>t)}addMutationBatch(e,t,r,i){let o=io(e),s=Kn(e);return s.add({}).next(a=>{q(typeof a=="number");let u=new Xs(a,t,r,i),l=function(y,D,R){let P=R.baseMutations.map(B=>ia(y.ct,B)),O=R.mutations.map(B=>ia(y.ct,B));return{userId:D,batchId:R.batchId,localWriteTimeMs:R.localWriteTime.toMillis(),baseMutations:P,mutations:O}}(this.serializer,this.userId,u),h=[],p=new Ie((g,y)=>K(g.canonicalString(),y.canonicalString()));for(let g of i){let y=rC(this.userId,g.key.path,a);p=p.add(g.key.path.popLast()),h.push(s.put(l)),h.push(o.put(y,_L))}return p.forEach(g=>{h.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.vn[a]=u.keys()}),A.waitFor(h).next(()=>u)})}lookupMutationBatch(e,t){return Kn(e).get(t).next(r=>r?(q(r.userId===this.userId),ti(this.serializer,r)):null)}Fn(e,t){return this.vn[t]?A.resolve(this.vn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){let i=r.keys();return this.vn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Kn(e).J({index:"userMutationsIndex",range:i},(s,a,u)=>{a.userId===this.userId&&(q(a.batchId>=r),o=ti(this.serializer,a)),u.done()}).next(()=>o)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Kn(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,o,s)=>{r=o.batchId,s.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Kn(e).U("userMutationsIndex",t).next(r=>r.map(i=>ti(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=Zu(this.userId,t.path),i=IDBKeyRange.lowerBound(r),o=[];return io(e).J({range:i},(s,a,u)=>{let[l,h,p]=s,g=Qt(h);if(l===this.userId&&t.path.isEqual(g))return Kn(e).get(p).next(y=>{if(!y)throw $();q(y.userId===this.userId),o.push(ti(this.serializer,y))});u.done()}).next(()=>o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ie(K),i=[];return t.forEach(o=>{let s=Zu(this.userId,o.path),a=IDBKeyRange.lowerBound(s),u=io(e).J({range:a},(l,h,p)=>{let[g,y,D]=l,R=Qt(y);g===this.userId&&o.path.isEqual(R)?r=r.add(D):p.done()});i.push(u)}),A.waitFor(i).next(()=>this.Mn(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=Zu(this.userId,r),s=IDBKeyRange.lowerBound(o),a=new Ie(K);return io(e).J({range:s},(u,l,h)=>{let[p,g,y]=u,D=Qt(g);p===this.userId&&r.isPrefixOf(D)?D.length===i&&(a=a.add(y)):h.done()}).next(()=>this.Mn(e,a))}Mn(e,t){let r=[],i=[];return t.forEach(o=>{i.push(Kn(e).get(o).next(s=>{if(s===null)throw $();q(s.userId===this.userId),r.push(ti(this.serializer,s))}))}),A.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return ZC(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.xn(t.batchId)}),A.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}xn(e){delete this.vn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return A.resolve();let r=IDBKeyRange.lowerBound(function(s){return[s]}(this.userId)),i=[];return io(e).J({range:r},(o,s,a)=>{if(o[0]===this.userId){let u=Qt(o[1]);i.push(u)}else a.done()}).next(()=>{q(i.length===0)})})}containsKey(e,t){return XC(e,this.userId,t)}On(e){return eD(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function XC(n,e,t){let r=Zu(e,t.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return io(n).J({range:o,H:!0},(a,u,l)=>{let[h,p,g]=a;h===e&&p===i&&(s=!0),l.done()}).next(()=>s)}function Kn(n){return ze(n,"mutations")}function io(n){return ze(n,"documentMutations")}function eD(n){return ze(n,"mutationQueues")}var _o=class n{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static Ln(){return new n(0)}static Bn(){return new n(-1)}};var Ym=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.kn(e).next(t=>{let r=new _o(t.highestTargetId);return t.highestTargetId=r.next(),this.qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.kn(e).next(t=>z.fromTimestamp(new Re(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.kn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.kn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.qn(e,i)))}addTargetData(e,t){return this.Qn(e,t).next(()=>this.kn(e).next(r=>(r.targetCount+=1,this.Kn(t,r),this.qn(e,r))))}updateTargetData(e,t){return this.Qn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>eo(e).delete(t.targetId)).next(()=>this.kn(e)).next(r=>(q(r.targetCount>0),r.targetCount-=1,this.qn(e,r)))}removeTargets(e,t,r){let i=0,o=[];return eo(e).J((s,a)=>{let u=Bs(a);u.sequenceNumber<=t&&r.get(u.targetId)===null&&(i++,o.push(this.removeTargetData(e,u)))}).next(()=>A.waitFor(o)).next(()=>i)}forEachTarget(e,t){return eo(e).J((r,i)=>{let o=Bs(i);t(o)})}kn(e){return Ab(e).get("targetGlobalKey").next(t=>(q(t!==null),t))}qn(e,t){return Ab(e).put("targetGlobalKey",t)}Qn(e,t){return eo(e).put(QC(this.serializer,t))}Kn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.kn(e).next(t=>t.targetCount)}getTargetData(e,t){let r=ci(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return eo(e).J({range:i,index:"queryTargetsIndex"},(s,a,u)=>{let l=Bs(a);va(t,l.target)&&(o=l,u.done())}).next(()=>o)}addMatchingKeys(e,t,r){let i=[],o=Yn(e);return t.forEach(s=>{let a=ot(s.path);i.push(o.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,s))}),A.waitFor(i)}removeMatchingKeys(e,t,r){let i=Yn(e);return A.forEach(t,o=>{let s=ot(o.path);return A.waitFor([i.delete([r,s]),this.referenceDelegate.removeReference(e,r,o)])})}removeMatchingKeysForTargetId(e,t){let r=Yn(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Yn(e),o=J();return i.J({range:r,H:!0},(s,a,u)=>{let l=Qt(s[1]),h=new j(l);o=o.add(h)}).next(()=>o)}containsKey(e,t){let r=ot(t.path),i=IDBKeyRange.bound([r],[Jb(r)],!1,!0),o=0;return Yn(e).J({index:"documentTargetsIndex",H:!0,range:i},([s,a],u,l)=>{s!==0&&(o++,l.done())}).next(()=>o>0)}ot(e,t){return eo(e).get(t).next(r=>r?Bs(r):null)}};function eo(n){return ze(n,"targets")}function Ab(n){return ze(n,"targetGlobal")}function Yn(n){return ze(n,"targetDocuments")}function Nb([n,e],[t,r]){let i=K(n,t);return i===0?K(e,r):i}var Jm=class{constructor(e){this.$n=e,this.buffer=new Ie(Nb),this.Un=0}Wn(){return++this.Un}Gn(e){let t=[e,this.Wn()];if(this.buffer.size<this.$n)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();Nb(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},xl=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.zn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.jn(6e4)}stop(){this.zn&&(this.zn.cancel(),this.zn=null)}get started(){return this.zn!==null}jn(e){k("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.zn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>w(this,null,function*(){this.zn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){pr(t)?k("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield fr(t)}yield this.jn(3e5)}))}},Zm=class{constructor(e,t){this.Hn=e,this.params=t}calculateTargetCount(e,t){return this.Hn.Jn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return A.resolve(_t.oe);let r=new Jm(t);return this.Hn.forEachTarget(e,i=>r.Gn(i.sequenceNumber)).next(()=>this.Hn.Yn(e,i=>r.Gn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Hn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Hn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(k("LruGarbageCollector","Garbage collection skipped; disabled"),A.resolve(Sb)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(k("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Sb):this.Zn(e,t))}getCacheSize(e){return this.Hn.getCacheSize(e)}Zn(e,t){let r,i,o,s,a,u,l,h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(k("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,s=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(r=p,a=Date.now(),this.removeTargets(e,r,t))).next(p=>(o=p,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(l=Date.now(),to()<=ie.DEBUG&&k("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-h}ms
	Determined least recently used ${i} in `+(a-s)+`ms
	Removed ${o} targets in `+(u-a)+`ms
	Removed ${p} documents in `+(l-u)+`ms
Total Duration: ${l-h}ms`),A.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:p})))}};function tD(n,e){return new Zm(n,e)}var Xm=class{constructor(e,t){this.db=e,this.garbageCollector=tD(this,t)}Jn(e){let t=this.Xn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Xn(e){let t=0;return this.Yn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Yn(e,t){return this.er(e,(r,i)=>t(i))}addReference(e,t,r){return Ku(e,r)}removeReference(e,t,r){return Ku(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Ku(e,t)}tr(e,t){return function(i,o){let s=!1;return eD(i).Y(a=>XC(i,a,o).next(u=>(u&&(s=!0),A.resolve(!u)))).next(()=>s)}(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.er(e,(s,a)=>{if(a<=t){let u=this.tr(e,s).next(l=>{if(!l)return o++,r.getEntry(e,s).next(()=>(r.removeEntry(s,z.min()),Yn(e).delete(function(p){return[0,ot(p.path)]}(s))))});i.push(u)}}).next(()=>A.waitFor(i)).next(()=>r.apply(e)).next(()=>o)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Ku(e,t)}er(e,t){let r=Yn(e),i,o=_t.oe;return r.J({index:"documentTargetsIndex"},([s,a],{path:u,sequenceNumber:l})=>{s===0?(o!==_t.oe&&t(new j(Qt(i)),o),o=l,i=u):o=_t.oe}).next(()=>{o!==_t.oe&&t(new j(Qt(i)),o)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function Ku(n,e){return Yn(n).put(function(r,i){return{targetId:0,path:ot(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}var Rl=class{constructor(){this.changes=new Vt(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ue.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?A.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var eg=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Zr(e).put(r)}removeEntry(e,t,r){return Zr(e).delete(function(o,s){let a=o.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],bl(s),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.nr(e,r)))}getEntry(e,t){let r=Ue.newInvalidDocument(t);return Zr(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Fs(t))},(i,o)=>{r=this.rr(t,o)}).next(()=>r)}ir(e,t){let r={size:0,document:Ue.newInvalidDocument(t)};return Zr(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Fs(t))},(i,o)=>{r={document:this.rr(t,o),size:Al(o)}}).next(()=>r)}getEntries(e,t){let r=mt();return this.sr(e,t,(i,o)=>{let s=this.rr(i,o);r=r.insert(i,s)}).next(()=>r)}_r(e,t){let r=mt(),i=new Ee(j.comparator);return this.sr(e,t,(o,s)=>{let a=this.rr(o,s);r=r.insert(o,a),i=i.insert(o,Al(s))}).next(()=>({documents:r,ar:i}))}sr(e,t,r){if(t.isEmpty())return A.resolve();let i=new Ie(Pb);t.forEach(u=>i=i.add(u));let o=IDBKeyRange.bound(Fs(i.first()),Fs(i.last())),s=i.getIterator(),a=s.getNext();return Zr(e).J({index:"documentKeyIndex",range:o},(u,l,h)=>{let p=j.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&Pb(a,p)<0;)r(a,null),a=s.getNext();a&&a.isEqual(p)&&(r(a,l),a=s.hasNext()?s.getNext():null),a?h.$(Fs(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,o){let s=t.path,a=[s.popLast().toArray(),s.lastSegment(),bl(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Zr(e).U(IDBKeyRange.bound(a,u,!0)).next(l=>{o?.incrementDocumentReadCount(l.length);let h=mt();for(let p of l){let g=this.rr(j.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);g.isFoundDocument()&&(Ia(t,g)||i.has(g.key))&&(h=h.insert(g.key,g))}return h})}getAllFromCollectionGroup(e,t,r,i){let o=mt(),s=Rb(t,r),a=Rb(t,At.max());return Zr(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(s,a,!0)},(u,l,h)=>{let p=this.rr(j.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);o=o.insert(p.key,p),o.size===i&&h.done()}).next(()=>o)}newChangeBuffer(e){return new tg(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return xb(e).get("remoteDocumentGlobalKey").next(t=>(q(!!t),t))}nr(e,t){return xb(e).put("remoteDocumentGlobalKey",t)}rr(e,t){if(t){let r=lV(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(z.min())))return r}return Ue.newInvalidDocument(e)}};function nD(n){return new eg(n)}var tg=class extends Rl{constructor(e,t){super(),this.ur=e,this.trackRemovals=t,this.cr=new Vt(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let t=[],r=0,i=new Ie((o,s)=>K(o.canonicalString(),s.canonicalString()));return this.changes.forEach((o,s)=>{let a=this.cr.get(o);if(t.push(this.ur.removeEntry(e,o,a.readTime)),s.isValidDocument()){let u=yb(this.ur.serializer,s);i=i.add(o.path.popLast());let l=Al(u);r+=l-a.size,t.push(this.ur.addEntry(e,o,u))}else if(r-=a.size,this.trackRemovals){let u=yb(this.ur.serializer,s.convertToNoDocument(z.min()));t.push(this.ur.addEntry(e,o,u))}}),i.forEach(o=>{t.push(this.ur.indexManager.addToCollectionParentIndex(e,o))}),t.push(this.ur.updateMetadata(e,r)),A.waitFor(t)}getFromCache(e,t){return this.ur.ir(e,t).next(r=>(this.cr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.ur._r(e,t).next(({documents:r,ar:i})=>(i.forEach((o,s)=>{this.cr.set(o,{size:s,readTime:r.get(o).readTime})}),r))}};function xb(n){return ze(n,"remoteDocumentGlobal")}function Zr(n){return ze(n,"remoteDocumentsV14")}function Fs(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Rb(n,e){let t=e.documentKey.path.toArray();return[n,bl(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Pb(n,e){let t=n.path.toArray(),r=e.path.toArray(),i=0;for(let o=0;o<t.length-2&&o<r.length-2;++o)if(i=K(t[o],r[o]),i)return i;return i=K(t.length,r.length),i||(i=K(t[t.length-2],r[r.length-2]),i||K(t[t.length-1],r[r.length-1]))}var ng=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Pl=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Hs(r.mutation,i,It.empty(),Re.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,J()).next(()=>r))}getLocalViewOfDocuments(e,t,r=J()){let i=Yt();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let s=Us();return o.forEach((a,u)=>{s=s.insert(a,u.overlayedDocument)}),s}))}getOverlayedDocuments(e,t){let r=Yt();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,J()))}populateOverlays(e,t,r){let i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((s,a)=>{t.set(s,a)})})}computeViews(e,t,r,i){let o=mt(),s=qs(),a=function(){return qs()}();return t.forEach((u,l)=>{let h=r.get(l.key);i.has(l.key)&&(h===void 0||h.mutation instanceof Ft)?o=o.insert(l.key,l):h!==void 0?(s.set(l.key,h.mutation.getFieldMask()),Hs(h.mutation,l,h.mutation.getFieldMask(),Re.now())):s.set(l.key,It.empty())}),this.recalculateAndSaveOverlays(e,o).next(u=>(u.forEach((l,h)=>s.set(l,h)),t.forEach((l,h)=>{var p;return a.set(l,new ng(h,(p=s.get(l))!==null&&p!==void 0?p:null))}),a))}recalculateAndSaveOverlays(e,t){let r=qs(),i=new Ee((s,a)=>s-a),o=J();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(s=>{for(let a of s)a.keys().forEach(u=>{let l=t.get(u);if(l===null)return;let h=r.get(u)||It.empty();h=a.applyToLocalView(l,h),r.set(u,h);let p=(i.get(a.batchId)||J()).add(u);i=i.insert(a.batchId,p)})}).next(()=>{let s=[],a=i.getReverseIterator();for(;a.hasNext();){let u=a.getNext(),l=u.key,h=u.value,p=bC();h.forEach(g=>{if(!o.has(g)){let y=PC(t.get(g),r.get(g));y!==null&&p.set(g,y),o=o.add(g)}}),s.push(this.documentOverlayCache.saveOverlays(e,l,p))}return A.waitFor(s)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(s){return j.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):gy(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{let s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):A.resolve(Yt()),a=-1,u=o;return s.next(l=>A.forEach(l,(h,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),o.get(h)?A.resolve():this.remoteDocumentCache.getEntry(e,h).next(g=>{u=u.insert(h,g)}))).next(()=>this.populateOverlays(e,l,o)).next(()=>this.computeViews(e,u,l,J())).next(h=>({batchId:a,changes:TC(h)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new j(t)).next(r=>{let i=Us();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let o=t.collectionGroup,s=Us();return this.indexManager.getCollectionParents(e,o).next(a=>A.forEach(a,u=>{let l=function(p,g){return new Lt(g,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(t,u.child(o));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(h=>{h.forEach((p,g)=>{s=s.insert(p,g)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(s=>{o.forEach((u,l)=>{let h=l.getKey();s.get(h)===null&&(s=s.insert(h,Ue.newInvalidDocument(h)))});let a=Us();return s.forEach((u,l)=>{let h=o.get(u);h!==void 0&&Hs(h.mutation,l,It.empty(),Re.now()),Ia(t,l)&&(a=a.insert(u,l))}),a})}};var rg=class{constructor(e){this.serializer=e,this.lr=new Map,this.hr=new Map}getBundleMetadata(e,t){return A.resolve(this.lr.get(t))}saveBundleMetadata(e,t){return this.lr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Pe(i.createTime)}}(t)),A.resolve()}getNamedQuery(e,t){return A.resolve(this.hr.get(t))}saveNamedQuery(e,t){return this.hr.set(t.name,function(i){return{name:i.name,query:_y(i.bundledQuery),readTime:Pe(i.readTime)}}(t)),A.resolve()}};var ig=class{constructor(){this.overlays=new Ee(j.comparator),this.Pr=new Map}getOverlay(e,t){return A.resolve(this.overlays.get(t))}getOverlays(e,t){let r=Yt();return A.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.ht(e,t,o)}),A.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Pr.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.Pr.delete(r)),A.resolve()}getOverlaysForCollection(e,t,r){let i=Yt(),o=t.length+1,s=new j(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){let u=a.getNext().value,l=u.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===o&&u.largestBatchId>r&&i.set(u.getKey(),u)}return A.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new Ee((l,h)=>l-h),s=this.overlays.getIterator();for(;s.hasNext();){let l=s.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let h=o.get(l.largestBatchId);h===null&&(h=Yt(),o=o.insert(l.largestBatchId,h)),h.set(l.getKey(),l)}}let a=Yt(),u=o.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((l,h)=>a.set(l,h)),!(a.size()>=i)););return A.resolve(a)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let s=this.Pr.get(i.largestBatchId).delete(r.key);this.Pr.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(r.key,new ea(t,r));let o=this.Pr.get(t);o===void 0&&(o=J(),this.Pr.set(t,o)),this.Pr.set(t,o.add(r.key))}};var og=class{constructor(){this.sessionToken=ke.EMPTY_BYTE_STRING}getSessionToken(e){return A.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,A.resolve()}};var sa=class{constructor(){this.Ir=new Ie(Ve.Tr),this.Er=new Ie(Ve.dr)}isEmpty(){return this.Ir.isEmpty()}addReference(e,t){let r=new Ve(e,t);this.Ir=this.Ir.add(r),this.Er=this.Er.add(r)}Ar(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Rr(new Ve(e,t))}Vr(e,t){e.forEach(r=>this.removeReference(r,t))}mr(e){let t=new j(new ce([])),r=new Ve(t,e),i=new Ve(t,e+1),o=[];return this.Er.forEachInRange([r,i],s=>{this.Rr(s),o.push(s.key)}),o}gr(){this.Ir.forEach(e=>this.Rr(e))}Rr(e){this.Ir=this.Ir.delete(e),this.Er=this.Er.delete(e)}pr(e){let t=new j(new ce([])),r=new Ve(t,e),i=new Ve(t,e+1),o=J();return this.Er.forEachInRange([r,i],s=>{o=o.add(s.key)}),o}containsKey(e){let t=new Ve(e,0),r=this.Ir.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},Ve=class{constructor(e,t){this.key=e,this.yr=t}static Tr(e,t){return j.comparator(e.key,t.key)||K(e.yr,t.yr)}static dr(e,t){return K(e.yr,t.yr)||j.comparator(e.key,t.key)}};var sg=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.wr=1,this.Sr=new Ie(Ve.Tr)}checkEmpty(e){return A.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let o=this.wr;this.wr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new Xs(o,t,r,i);this.mutationQueue.push(s);for(let a of i)this.Sr=this.Sr.add(new Ve(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return A.resolve(s)}lookupMutationBatch(e,t){return A.resolve(this.br(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.Dr(r),o=i<0?0:i;return A.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return A.resolve(this.mutationQueue.length===0?-1:this.wr-1)}getAllMutationBatches(e){return A.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new Ve(t,0),i=new Ve(t,Number.POSITIVE_INFINITY),o=[];return this.Sr.forEachInRange([r,i],s=>{let a=this.br(s.yr);o.push(a)}),A.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ie(K);return t.forEach(i=>{let o=new Ve(i,0),s=new Ve(i,Number.POSITIVE_INFINITY);this.Sr.forEachInRange([o,s],a=>{r=r.add(a.yr)})}),A.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=r;j.isDocumentKey(o)||(o=o.child(""));let s=new Ve(new j(o),0),a=new Ie(K);return this.Sr.forEachWhile(u=>{let l=u.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(u.yr)),!0)},s),A.resolve(this.Cr(a))}Cr(e){let t=[];return e.forEach(r=>{let i=this.br(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){q(this.vr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.Sr;return A.forEach(t.mutations,i=>{let o=new Ve(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Sr=r})}xn(e){}containsKey(e,t){let r=new Ve(t,0),i=this.Sr.firstAfterOrEqual(r);return A.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,A.resolve()}vr(e,t){return this.Dr(e)}Dr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}br(e){let t=this.Dr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var ag=class{constructor(e){this.Fr=e,this.docs=function(){return new Ee(j.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),o=i?i.size:0,s=this.Fr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return A.resolve(r?r.document.mutableCopy():Ue.newInvalidDocument(t))}getEntries(e,t){let r=mt();return t.forEach(i=>{let o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():Ue.newInvalidDocument(i))}),A.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=mt(),s=t.path,a=new j(s.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){let{key:l,value:{document:h}}=u.getNext();if(!s.isPrefixOf(l.path))break;l.path.length>s.length+1||hy(Xb(h),r)<=0||(i.has(h.key)||Ia(t,h))&&(o=o.insert(h.key,h.mutableCopy()))}return A.resolve(o)}getAllFromCollectionGroup(e,t,r,i){$()}Mr(e,t){return A.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new cg(this)}getSize(e){return A.resolve(this.size)}},cg=class extends Rl{constructor(e){super(),this.ur=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.ur.addEntry(e,i)):this.ur.removeEntry(r)}),A.waitFor(t)}getFromCache(e,t){return this.ur.getEntry(e,t)}getAllFromCache(e,t){return this.ur.getEntries(e,t)}};var ug=class{constructor(e){this.persistence=e,this.Or=new Vt(t=>ci(t),va),this.lastRemoteSnapshotVersion=z.min(),this.highestTargetId=0,this.Nr=0,this.Lr=new sa,this.targetCount=0,this.Br=_o.Ln()}forEachTarget(e,t){return this.Or.forEach((r,i)=>t(i)),A.resolve()}getLastRemoteSnapshotVersion(e){return A.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return A.resolve(this.Nr)}allocateTargetId(e){return this.highestTargetId=this.Br.next(),A.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Nr&&(this.Nr=t),A.resolve()}Qn(e){this.Or.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.Br=new _o(t),this.highestTargetId=t),e.sequenceNumber>this.Nr&&(this.Nr=e.sequenceNumber)}addTargetData(e,t){return this.Qn(t),this.targetCount+=1,A.resolve()}updateTargetData(e,t){return this.Qn(t),A.resolve()}removeTargetData(e,t){return this.Or.delete(t.target),this.Lr.mr(t.targetId),this.targetCount-=1,A.resolve()}removeTargets(e,t,r){let i=0,o=[];return this.Or.forEach((s,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Or.delete(s),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),A.waitFor(o).next(()=>i)}getTargetCount(e){return A.resolve(this.targetCount)}getTargetData(e,t){let r=this.Or.get(t)||null;return A.resolve(r)}addMatchingKeys(e,t,r){return this.Lr.Ar(t,r),A.resolve()}removeMatchingKeys(e,t,r){this.Lr.Vr(t,r);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(s=>{o.push(i.markPotentiallyOrphaned(e,s))}),A.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.Lr.mr(t),A.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Lr.pr(t);return A.resolve(r)}containsKey(e,t){return A.resolve(this.Lr.containsKey(t))}};var aa=class{constructor(e,t){this.kr={},this.overlays={},this.qr=new _t(0),this.Qr=!1,this.Qr=!0,this.Kr=new og,this.referenceDelegate=e(this),this.$r=new ug(this),this.indexManager=new Km,this.remoteDocumentCache=function(i){return new ag(i)}(r=>this.referenceDelegate.Ur(r)),this.serializer=new Tl(t),this.Wr=new rg(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Qr=!1,Promise.resolve()}get started(){return this.Qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ig,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.kr[e.toKey()];return r||(r=new sg(t,this.referenceDelegate),this.kr[e.toKey()]=r),r}getGlobalsCache(){return this.Kr}getTargetCache(){return this.$r}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Wr}runTransaction(e,t,r){k("MemoryPersistence","Starting transaction:",e);let i=new lg(this.qr.next());return this.referenceDelegate.Gr(),r(i).next(o=>this.referenceDelegate.zr(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}jr(e,t){return A.or(Object.values(this.kr).map(r=>()=>r.containsKey(e,t)))}},lg=class extends ul{constructor(e){super(),this.currentSequenceNumber=e}},Ml=class n{constructor(e){this.persistence=e,this.Hr=new sa,this.Jr=null}static Yr(e){return new n(e)}get Zr(){if(this.Jr)return this.Jr;throw $()}addReference(e,t,r){return this.Hr.addReference(r,t),this.Zr.delete(r.toString()),A.resolve()}removeReference(e,t,r){return this.Hr.removeReference(r,t),this.Zr.add(r.toString()),A.resolve()}markPotentiallyOrphaned(e,t){return this.Zr.add(t.toString()),A.resolve()}removeTarget(e,t){this.Hr.mr(t.targetId).forEach(i=>this.Zr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.Zr.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}Gr(){this.Jr=new Set}zr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return A.forEach(this.Zr,r=>{let i=j.fromPath(r);return this.Xr(e,i).next(o=>{o||t.removeEntry(i,z.min())})}).next(()=>(this.Jr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Xr(e,t).next(r=>{r?this.Zr.delete(t.toString()):this.Zr.add(t.toString())})}Ur(e){return 0}Xr(e,t){return A.or([()=>A.resolve(this.Hr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.jr(e,t)])}},kl=class n{constructor(e,t){this.persistence=e,this.ei=new Vt(r=>ot(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=tD(this,t)}static Yr(e,t){return new n(e,t)}Gr(){}zr(e){return A.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}Jn(e){let t=this.Xn(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Xn(e){let t=0;return this.Yn(e,r=>{t++}).next(()=>t)}Yn(e,t){return A.forEach(this.ei,(r,i)=>this.tr(e,r,i).next(o=>o?A.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.Mr(e,s=>this.tr(e,s,t).next(a=>{a||(r++,o.removeEntry(s,z.min()))})).next(()=>o.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.ei.set(t,e.currentSequenceNumber),A.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.ei.set(r,e.currentSequenceNumber),A.resolve()}removeReference(e,t,r){return this.ei.set(r,e.currentSequenceNumber),A.resolve()}updateLimboDocument(e,t){return this.ei.set(t,e.currentSequenceNumber),A.resolve()}Ur(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=el(e.data.value)),t}tr(e,t,r){return A.or([()=>this.persistence.jr(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.ei.get(t);return A.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var dg=class{constructor(e){this.serializer=e}O(e,t,r,i){let o=new ll("createOrUpgrade",t);r<1&&i>=1&&(function(u){u.createObjectStore("owner")}(e),function(u){u.createObjectStore("mutationQueues",{keyPath:"userId"}),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",YT,{unique:!0}),u.createObjectStore("documentMutations")}(e),Mb(e),function(u){u.createObjectStore("remoteDocuments")}(e));let s=A.resolve();return r<3&&i>=3&&(r!==0&&(function(u){u.deleteObjectStore("targetDocuments"),u.deleteObjectStore("targets"),u.deleteObjectStore("targetGlobal")}(e),Mb(e)),s=s.next(()=>function(u){let l=u.store("targetGlobal"),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:z.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",h)}(o))),r<4&&i>=4&&(r!==0&&(s=s.next(()=>function(u,l){return l.store("mutations").U().next(h=>{u.deleteObjectStore("mutations"),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",YT,{unique:!0});let p=l.store("mutations"),g=h.map(y=>p.put(y));return A.waitFor(g)})}(e,o))),s=s.next(()=>{(function(u){u.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(s=s.next(()=>this.ti(o))),r<6&&i>=6&&(s=s.next(()=>(function(u){u.createObjectStore("remoteDocumentGlobal")}(e),this.ni(o)))),r<7&&i>=7&&(s=s.next(()=>this.ri(o))),r<8&&i>=8&&(s=s.next(()=>this.ii(e,o))),r<9&&i>=9&&(s=s.next(()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(s=s.next(()=>this.si(o))),r<11&&i>=11&&(s=s.next(()=>{(function(u){u.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(u){u.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(s=s.next(()=>{(function(u){let l=u.createObjectStore("documentOverlays",{keyPath:RL});l.createIndex("collectionPathOverlayIndex",PL,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",ML,{unique:!1})})(e)})),r<13&&i>=13&&(s=s.next(()=>function(u){let l=u.createObjectStore("remoteDocumentsV14",{keyPath:IL});l.createIndex("documentKeyIndex",wL),l.createIndex("collectionGroupIndex",EL)}(e)).next(()=>this.oi(e,o)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(s=s.next(()=>this._i(e,o))),r<15&&i>=15&&(s=s.next(()=>function(u){u.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),u.createObjectStore("indexState",{keyPath:SL}).createIndex("sequenceNumberIndex",AL,{unique:!1}),u.createObjectStore("indexEntries",{keyPath:NL}).createIndex("documentKeyIndex",xL,{unique:!1})}(e))),r<16&&i>=16&&(s=s.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),r<17&&i>=17&&(s=s.next(()=>{(function(u){u.createObjectStore("globals",{keyPath:"name"})})(e)})),s}ni(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=Al(i)}).next(()=>{let r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ti(e){let t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(i=>A.forEach(i,o=>{let s=IDBKeyRange.bound([o.userId,-1],[o.userId,o.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",s).next(a=>A.forEach(a,u=>{q(u.userId===o.userId);let l=ti(this.serializer,u);return ZC(e,o.userId,l).next(()=>{})}))}))}ri(e){let t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let o=[];return r.J((s,a)=>{let u=new ce(s),l=function(p){return[0,ot(p)]}(u);o.push(t.get(l).next(h=>h?A.resolve():(p=>t.put({targetId:0,path:ot(p),sequenceNumber:i.highestListenSequenceNumber}))(u)))}).next(()=>A.waitFor(o))})}ii(e,t){e.createObjectStore("collectionParents",{keyPath:DL});let r=t.store("collectionParents"),i=new oa,o=s=>{if(i.add(s)){let a=s.lastSegment(),u=s.popLast();return r.put({collectionId:a,parent:ot(u)})}};return t.store("remoteDocuments").J({H:!0},(s,a)=>{let u=new ce(s);return o(u.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([s,a,u],l)=>{let h=Qt(a);return o(h.popLast())}))}si(e){let t=e.store("targets");return t.J((r,i)=>{let o=Bs(i),s=QC(this.serializer,o);return t.put(s)})}oi(e,t){let r=t.store("remoteDocuments"),i=[];return r.J((o,s)=>{let a=t.store("remoteDocumentsV14"),u=function(p){return p.document?new j(ce.fromString(p.document.name).popFirst(5)):p.noDocument?j.fromSegments(p.noDocument.path):p.unknownDocument?j.fromSegments(p.unknownDocument.path):$()}(s).path.toArray(),l={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:s.readTime||[0,0],unknownDocument:s.unknownDocument,noDocument:s.noDocument,document:s.document,hasCommittedMutations:!!s.hasCommittedMutations};i.push(a.put(l))}).next(()=>A.waitFor(i))}_i(e,t){let r=t.store("mutations"),i=nD(this.serializer),o=new aa(Ml.Yr,this.serializer.ct);return r.U().next(s=>{let a=new Map;return s.forEach(u=>{var l;let h=(l=a.get(u.userId))!==null&&l!==void 0?l:J();ti(this.serializer,u).keys().forEach(p=>h=h.add(p)),a.set(u.userId,h)}),A.forEach(a,(u,l)=>{let h=new Fe(l),p=Cl.lt(this.serializer,h),g=o.getIndexManager(h),y=Nl.lt(h,this.serializer,g,o.referenceDelegate);return new Pl(i,y,p,g).recalculateAndSaveOverlaysForDocumentKeys(new Ks(t,_t.oe),u).next()})})}};function Mb(n){n.createObjectStore("targetDocuments",{keyPath:bL}).createIndex("documentTargetsIndex",CL,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",TL,{unique:!0}),n.createObjectStore("targetGlobal")}var nm="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",hg=class n{constructor(e,t,r,i,o,s,a,u,l,h,p=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ai=o,this.window=s,this.document=a,this.ui=l,this.ci=h,this.li=p,this.qr=null,this.Qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.hi=null,this.inForeground=!1,this.Pi=null,this.Ii=null,this.Ti=Number.NEGATIVE_INFINITY,this.Ei=g=>Promise.resolve(),!n.D())throw new M(N.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Xm(this,i),this.di=t+"main",this.serializer=new Tl(u),this.Ai=new tr(this.di,this.li,new dg(this.serializer)),this.Kr=new Bm,this.$r=new Ym(this.referenceDelegate,this.serializer),this.remoteDocumentCache=nD(this.serializer),this.Wr=new Um,this.window&&this.window.localStorage?this.Ri=this.window.localStorage:(this.Ri=null,h===!1&&Ne("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Vi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new M(N.FAILED_PRECONDITION,nm);return this.mi(),this.fi(),this.gi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.$r.getHighestSequenceNumber(e))}).then(e=>{this.qr=new _t(e,this.ui)}).then(()=>{this.Qr=!0}).catch(e=>(this.Ai&&this.Ai.close(),Promise.reject(e)))}pi(e){return this.Ei=t=>w(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ai.L(t=>w(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ai.enqueueAndForget(()=>w(this,null,function*(){this.started&&(yield this.Vi())})))}Vi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Qu(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.yi(e).next(t=>{t||(this.isPrimary=!1,this.ai.enqueueRetryable(()=>this.Ei(!1)))})}).next(()=>this.wi(e)).next(t=>this.isPrimary&&!t?this.Si(e).next(()=>!1):!!t&&this.bi(e).next(()=>!0))).catch(e=>{if(pr(e))return k("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return k("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ai.enqueueRetryable(()=>this.Ei(e)),this.isPrimary=e})}yi(e){return js(e).get("owner").next(t=>A.resolve(this.Di(t)))}Ci(e){return Qu(e).delete(this.clientId)}vi(){return w(this,null,function*(){if(this.isPrimary&&!this.Fi(this.Ti,18e5)){this.Ti=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let r=ze(t,"clientMetadata");return r.U().next(i=>{let o=this.Mi(i,18e5),s=i.filter(a=>o.indexOf(a)===-1);return A.forEach(s,a=>r.delete(a.clientId)).next(()=>s)})}).catch(()=>[]);if(this.Ri)for(let t of e)this.Ri.removeItem(this.xi(t.clientId))}})}gi(){this.Ii=this.ai.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Vi().then(()=>this.vi()).then(()=>this.gi()))}Di(e){return!!e&&e.ownerId===this.clientId}wi(e){return this.ci?A.resolve(!0):js(e).get("owner").next(t=>{if(t!==null&&this.Fi(t.leaseTimestampMs,5e3)&&!this.Oi(t.ownerId)){if(this.Di(t)&&this.networkEnabled)return!0;if(!this.Di(t)){if(!t.allowTabSynchronization)throw new M(N.FAILED_PRECONDITION,nm);return!1}}return!(!this.networkEnabled||!this.inForeground)||Qu(e).U().next(r=>this.Mi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let o=!this.networkEnabled&&i.networkEnabled,s=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(o||s&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&k("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return w(this,null,function*(){this.Qr=!1,this.Ni(),this.Ii&&(this.Ii.cancel(),this.Ii=null),this.Li(),this.Bi(),yield this.Ai.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let t=new Ks(e,_t.oe);return this.Si(t).next(()=>this.Ci(t))}),this.Ai.close(),this.ki()})}Mi(e,t){return e.filter(r=>this.Fi(r.updateTimeMs,t)&&!this.Oi(r.clientId))}qi(){return this.runTransaction("getActiveClients","readonly",e=>Qu(e).U().next(t=>this.Mi(t,18e5).map(r=>r.clientId)))}get started(){return this.Qr}getGlobalsCache(){return this.Kr}getMutationQueue(e,t){return Nl.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.$r}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Qm(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Cl.lt(this.serializer,e)}getBundleCache(){return this.Wr}runTransaction(e,t,r){k("IndexedDbPersistence","Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",o=function(u){return u===17?LL:u===16?OL:u===15?py:u===14?sC:u===13?oC:u===12?kL:u===11?iC:void $()}(this.li),s;return this.Ai.runTransaction(e,i,o,a=>(s=new Ks(a,this.qr?this.qr.next():_t.oe),t==="readwrite-primary"?this.yi(s).next(u=>!!u||this.wi(s)).next(u=>{if(!u)throw Ne(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ai.enqueueRetryable(()=>this.Ei(!1)),new M(N.FAILED_PRECONDITION,eC);return r(s)}).next(u=>this.bi(s).next(()=>u)):this.Qi(s).next(()=>r(s)))).then(a=>(s.raiseOnCommittedEvent(),a))}Qi(e){return js(e).get("owner").next(t=>{if(t!==null&&this.Fi(t.leaseTimestampMs,5e3)&&!this.Oi(t.ownerId)&&!this.Di(t)&&!(this.ci||this.allowTabSynchronization&&t.allowTabSynchronization))throw new M(N.FAILED_PRECONDITION,nm)})}bi(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return js(e).put("owner",t)}static D(){return tr.D()}Si(e){let t=js(e);return t.get("owner").next(r=>this.Di(r)?(k("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):A.resolve())}Fi(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(Ne(`Detected an update time that is in the future: ${e} > ${r}`),!1))}mi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Pi=()=>{this.ai.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Vi()))},this.document.addEventListener("visibilitychange",this.Pi),this.inForeground=this.document.visibilityState==="visible")}Li(){this.Pi&&(this.document.removeEventListener("visibilitychange",this.Pi),this.Pi=null)}fi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.hi=()=>{this.Ni();let t=/(?:Version|Mobile)\/1[456]/;mp()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ai.enterRestrictedMode(!0),this.ai.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.hi))}Bi(){this.hi&&(this.window.removeEventListener("pagehide",this.hi),this.hi=null)}Oi(e){var t;try{let r=((t=this.Ri)===null||t===void 0?void 0:t.getItem(this.xi(e)))!==null;return k("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Ne("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Ni(){if(this.Ri)try{this.Ri.setItem(this.xi(this.clientId),String(Date.now()))}catch(e){Ne("Failed to set zombie client id.",e)}}ki(){if(this.Ri)try{this.Ri.removeItem(this.xi(this.clientId))}catch{}}xi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function js(n){return ze(n,"owner")}function Qu(n){return ze(n,"clientMetadata")}function wy(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var fg=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Ki=r,this.$i=i}static Ui(e,t){let r=J(),i=J();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new n(e,t.fromCache,r,i)}};var pg=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Ol=class{constructor(){this.Wi=!1,this.Gi=!1,this.zi=100,this.ji=function(){return mp()?8:tC(nt())>0?6:4}()}initialize(e,t){this.Hi=e,this.indexManager=t,this.Wi=!0}getDocumentsMatchingQuery(e,t,r,i){let o={result:null};return this.Ji(e,t).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.Yi(e,t,i,r).next(s=>{o.result=s})}).next(()=>{if(o.result)return;let s=new pg;return this.Zi(e,t,s).next(a=>{if(o.result=a,this.Gi)return this.Xi(e,t,s,a.size)})}).next(()=>o.result)}Xi(e,t,r,i){return r.documentReadCount<this.zi?(to()<=ie.DEBUG&&k("QueryEngine","SDK will not create cache indexes for query:",no(t),"since it only creates cache indexes for collection contains","more than or equal to",this.zi,"documents"),A.resolve()):(to()<=ie.DEBUG&&k("QueryEngine","Query:",no(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.ji*i?(to()<=ie.DEBUG&&k("QueryEngine","The SDK decides to create cache indexes for query:",no(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,st(t))):A.resolve())}Ji(e,t){if(ab(t))return A.resolve(null);let r=st(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=yl(t,null,"F"),r=st(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let s=J(...o);return this.Hi.getDocuments(e,s).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{let l=this.es(t,a);return this.ts(t,l,s,u.readTime)?this.Ji(e,yl(t,null,"F")):this.ns(e,l,t,u)}))})))}Yi(e,t,r,i){return ab(t)||i.isEqual(z.min())?A.resolve(null):this.Hi.getDocuments(e,r).next(o=>{let s=this.es(t,o);return this.ts(t,s,r,i)?A.resolve(null):(to()<=ie.DEBUG&&k("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),no(t)),this.ns(e,s,t,Zb(i,-1)).next(a=>a))})}es(e,t){let r=new Ie(wC(e));return t.forEach((i,o)=>{Ia(e,o)&&(r=r.add(o))}),r}ts(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Zi(e,t,r){return to()<=ie.DEBUG&&k("QueryEngine","Using full collection scan to execute query:",no(t)),this.Hi.getDocumentsMatchingQuery(e,t,At.min(),r)}ns(e,t,r,i){return this.Hi.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(s=>{o=o.insert(s.key,s)}),o))}};var mg=class{constructor(e,t,r,i){this.persistence=e,this.rs=t,this.serializer=i,this.ss=new Ee(K),this.os=new Vt(o=>ci(o),va),this._s=new Map,this.us=e.getRemoteDocumentCache(),this.$r=e.getTargetCache(),this.Wr=e.getBundleCache(),this.cs(r)}cs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Pl(this.us,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.us.setIndexManager(this.indexManager),this.rs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ss))}};function rD(n,e,t,r){return new mg(n,e,t,r)}function iD(n,e){return w(this,null,function*(){let t=V(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.cs(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let s=[],a=[],u=J();for(let l of i){s.push(l.batchId);for(let h of l.mutations)u=u.add(h.key)}for(let l of o){a.push(l.batchId);for(let h of l.mutations)u=u.add(h.key)}return t.localDocuments.getDocuments(r,u).next(l=>({ls:l,removedBatchIds:s,addedBatchIds:a}))})})})}function fV(n,e){let t=V(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),o=t.us.newChangeBuffer({trackRemovals:!0});return function(a,u,l,h){let p=l.batch,g=p.keys(),y=A.resolve();return g.forEach(D=>{y=y.next(()=>h.getEntry(u,D)).next(R=>{let P=l.docVersions.get(D);q(P!==null),R.version.compareTo(P)<0&&(p.applyToRemoteDocument(R,l),R.isValidDocument()&&(R.setReadTime(l.commitVersion),h.addEntry(R)))})}),y.next(()=>a.mutationQueue.removeMutationBatch(u,p))}(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=J();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(u=u.add(a.batch.mutations[l].key));return u}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function oD(n){let e=V(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.$r.getLastRemoteSnapshotVersion(t))}function pV(n,e){let t=V(n),r=e.snapshotVersion,i=t.ss;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let s=t.us.newChangeBuffer({trackRemovals:!0});i=t.ss;let a=[];e.targetChanges.forEach((h,p)=>{let g=i.get(p);if(!g)return;a.push(t.$r.removeMatchingKeys(o,h.removedDocuments,p).next(()=>t.$r.addMatchingKeys(o,h.addedDocuments,p)));let y=g.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(p)!==null?y=y.withResumeToken(ke.EMPTY_BYTE_STRING,z.min()).withLastLimboFreeSnapshotVersion(z.min()):h.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(h.resumeToken,r)),i=i.insert(p,y),function(R,P,O){return R.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-R.snapshotVersion.toMicroseconds()>=3e8?!0:O.addedDocuments.size+O.modifiedDocuments.size+O.removedDocuments.size>0}(g,y,h)&&a.push(t.$r.updateTargetData(o,y))});let u=mt(),l=J();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(o,h))}),a.push(sD(o,s,e.documentUpdates).next(h=>{u=h.hs,l=h.Ps})),!r.isEqual(z.min())){let h=t.$r.getLastRemoteSnapshotVersion(o).next(p=>t.$r.setTargetsMetadata(o,o.currentSequenceNumber,r));a.push(h)}return A.waitFor(a).next(()=>s.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,u,l)).next(()=>u)}).then(o=>(t.ss=i,o))}function sD(n,e,t){let r=J(),i=J();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let s=mt();return t.forEach((a,u)=>{let l=o.get(a);u.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),u.isNoDocument()&&u.version.isEqual(z.min())?(e.removeEntry(a,u.readTime),s=s.insert(a,u)):!l.isValidDocument()||u.version.compareTo(l.version)>0||u.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(u),s=s.insert(a,u)):k("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",u.version)}),{hs:s,Ps:i}})}function mV(n,e){let t=V(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Io(n,e){let t=V(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.$r.getTargetData(r,e).next(o=>o?(i=o,A.resolve(i)):t.$r.allocateTargetId(r).next(s=>(i=new vo(e,s,"TargetPurposeListen",r.currentSequenceNumber),t.$r.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.ss.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.ss=t.ss.insert(r.targetId,r),t.os.set(e,r.targetId)),r})}function wo(n,e,t){return w(this,null,function*(){let r=V(n),i=r.ss.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",o,s=>r.persistence.referenceDelegate.removeTarget(s,i)))}catch(s){if(!pr(s))throw s;k("LocalStore",`Failed to update sequence numbers for target ${e}: ${s}`)}r.ss=r.ss.remove(e),r.os.delete(i.target)})}function Ll(n,e,t){let r=V(n),i=z.min(),o=J();return r.persistence.runTransaction("Execute query","readwrite",s=>function(u,l,h){let p=V(u),g=p.os.get(h);return g!==void 0?A.resolve(p.ss.get(g)):p.$r.getTargetData(l,h)}(r,s,st(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.$r.getMatchingKeysForTargetId(s,a.targetId).next(u=>{o=u})}).next(()=>r.rs.getDocumentsMatchingQuery(s,e,t?i:z.min(),t?o:J())).next(a=>(uD(r,IC(e),a),{documents:a,Is:o})))}function aD(n,e){let t=V(n),r=V(t.$r),i=t.ss.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",o=>r.ot(o,e).next(s=>s?s.target:null))}function cD(n,e){let t=V(n),r=t._s.get(e)||z.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.us.getAllFromCollectionGroup(i,e,Zb(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(uD(t,e,i),i))}function uD(n,e,t){let r=n._s.get(e)||z.min();t.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n._s.set(e,r)}function gV(n,e,t,r){return w(this,null,function*(){let i=V(n),o=J(),s=mt();for(let l of t){let h=e.Ts(l.metadata.name);l.document&&(o=o.add(h));let p=e.Es(l);p.setReadTime(e.ds(l.metadata.readTime)),s=s.insert(h,p)}let a=i.us.newChangeBuffer({trackRemovals:!0}),u=yield Io(i,function(h){return st(xo(ce.fromString(`__bundle__/docs/${h}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>sD(l,a,s).next(h=>(a.apply(l),h)).next(h=>i.$r.removeMatchingKeysForTargetId(l,u.targetId).next(()=>i.$r.addMatchingKeys(l,o,u.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,h.hs,h.Ps)).next(()=>h.hs)))})}function yV(r,i){return w(this,arguments,function*(n,e,t=J()){let o=yield Io(n,st(_y(e.bundledQuery))),s=V(n);return s.persistence.runTransaction("Save named query","readwrite",a=>{let u=Pe(e.readTime);if(o.snapshotVersion.compareTo(u)>=0)return s.Wr.saveNamedQuery(a,e);let l=o.withResumeToken(ke.EMPTY_BYTE_STRING,u);return s.ss=s.ss.insert(l.targetId,l),s.$r.updateTargetData(a,l).next(()=>s.$r.removeMatchingKeysForTargetId(a,o.targetId)).next(()=>s.$r.addMatchingKeys(a,t,o.targetId)).next(()=>s.Wr.saveNamedQuery(a,e))})})}function kb(n,e){return`firestore_clients_${n}_${e}`}function Ob(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function rm(n,e){return`firestore_targets_${n}_${e}`}var Vl=class n{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static As(e,t,r){let i=JSON.parse(r),o,s=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return s&&i.error&&(s=typeof i.error.message=="string"&&typeof i.error.code=="string",s&&(o=new M(i.error.code,i.error.message))),s?new n(e,t,i.state,o):(Ne("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Rs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},zs=class n{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static As(e,t){let r=JSON.parse(t),i,o=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return o&&r.error&&(o=typeof r.error.message=="string"&&typeof r.error.code=="string",o&&(i=new M(r.error.code,r.error.message))),o?new n(e,r.state,i):(Ne("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Rs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Fl=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static As(e,t){let r=JSON.parse(t),i=typeof r=="object"&&r.activeTargetIds instanceof Array,o=yy();for(let s=0;i&&s<r.activeTargetIds.length;++s)i=nC(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new n(e,o):(Ne("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}},gg=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static As(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(Ne("SharedClientState",`Failed to parse online state: ${e}`),null)}},ca=class{constructor(){this.activeTargetIds=yy()}Vs(e){this.activeTargetIds=this.activeTargetIds.add(e)}fs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Rs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},Gs=class{constructor(e,t,r,i,o){this.window=e,this.ai=t,this.persistenceKey=r,this.gs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ps=this.ys.bind(this),this.ws=new Ee(K),this.started=!1,this.Ss=[];let s=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.bs=kb(this.persistenceKey,this.gs),this.Ds=function(u){return`firestore_sequence_number_${u}`}(this.persistenceKey),this.ws=this.ws.insert(this.gs,new ca),this.Cs=new RegExp(`^firestore_clients_${s}_([^_]*)$`),this.vs=new RegExp(`^firestore_mutations_${s}_(\\d+)(?:_(.*))?$`),this.Fs=new RegExp(`^firestore_targets_${s}_(\\d+)$`),this.Ms=function(u){return`firestore_online_state_${u}`}(this.persistenceKey),this.xs=function(u){return`firestore_bundle_loaded_v2_${u}`}(this.persistenceKey),this.window.addEventListener("storage",this.ps)}static D(e){return!(!e||!e.localStorage)}start(){return w(this,null,function*(){let e=yield this.syncEngine.qi();for(let r of e){if(r===this.gs)continue;let i=this.getItem(kb(this.persistenceKey,r));if(i){let o=Fl.As(r,i);o&&(this.ws=this.ws.insert(o.clientId,o))}}this.Os();let t=this.storage.getItem(this.Ms);if(t){let r=this.Ns(t);r&&this.Ls(r)}for(let r of this.Ss)this.ys(r);this.Ss=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Ds,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Bs(this.ws)}isActiveQueryTarget(e){let t=!1;return this.ws.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.ks(e,"pending")}updateMutationState(e,t,r){this.ks(e,t,r),this.qs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(rm(this.persistenceKey,e));if(r){let i=zs.As(e,r);i&&(t=i.state)}}return this.Qs.Vs(e),this.Os(),t}removeLocalQueryTarget(e){this.Qs.fs(e),this.Os()}isLocalQueryTarget(e){return this.Qs.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(rm(this.persistenceKey,e))}updateQueryState(e,t,r){this.Ks(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.qs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.$s(e)}notifyBundleLoaded(e){this.Us(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ps),this.removeItem(this.bs),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return k("SharedClientState","READ",e,t),t}setItem(e,t){k("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){k("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ys(e){let t=e;if(t.storageArea===this.storage){if(k("SharedClientState","EVENT",t.key,t.newValue),t.key===this.bs)return void Ne("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ai.enqueueRetryable(()=>w(this,null,function*(){if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){let r=this.Ws(t.key);return this.Gs(r,null)}{let r=this.zs(t.key,t.newValue);if(r)return this.Gs(r.clientId,r)}}else if(this.vs.test(t.key)){if(t.newValue!==null){let r=this.js(t.key,t.newValue);if(r)return this.Hs(r)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){let r=this.Js(t.key,t.newValue);if(r)return this.Ys(r)}}else if(t.key===this.Ms){if(t.newValue!==null){let r=this.Ns(t.newValue);if(r)return this.Ls(r)}}else if(t.key===this.Ds){let r=function(o){let s=_t.oe;if(o!=null)try{let a=JSON.parse(o);q(typeof a=="number"),s=a}catch(a){Ne("SharedClientState","Failed to read sequence number from WebStorage",a)}return s}(t.newValue);r!==_t.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.xs){let r=this.Zs(t.newValue);yield Promise.all(r.map(i=>this.syncEngine.Xs(i)))}}}else this.Ss.push(t)}))}}get Qs(){return this.ws.get(this.gs)}Os(){this.setItem(this.bs,this.Qs.Rs())}ks(e,t,r){let i=new Vl(this.currentUser,e,t,r),o=Ob(this.persistenceKey,this.currentUser,e);this.setItem(o,i.Rs())}qs(e){let t=Ob(this.persistenceKey,this.currentUser,e);this.removeItem(t)}$s(e){let t={clientId:this.gs,onlineState:e};this.storage.setItem(this.Ms,JSON.stringify(t))}Ks(e,t,r){let i=rm(this.persistenceKey,e),o=new zs(e,t,r);this.setItem(i,o.Rs())}Us(e){let t=JSON.stringify(Array.from(e));this.setItem(this.xs,t)}Ws(e){let t=this.Cs.exec(e);return t?t[1]:null}zs(e,t){let r=this.Ws(e);return Fl.As(r,t)}js(e,t){let r=this.vs.exec(e),i=Number(r[1]),o=r[2]!==void 0?r[2]:null;return Vl.As(new Fe(o),i,t)}Js(e,t){let r=this.Fs.exec(e),i=Number(r[1]);return zs.As(i,t)}Ns(e){return gg.As(e)}Zs(e){return JSON.parse(e)}Hs(e){return w(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.eo(e.batchId,e.state,e.error);k("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Ys(e){return this.syncEngine.no(e.targetId,e.state,e.error)}Gs(e,t){let r=t?this.ws.insert(e,t):this.ws.remove(e),i=this.Bs(this.ws),o=this.Bs(r),s=[],a=[];return o.forEach(u=>{i.has(u)||s.push(u)}),i.forEach(u=>{o.has(u)||a.push(u)}),this.syncEngine.ro(s,a).then(()=>{this.ws=r})}Ls(e){this.ws.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Bs(e){let t=yy();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},jl=class{constructor(){this.io=new ca,this.so={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.io.Vs(e),this.so[e]||"not-current"}updateQueryState(e,t,r){this.so[e]=t}removeLocalQueryTarget(e){this.io.fs(e)}isLocalQueryTarget(e){return this.io.activeTargetIds.has(e)}clearQueryState(e){delete this.so[e]}getAllActiveQueryTargets(){return this.io.activeTargetIds}isActiveQueryTarget(e){return this.io.activeTargetIds.has(e)}start(){return this.io=new ca,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var yg=class{oo(e){}shutdown(){}};var Ul=class{constructor(){this._o=()=>this.ao(),this.uo=()=>this.co(),this.lo=[],this.ho()}oo(e){this.lo.push(e)}shutdown(){window.removeEventListener("online",this._o),window.removeEventListener("offline",this.uo)}ho(){window.addEventListener("online",this._o),window.addEventListener("offline",this.uo)}ao(){k("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.lo)e(0)}co(){k("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.lo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Yu=null;function im(){return Yu===null?Yu=function(){return 268435456+Math.round(2147483648*Math.random())}():Yu++,"0x"+Yu.toString(16)}var vV={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var vg=class{constructor(e){this.Po=e.Po,this.Io=e.Io}To(e){this.Eo=e}Ao(e){this.Ro=e}Vo(e){this.mo=e}onMessage(e){this.fo=e}close(){this.Io()}send(e){this.Po(e)}po(){this.Eo()}yo(){this.Ro()}wo(e){this.mo(e)}So(e){this.fo(e)}};var rt="WebChannelConnection",_g=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.bo=r+"://"+t.host,this.Do=`projects/${i}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${o}`}get vo(){return!1}Fo(t,r,i,o,s){let a=im(),u=this.Mo(t,r.toUriEncodedString());k("RestConnection",`Sending RPC '${t}' ${a}:`,u,i);let l={"google-cloud-resource-prefix":this.Do,"x-goog-request-params":this.Co};return this.xo(l,o,s),this.Oo(t,u,l,i).then(h=>(k("RestConnection",`Received RPC '${t}' ${a}: `,h),h),h=>{throw wt("RestConnection",`RPC '${t}' ${a} failed with error: `,h,"url: ",u,"request:",i),h})}No(t,r,i,o,s,a){return this.Fo(t,r,i,o,s)}xo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+No}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,s)=>t[s]=o),i&&i.headers.forEach((o,s)=>t[s]=o)}Mo(t,r){let i=vV[t];return`${this.bo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Oo(e,t,r,i){let o=im();return new Promise((s,a)=>{let u=new Qp;u.setWithCredentials(!0),u.listenOnce(Jp.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Os.NO_ERROR:let h=u.getResponseJson();k(rt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(h)),s(h);break;case Os.TIMEOUT:k(rt,`RPC '${e}' ${o} timed out`),a(new M(N.DEADLINE_EXCEEDED,"Request time out"));break;case Os.HTTP_ERROR:let p=u.getStatus();if(k(rt,`RPC '${e}' ${o} failed with status:`,p,"response text:",u.getResponseText()),p>0){let g=u.getResponseJson();Array.isArray(g)&&(g=g[0]);let y=g?.error;if(y&&y.status&&y.message){let D=function(P){let O=P.toLowerCase().replace(/_/g,"-");return Object.values(N).indexOf(O)>=0?O:N.UNKNOWN}(y.status);a(new M(D,y.message))}else a(new M(N.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new M(N.UNAVAILABLE,"Connection failed."));break;default:$()}}finally{k(rt,`RPC '${e}' ${o} completed.`)}});let l=JSON.stringify(i);k(rt,`RPC '${e}' ${o} sending request:`,i),u.send(t,"POST",l,r,15)})}Lo(e,t,r){let i=im(),o=[this.bo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=em(),a=Xp(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(u.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(u.xmlHttpFactory=new Yp({})),this.xo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;let h=o.join("");k(rt,`Creating RPC '${e}' stream ${i}: ${h}`,u);let p=s.createWebChannel(h,u),g=!1,y=!1,D=new vg({Po:P=>{y?k(rt,`Not sending because RPC '${e}' stream ${i} is closed:`,P):(g||(k(rt,`Opening RPC '${e}' stream ${i} transport.`),p.open(),g=!0),k(rt,`RPC '${e}' stream ${i} sending:`,P),p.send(P))},Io:()=>p.close()}),R=(P,O,B)=>{P.listen(O,U=>{try{B(U)}catch(G){setTimeout(()=>{throw G},0)}})};return R(p,Yi.EventType.OPEN,()=>{y||(k(rt,`RPC '${e}' stream ${i} transport opened.`),D.po())}),R(p,Yi.EventType.CLOSE,()=>{y||(y=!0,k(rt,`RPC '${e}' stream ${i} transport closed`),D.wo())}),R(p,Yi.EventType.ERROR,P=>{y||(y=!0,wt(rt,`RPC '${e}' stream ${i} transport errored:`,P),D.wo(new M(N.UNAVAILABLE,"The operation could not be completed")))}),R(p,Yi.EventType.MESSAGE,P=>{var O;if(!y){let B=P.data[0];q(!!B);let U=B,G=U.error||((O=U[0])===null||O===void 0?void 0:O.error);if(G){k(rt,`RPC '${e}' stream ${i} received error:`,G);let te=G.status,H=function(_){let T=Le[_];if(T!==void 0)return OC(T)}(te),E=G.message;H===void 0&&(H=N.INTERNAL,E="Unknown error status: "+te+" with message "+G.message),y=!0,D.wo(new M(H,E)),p.close()}else k(rt,`RPC '${e}' stream ${i} received:`,B),D.So(B)}}),R(a,Zp.STAT_EVENT,P=>{P.stat===Gu.PROXY?k(rt,`RPC '${e}' stream ${i} detected buffering proxy`):P.stat===Gu.NOPROXY&&k(rt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{D.yo()},0),D}};function lD(){return typeof window<"u"?window:null}function rl(){return typeof document<"u"?document:null}function wa(n){return new Om(n,!0)}var ua=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.ai=e,this.timerId=t,this.Bo=r,this.ko=i,this.qo=o,this.Qo=0,this.Ko=null,this.$o=Date.now(),this.reset()}reset(){this.Qo=0}Uo(){this.Qo=this.qo}Wo(e){this.cancel();let t=Math.floor(this.Qo+this.Go()),r=Math.max(0,Date.now()-this.$o),i=Math.max(0,t-r);i>0&&k("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Qo} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.Ko=this.ai.enqueueAfterDelay(this.timerId,i,()=>(this.$o=Date.now(),e())),this.Qo*=this.ko,this.Qo<this.Bo&&(this.Qo=this.Bo),this.Qo>this.qo&&(this.Qo=this.qo)}zo(){this.Ko!==null&&(this.Ko.skipDelay(),this.Ko=null)}cancel(){this.Ko!==null&&(this.Ko.cancel(),this.Ko=null)}Go(){return(Math.random()-.5)*this.Qo}};var Bl=class{constructor(e,t,r,i,o,s,a,u){this.ai=e,this.jo=r,this.Ho=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.Jo=0,this.Yo=null,this.Zo=null,this.stream=null,this.Xo=0,this.e_=new ua(e,t)}t_(){return this.state===1||this.state===5||this.n_()}n_(){return this.state===2||this.state===3}start(){this.Xo=0,this.state!==4?this.auth():this.r_()}stop(){return w(this,null,function*(){this.t_()&&(yield this.close(0))})}i_(){this.state=0,this.e_.reset()}s_(){this.n_()&&this.Yo===null&&(this.Yo=this.ai.enqueueAfterDelay(this.jo,6e4,()=>this.o_()))}__(e){this.a_(),this.stream.send(e)}o_(){return w(this,null,function*(){if(this.n_())return this.close(0)})}a_(){this.Yo&&(this.Yo.cancel(),this.Yo=null)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}close(e,t){return w(this,null,function*(){this.a_(),this.u_(),this.e_.cancel(),this.Jo++,e!==4?this.e_.reset():t&&t.code===N.RESOURCE_EXHAUSTED?(Ne(t.toString()),Ne("Using maximum backoff delay to prevent overloading the backend."),this.e_.Uo()):t&&t.code===N.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.c_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Vo(t)})}c_(){}auth(){this.state=1;let e=this.l_(this.Jo),t=this.Jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Jo===t&&this.h_(r,i)},r=>{e(()=>{let i=new M(N.UNKNOWN,"Fetching auth token failed: "+r.message);return this.P_(i)})})}h_(e,t){let r=this.l_(this.Jo);this.stream=this.I_(e,t),this.stream.To(()=>{r(()=>this.listener.To())}),this.stream.Ao(()=>{r(()=>(this.state=2,this.Zo=this.ai.enqueueAfterDelay(this.Ho,1e4,()=>(this.n_()&&(this.state=3),Promise.resolve())),this.listener.Ao()))}),this.stream.Vo(i=>{r(()=>this.P_(i))}),this.stream.onMessage(i=>{r(()=>++this.Xo==1?this.T_(i):this.onNext(i))})}r_(){this.state=5,this.e_.Wo(()=>w(this,null,function*(){this.state=0,this.start()}))}P_(e){return k("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}l_(e){return t=>{this.ai.enqueueAndForget(()=>this.Jo===e?t():(k("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Ig=class extends Bl{constructor(e,t,r,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}I_(e,t){return this.connection.Lo("Listen",e,t)}T_(e){return this.onNext(e)}onNext(e){this.e_.reset();let t=rV(this.serializer,e),r=function(o){if(!("targetChange"in o))return z.min();let s=o.targetChange;return s.targetIds&&s.targetIds.length?z.min():s.readTime?Pe(s.readTime):z.min()}(e);return this.listener.E_(t,r)}d_(e){let t={};t.database=Fm(this.serializer),t.addTarget=function(o,s){let a,u=s.target;if(a=ml(u)?{documents:qC(o,u)}:{query:sd(o,u)._t},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=VC(o,s.resumeToken);let l=Lm(o,s.expectedCount);l!==null&&(a.expectedCount=l)}else if(s.snapshotVersion.compareTo(z.min())>0){a.readTime=yo(o,s.snapshotVersion.toTimestamp());let l=Lm(o,s.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,e);let r=oV(this.serializer,e);r&&(t.labels=r),this.__(t)}A_(e){let t={};t.database=Fm(this.serializer),t.removeTarget=e,this.__(t)}},wg=class extends Bl{constructor(e,t,r,i,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}get R_(){return this.Xo>0}start(){this.lastStreamToken=void 0,super.start()}c_(){this.R_&&this.V_([])}I_(e,t){return this.connection.Lo("Write",e,t)}T_(e){return q(!!e.streamToken),this.lastStreamToken=e.streamToken,q(!e.writeResults||e.writeResults.length===0),this.listener.m_()}onNext(e){q(!!e.streamToken),this.lastStreamToken=e.streamToken,this.e_.reset();let t=iV(e.writeResults,e.commitTime),r=Pe(e.commitTime);return this.listener.f_(r,t)}g_(){let e={};e.database=Fm(this.serializer),this.__(e)}V_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>ia(this.serializer,r))};this.__(t)}};var Eg=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.p_=!1}y_(){if(this.p_)throw new M(N.FAILED_PRECONDITION,"The client has already been terminated.")}Fo(e,t,r,i){return this.y_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Fo(e,Vm(t,r),i,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new M(N.UNKNOWN,o.toString())})}No(e,t,r,i,o){return this.y_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.No(e,Vm(t,r),i,s,a,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new M(N.UNKNOWN,s.toString())})}terminate(){this.p_=!0,this.connection.terminate()}},Tg=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.w_=0,this.S_=null,this.b_=!0}D_(){this.w_===0&&(this.C_("Unknown"),this.S_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.S_=null,this.v_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}F_(e){this.state==="Online"?this.C_("Unknown"):(this.w_++,this.w_>=1&&(this.M_(),this.v_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.M_(),this.w_=0,e==="Online"&&(this.b_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}v_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.b_?(Ne(t),this.b_=!1):k("OnlineStateTracker",t)}M_(){this.S_!==null&&(this.S_.cancel(),this.S_=null)}};var bg=class{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.x_=[],this.O_=new Map,this.N_=new Set,this.L_=[],this.B_=o,this.B_.oo(s=>{r.enqueueAndForget(()=>w(this,null,function*(){gr(this)&&(k("RemoteStore","Restarting streams for network reachability change."),yield function(u){return w(this,null,function*(){let l=V(u);l.N_.add(4),yield Ro(l),l.k_.set("Unknown"),l.N_.delete(4),yield Ea(l)})}(this))}))}),this.k_=new Tg(r,i)}};function Ea(n){return w(this,null,function*(){if(gr(n))for(let e of n.L_)yield e(!0)})}function Ro(n){return w(this,null,function*(){for(let e of n.L_)yield e(!1)})}function ad(n,e){let t=V(n);t.O_.has(e.targetId)||(t.O_.set(e.targetId,e),by(t)?Ty(t):Mo(t).n_()&&Ey(t,e))}function Eo(n,e){let t=V(n),r=Mo(t);t.O_.delete(e),r.n_()&&dD(t,e),t.O_.size===0&&(r.n_()?r.s_():gr(t)&&t.k_.set("Unknown"))}function Ey(n,e){if(n.q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(z.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Mo(n).d_(e)}function dD(n,e){n.q_.xe(e),Mo(n).A_(e)}function Ty(n){n.q_=new km({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.O_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Mo(n).start(),n.k_.D_()}function by(n){return gr(n)&&!Mo(n).t_()&&n.O_.size>0}function gr(n){return V(n).N_.size===0}function hD(n){n.q_=void 0}function _V(n){return w(this,null,function*(){n.k_.set("Online")})}function IV(n){return w(this,null,function*(){n.O_.forEach((e,t)=>{Ey(n,e)})})}function wV(n,e){return w(this,null,function*(){hD(n),by(n)?(n.k_.F_(e),Ty(n)):n.k_.set("Unknown")})}function EV(n,e,t){return w(this,null,function*(){if(n.k_.set("Online"),e instanceof wl&&e.state===2&&e.cause)try{yield function(i,o){return w(this,null,function*(){let s=o.cause;for(let a of o.targetIds)i.O_.has(a)&&(yield i.remoteSyncer.rejectListen(a,s),i.O_.delete(a),i.q_.removeTarget(a))})}(n,e)}catch(r){k("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield $l(n,r)}else if(e instanceof ao?n.q_.Ke(e):e instanceof Il?n.q_.He(e):n.q_.We(e),!t.isEqual(z.min()))try{let r=yield oD(n.localStore);t.compareTo(r)>=0&&(yield function(o,s){let a=o.q_.rt(s);return a.targetChanges.forEach((u,l)=>{if(u.resumeToken.approximateByteSize()>0){let h=o.O_.get(l);h&&o.O_.set(l,h.withResumeToken(u.resumeToken,s))}}),a.targetMismatches.forEach((u,l)=>{let h=o.O_.get(u);if(!h)return;o.O_.set(u,h.withResumeToken(ke.EMPTY_BYTE_STRING,h.snapshotVersion)),dD(o,u);let p=new vo(h.target,u,l,h.sequenceNumber);Ey(o,p)}),o.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){k("RemoteStore","Failed to raise snapshot:",r),yield $l(n,r)}})}function $l(n,e,t){return w(this,null,function*(){if(!pr(e))throw e;n.N_.add(1),yield Ro(n),n.k_.set("Offline"),t||(t=()=>oD(n.localStore)),n.asyncQueue.enqueueRetryable(()=>w(this,null,function*(){k("RemoteStore","Retrying IndexedDB access"),yield t(),n.N_.delete(1),yield Ea(n)}))})}function fD(n,e){return e().catch(t=>$l(n,t,e))}function Po(n){return w(this,null,function*(){let e=V(n),t=cr(e),r=e.x_.length>0?e.x_[e.x_.length-1].batchId:-1;for(;TV(e);)try{let i=yield mV(e.localStore,r);if(i===null){e.x_.length===0&&t.s_();break}r=i.batchId,bV(e,i)}catch(i){yield $l(e,i)}pD(e)&&mD(e)})}function TV(n){return gr(n)&&n.x_.length<10}function bV(n,e){n.x_.push(e);let t=cr(n);t.n_()&&t.R_&&t.V_(e.mutations)}function pD(n){return gr(n)&&!cr(n).t_()&&n.x_.length>0}function mD(n){cr(n).start()}function CV(n){return w(this,null,function*(){cr(n).g_()})}function DV(n){return w(this,null,function*(){let e=cr(n);for(let t of n.x_)e.V_(t.mutations)})}function SV(n,e,t){return w(this,null,function*(){let r=n.x_.shift(),i=Rm.from(r,e,t);yield fD(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Po(n)})}function AV(n,e){return w(this,null,function*(){e&&cr(n).R_&&(yield function(r,i){return w(this,null,function*(){if(function(s){return kC(s)&&s!==N.ABORTED}(i.code)){let o=r.x_.shift();cr(r).i_(),yield fD(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield Po(r)}})}(n,e)),pD(n)&&mD(n)})}function Lb(n,e){return w(this,null,function*(){let t=V(n);t.asyncQueue.verifyOperationInProgress(),k("RemoteStore","RemoteStore received new credentials");let r=gr(t);t.N_.add(3),yield Ro(t),r&&t.k_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.N_.delete(3),yield Ea(t)})}function Cg(n,e){return w(this,null,function*(){let t=V(n);e?(t.N_.delete(2),yield Ea(t)):e||(t.N_.add(2),yield Ro(t),t.k_.set("Unknown"))})}function Mo(n){return n.Q_||(n.Q_=function(t,r,i){let o=V(t);return o.y_(),new Ig(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{To:_V.bind(null,n),Ao:IV.bind(null,n),Vo:wV.bind(null,n),E_:EV.bind(null,n)}),n.L_.push(e=>w(this,null,function*(){e?(n.Q_.i_(),by(n)?Ty(n):n.k_.set("Unknown")):(yield n.Q_.stop(),hD(n))}))),n.Q_}function cr(n){return n.K_||(n.K_=function(t,r,i){let o=V(t);return o.y_(),new wg(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{To:()=>Promise.resolve(),Ao:CV.bind(null,n),Vo:AV.bind(null,n),m_:DV.bind(null,n),f_:SV.bind(null,n)}),n.L_.push(e=>w(this,null,function*(){e?(n.K_.i_(),yield Po(n)):(yield n.K_.stop(),n.x_.length>0&&(k("RemoteStore",`Stopping write stream with ${n.x_.length} pending writes`),n.x_=[]))}))),n.K_}var Dg=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new xe,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let s=Date.now()+r,a=new n(e,t,s,i,o);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new M(N.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function ko(n,e){if(Ne("AsyncQueue",`${e}: ${n}`),pr(n))return new M(N.UNAVAILABLE,`${e}: ${n}`);throw n}var ql=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||j.comparator(t.key,r.key):(t,r)=>j.comparator(t.key,r.key),this.keyedMap=Us(),this.sortedSet=new Ee(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Hl=class{constructor(){this.U_=new Ee(j.comparator)}track(e){let t=e.doc.key,r=this.U_.get(t);r?e.type!==0&&r.type===3?this.U_=this.U_.insert(t,e):e.type===3&&r.type!==1?this.U_=this.U_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.U_=this.U_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.U_=this.U_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.U_=this.U_.remove(t):e.type===1&&r.type===2?this.U_=this.U_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.U_=this.U_.insert(t,{type:2,doc:e.doc}):$():this.U_=this.U_.insert(t,e)}W_(){let e=[];return this.U_.inorderTraversal((t,r)=>{e.push(r)}),e}},To=class n{constructor(e,t,r,i,o,s,a,u,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,o){let s=[];return t.forEach(a=>{s.push({type:0,doc:a})}),new n(e,t,ql.emptySet(t),s,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&_a(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var Sg=class{constructor(){this.G_=void 0,this.z_=[]}j_(){return this.z_.some(e=>e.H_())}},Ag=class{constructor(){this.queries=Vb(),this.onlineState="Unknown",this.J_=new Set}terminate(){(function(t,r){let i=V(t),o=i.queries;i.queries=Vb(),o.forEach((s,a)=>{for(let u of a.z_)u.onError(r)})})(this,new M(N.ABORTED,"Firestore shutting down"))}};function Vb(){return new Vt(n=>_C(n),_a)}function Cy(n,e){return w(this,null,function*(){let t=V(n),r=3,i=e.query,o=t.queries.get(i);o?!o.j_()&&e.H_()&&(r=2):(o=new Sg,r=e.H_()?0:1);try{switch(r){case 0:o.G_=yield t.onListen(i,!0);break;case 1:o.G_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(s){let a=ko(s,`Initialization of query '${no(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,o),o.z_.push(e),e.Y_(t.onlineState),o.G_&&e.Z_(o.G_)&&Sy(t)})}function Dy(n,e){return w(this,null,function*(){let t=V(n),r=e.query,i=3,o=t.queries.get(r);if(o){let s=o.z_.indexOf(e);s>=0&&(o.z_.splice(s,1),o.z_.length===0?i=e.H_()?0:1:!o.j_()&&e.H_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function NV(n,e){let t=V(n),r=!1;for(let i of e){let o=i.query,s=t.queries.get(o);if(s){for(let a of s.z_)a.Z_(i)&&(r=!0);s.G_=i}}r&&Sy(t)}function xV(n,e,t){let r=V(n),i=r.queries.get(e);if(i)for(let o of i.z_)o.onError(t);r.queries.delete(e)}function Sy(n){n.J_.forEach(e=>{e.next()})}var Ng,Fb;(Fb=Ng||(Ng={})).X_="default",Fb.Cache="cache";var la=class{constructor(e,t,r){this.query=e,this.ea=t,this.ta=!1,this.na=null,this.onlineState="Unknown",this.options=r||{}}Z_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new To(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ta?this.ra(e)&&(this.ea.next(e),t=!0):this.ia(e,this.onlineState)&&(this.sa(e),t=!0),this.na=e,t}onError(e){this.ea.error(e)}Y_(e){this.onlineState=e;let t=!1;return this.na&&!this.ta&&this.ia(this.na,e)&&(this.sa(this.na),t=!0),t}ia(e,t){if(!e.fromCache||!this.H_())return!0;let r=t!=="Offline";return(!this.options.oa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ra(e){if(e.docChanges.length>0)return!0;let t=this.na&&this.na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}sa(e){e=To.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ta=!0,this.ea.next(e)}H_(){return this.options.source!==Ng.Cache}};var xg=class{constructor(e,t){this._a=e,this.byteLength=t}aa(){return"metadata"in this._a}};var zl=class{constructor(e){this.serializer=e}Ts(e){return Zt(this.serializer,e)}Es(e){return e.metadata.exists?$C(this.serializer,e.document,!1):Ue.newNoDocument(this.Ts(e.metadata.name),this.ds(e.metadata.readTime))}ds(e){return Pe(e)}},Rg=class{constructor(e,t,r){this.ua=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=gD(e)}ca(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e._a.namedQuery)this.queries.push(e._a.namedQuery);else if(e._a.documentMetadata){this.documents.push({metadata:e._a.documentMetadata}),e._a.documentMetadata.exists||++t;let r=ce.fromString(e._a.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e._a.document&&(this.documents[this.documents.length-1].document=e._a.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}la(e){let t=new Map,r=new zl(this.serializer);for(let i of e)if(i.metadata.queries){let o=r.Ts(i.metadata.name);for(let s of i.metadata.queries){let a=(t.get(s)||J()).add(o);t.set(s,a)}}return t}complete(){return w(this,null,function*(){let e=yield gV(this.localStore,new zl(this.serializer),this.documents,this.ua.id),t=this.la(this.documents);for(let r of this.queries)yield yV(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,ha:this.collectionGroups,Pa:e}})}};function gD(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var Gl=class{constructor(e){this.key=e}},Wl=class{constructor(e){this.key=e}},Kl=class{constructor(e,t){this.query=e,this.Ia=t,this.Ta=null,this.hasCachedResults=!1,this.current=!1,this.Ea=J(),this.mutatedKeys=J(),this.da=wC(e),this.Aa=new ql(this.da)}get Ra(){return this.Ia}Va(e,t){let r=t?t.ma:new Hl,i=t?t.Aa:this.Aa,o=t?t.mutatedKeys:this.mutatedKeys,s=i,a=!1,u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,p)=>{let g=i.get(h),y=Ia(this.query,p)?p:null,D=!!g&&this.mutatedKeys.has(g.key),R=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations),P=!1;g&&y?g.data.isEqual(y.data)?D!==R&&(r.track({type:3,doc:y}),P=!0):this.fa(g,y)||(r.track({type:2,doc:y}),P=!0,(u&&this.da(y,u)>0||l&&this.da(y,l)<0)&&(a=!0)):!g&&y?(r.track({type:0,doc:y}),P=!0):g&&!y&&(r.track({type:1,doc:g}),P=!0,(u||l)&&(a=!0)),P&&(y?(s=s.add(y),o=R?o.add(h):o.delete(h)):(s=s.delete(h),o=o.delete(h)))}),this.query.limit!==null)for(;s.size>this.query.limit;){let h=this.query.limitType==="F"?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{Aa:s,ma:r,ts:a,mutatedKeys:o}}fa(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let o=this.Aa;this.Aa=e.Aa,this.mutatedKeys=e.mutatedKeys;let s=e.ma.W_();s.sort((h,p)=>function(y,D){let R=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return $()}};return R(y)-R(D)}(h.type,p.type)||this.da(h.doc,p.doc)),this.ga(r),i=i!=null&&i;let a=t&&!i?this.pa():[],u=this.Ea.size===0&&this.current&&!i?1:0,l=u!==this.Ta;return this.Ta=u,s.length!==0||l?{snapshot:new To(this.query,e.Aa,o,s,e.mutatedKeys,u===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),ya:a}:{ya:a}}Y_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Aa:this.Aa,ma:new Hl,mutatedKeys:this.mutatedKeys,ts:!1},!1)):{ya:[]}}wa(e){return!this.Ia.has(e)&&!!this.Aa.has(e)&&!this.Aa.get(e).hasLocalMutations}ga(e){e&&(e.addedDocuments.forEach(t=>this.Ia=this.Ia.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ia=this.Ia.delete(t)),this.current=e.current)}pa(){if(!this.current)return[];let e=this.Ea;this.Ea=J(),this.Aa.forEach(r=>{this.wa(r.key)&&(this.Ea=this.Ea.add(r.key))});let t=[];return e.forEach(r=>{this.Ea.has(r)||t.push(new Wl(r))}),this.Ea.forEach(r=>{e.has(r)||t.push(new Gl(r))}),t}Sa(e){this.Ia=e.Is,this.Ea=J();let t=this.Va(e.documents);return this.applyChanges(t,!0)}ba(){return To.fromInitialDocuments(this.query,this.Aa,this.mutatedKeys,this.Ta===0,this.hasCachedResults)}},Pg=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},Mg=class{constructor(e){this.key=e,this.Da=!1}},kg=class{constructor(e,t,r,i,o,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Ca={},this.va=new Vt(a=>_C(a),_a),this.Fa=new Map,this.Ma=new Set,this.xa=new Ee(j.comparator),this.Oa=new Map,this.Na=new sa,this.La={},this.Ba=new Map,this.ka=_o.Bn(),this.onlineState="Unknown",this.qa=void 0}get isPrimaryClient(){return this.qa===!0}};function RV(n,e,t=!0){return w(this,null,function*(){let r=cd(n),i,o=r.va.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.ba()):i=yield yD(r,e,t,!0),i})}function PV(n,e){return w(this,null,function*(){let t=cd(n);yield yD(t,e,!0,!1)})}function yD(n,e,t,r){return w(this,null,function*(){let i=yield Io(n.localStore,st(e)),o=i.targetId,s=t?n.sharedClientState.addLocalQueryTarget(o):"not-current",a;return r&&(a=yield Ay(n,e,o,s==="current",i.resumeToken)),n.isPrimaryClient&&t&&ad(n.remoteStore,i),a})}function Ay(n,e,t,r,i){return w(this,null,function*(){n.Qa=(p,g,y)=>function(R,P,O,B){return w(this,null,function*(){let U=P.view.Va(O);U.ts&&(U=yield Ll(R.localStore,P.query,!1).then(({documents:E})=>P.view.Va(E,U)));let G=B&&B.targetChanges.get(P.targetId),te=B&&B.targetMismatches.get(P.targetId)!=null,H=P.view.applyChanges(U,R.isPrimaryClient,G,te);return Og(R,P.targetId,H.ya),H.snapshot})}(n,p,g,y);let o=yield Ll(n.localStore,e,!0),s=new Kl(e,o.Is),a=s.Va(o.documents),u=na.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=s.applyChanges(a,n.isPrimaryClient,u);Og(n,t,l.ya);let h=new Pg(e,t,s);return n.va.set(e,h),n.Fa.has(t)?n.Fa.get(t).push(e):n.Fa.set(t,[e]),l.snapshot})}function MV(n,e,t){return w(this,null,function*(){let r=V(n),i=r.va.get(e),o=r.Fa.get(i.targetId);if(o.length>1)return r.Fa.set(i.targetId,o.filter(s=>!_a(s,e))),void r.va.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield wo(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Eo(r.remoteStore,i.targetId),bo(r,i.targetId)}).catch(fr))):(bo(r,i.targetId),yield wo(r.localStore,i.targetId,!0))})}function kV(n,e){return w(this,null,function*(){let t=V(n),r=t.va.get(e),i=t.Fa.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Eo(t.remoteStore,r.targetId))})}function OV(n,e,t){return w(this,null,function*(){let r=Py(n);try{let i=yield function(s,a){let u=V(s),l=Re.now(),h=a.reduce((y,D)=>y.add(D.key),J()),p,g;return u.persistence.runTransaction("Locally write mutations","readwrite",y=>{let D=mt(),R=J();return u.us.getEntries(y,h).next(P=>{D=P,D.forEach((O,B)=>{B.isValidDocument()||(R=R.add(O))})}).next(()=>u.localDocuments.getOverlayedDocuments(y,D)).next(P=>{p=P;let O=[];for(let B of a){let U=YL(B,p.get(B.key).overlayedDocument);U!=null&&O.push(new Ft(B.key,U,lC(U.value.mapValue),Ae.exists(!0)))}return u.mutationQueue.addMutationBatch(y,l,O,a)}).next(P=>{g=P;let O=P.applyToLocalDocumentSet(p,R);return u.documentOverlayCache.saveOverlays(y,P.batchId,O)})}).then(()=>({batchId:g.batchId,changes:TC(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(s,a,u){let l=s.La[s.currentUser.toKey()];l||(l=new Ee(K)),l=l.insert(a,u),s.La[s.currentUser.toKey()]=l}(r,i.batchId,t),yield bn(r,i.changes),yield Po(r.remoteStore)}catch(i){let o=ko(i,"Failed to persist write");t.reject(o)}})}function vD(n,e){return w(this,null,function*(){let t=V(n);try{let r=yield pV(t.localStore,e);e.targetChanges.forEach((i,o)=>{let s=t.Oa.get(o);s&&(q(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?s.Da=!0:i.modifiedDocuments.size>0?q(s.Da):i.removedDocuments.size>0&&(q(s.Da),s.Da=!1))}),yield bn(t,r,e)}catch(r){yield fr(r)}})}function jb(n,e,t){let r=V(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.va.forEach((o,s)=>{let a=s.view.Y_(e);a.snapshot&&i.push(a.snapshot)}),function(s,a){let u=V(s);u.onlineState=a;let l=!1;u.queries.forEach((h,p)=>{for(let g of p.z_)g.Y_(a)&&(l=!0)}),l&&Sy(u)}(r.eventManager,e),i.length&&r.Ca.E_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function LV(n,e,t){return w(this,null,function*(){let r=V(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Oa.get(e),o=i&&i.key;if(o){let s=new Ee(j.comparator);s=s.insert(o,Ue.newNoDocument(o,z.min()));let a=J().add(o),u=new ta(z.min(),new Map,new Ee(K),s,a);yield vD(r,u),r.xa=r.xa.remove(o),r.Oa.delete(e),Ry(r)}else yield wo(r.localStore,e,!1).then(()=>bo(r,e,t)).catch(fr)})}function VV(n,e){return w(this,null,function*(){let t=V(n),r=e.batch.batchId;try{let i=yield fV(t.localStore,e);xy(t,r,null),Ny(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield bn(t,i)}catch(i){yield fr(i)}})}function FV(n,e,t){return w(this,null,function*(){let r=V(n);try{let i=yield function(s,a){let u=V(s);return u.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let h;return u.mutationQueue.lookupMutationBatch(l,a).next(p=>(q(p!==null),h=p.keys(),u.mutationQueue.removeMutationBatch(l,p))).next(()=>u.mutationQueue.performConsistencyCheck(l)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(l,h,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,h)).next(()=>u.localDocuments.getDocuments(l,h))})}(r.localStore,e);xy(r,e,t),Ny(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield bn(r,i)}catch(i){yield fr(i)}})}function jV(n,e){return w(this,null,function*(){let t=V(n);gr(t.remoteStore)||k("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(s){let a=V(s);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",u=>a.mutationQueue.getHighestUnacknowledgedBatchId(u))}(t.localStore);if(r===-1)return void e.resolve();let i=t.Ba.get(r)||[];i.push(e),t.Ba.set(r,i)}catch(r){let i=ko(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function Ny(n,e){(n.Ba.get(e)||[]).forEach(t=>{t.resolve()}),n.Ba.delete(e)}function xy(n,e,t){let r=V(n),i=r.La[r.currentUser.toKey()];if(i){let o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.La[r.currentUser.toKey()]=i}}function bo(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Fa.get(e))n.va.delete(r),t&&n.Ca.Ka(r,t);n.Fa.delete(e),n.isPrimaryClient&&n.Na.mr(e).forEach(r=>{n.Na.containsKey(r)||_D(n,r)})}function _D(n,e){n.Ma.delete(e.path.canonicalString());let t=n.xa.get(e);t!==null&&(Eo(n.remoteStore,t),n.xa=n.xa.remove(e),n.Oa.delete(t),Ry(n))}function Og(n,e,t){for(let r of t)r instanceof Gl?(n.Na.addReference(r.key,e),UV(n,r)):r instanceof Wl?(k("SyncEngine","Document no longer in limbo: "+r.key),n.Na.removeReference(r.key,e),n.Na.containsKey(r.key)||_D(n,r.key)):$()}function UV(n,e){let t=e.key,r=t.path.canonicalString();n.xa.get(t)||n.Ma.has(r)||(k("SyncEngine","New document in limbo: "+t),n.Ma.add(r),Ry(n))}function Ry(n){for(;n.Ma.size>0&&n.xa.size<n.maxConcurrentLimboResolutions;){let e=n.Ma.values().next().value;n.Ma.delete(e);let t=new j(ce.fromString(e)),r=n.ka.next();n.Oa.set(r,new Mg(t)),n.xa=n.xa.insert(t,r),ad(n.remoteStore,new vo(st(xo(t.path)),r,"TargetPurposeLimboResolution",_t.oe))}}function bn(n,e,t){return w(this,null,function*(){let r=V(n),i=[],o=[],s=[];r.va.isEmpty()||(r.va.forEach((a,u)=>{s.push(r.Qa(u,e,t).then(l=>{var h;if((l||t)&&r.isPrimaryClient){let p=l?!l.fromCache:(h=t?.targetChanges.get(u.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(u.targetId,p?"current":"not-current")}if(l){i.push(l);let p=fg.Ui(u.targetId,l);o.push(p)}}))}),yield Promise.all(s),r.Ca.E_(i),yield function(u,l){return w(this,null,function*(){let h=V(u);try{yield h.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>A.forEach(l,g=>A.forEach(g.Ki,y=>h.persistence.referenceDelegate.addReference(p,g.targetId,y)).next(()=>A.forEach(g.$i,y=>h.persistence.referenceDelegate.removeReference(p,g.targetId,y)))))}catch(p){if(!pr(p))throw p;k("LocalStore","Failed to update sequence numbers: "+p)}for(let p of l){let g=p.targetId;if(!p.fromCache){let y=h.ss.get(g),D=y.snapshotVersion,R=y.withLastLimboFreeSnapshotVersion(D);h.ss=h.ss.insert(g,R)}}})}(r.localStore,o))})}function BV(n,e){return w(this,null,function*(){let t=V(n);if(!t.currentUser.isEqual(e)){k("SyncEngine","User change. New user:",e.toKey());let r=yield iD(t.localStore,e);t.currentUser=e,function(o,s){o.Ba.forEach(a=>{a.forEach(u=>{u.reject(new M(N.CANCELLED,s))})}),o.Ba.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield bn(t,r.ls)}})}function $V(n,e){let t=V(n),r=t.Oa.get(e);if(r&&r.Da)return J().add(r.key);{let i=J(),o=t.Fa.get(e);if(!o)return i;for(let s of o){let a=t.va.get(s);i=i.unionWith(a.view.Ra)}return i}}function qV(n,e){return w(this,null,function*(){let t=V(n),r=yield Ll(t.localStore,e.query,!0),i=e.view.Sa(r);return t.isPrimaryClient&&Og(t,e.targetId,i.ya),i})}function HV(n,e){return w(this,null,function*(){let t=V(n);return cD(t.localStore,e).then(r=>bn(t,r))})}function zV(n,e,t,r){return w(this,null,function*(){let i=V(n),o=yield function(a,u){let l=V(a),h=V(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",p=>h.Fn(p,u).next(g=>g?l.localDocuments.getDocuments(p,g):A.resolve(null)))}(i.localStore,e);o!==null?(t==="pending"?yield Po(i.remoteStore):t==="acknowledged"||t==="rejected"?(xy(i,e,r||null),Ny(i,e),function(a,u){V(V(a).mutationQueue).xn(u)}(i.localStore,e)):$(),yield bn(i,o)):k("SyncEngine","Cannot apply mutation batch with id: "+e)})}function GV(n,e){return w(this,null,function*(){let t=V(n);if(cd(t),Py(t),e===!0&&t.qa!==!0){let r=t.sharedClientState.getAllActiveQueryTargets(),i=yield Ub(t,r.toArray());t.qa=!0,yield Cg(t.remoteStore,!0);for(let o of i)ad(t.remoteStore,o)}else if(e===!1&&t.qa!==!1){let r=[],i=Promise.resolve();t.Fa.forEach((o,s)=>{t.sharedClientState.isLocalQueryTarget(s)?r.push(s):i=i.then(()=>(bo(t,s),wo(t.localStore,s,!0))),Eo(t.remoteStore,s)}),yield i,yield Ub(t,r),function(s){let a=V(s);a.Oa.forEach((u,l)=>{Eo(a.remoteStore,l)}),a.Na.gr(),a.Oa=new Map,a.xa=new Ee(j.comparator)}(t),t.qa=!1,yield Cg(t.remoteStore,!1)}})}function Ub(n,e,t){return w(this,null,function*(){let r=V(n),i=[],o=[];for(let s of e){let a,u=r.Fa.get(s);if(u&&u.length!==0){a=yield Io(r.localStore,st(u[0]));for(let l of u){let h=r.va.get(l),p=yield qV(r,h);p.snapshot&&o.push(p.snapshot)}}else{let l=yield aD(r.localStore,s);a=yield Io(r.localStore,l),yield Ay(r,ID(l),s,!1,a.resumeToken)}i.push(a)}return r.Ca.E_(o),i})}function ID(n){return gC(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function WV(n){return function(t){return V(V(t).persistence).qi()}(V(n).localStore)}function KV(n,e,t,r){return w(this,null,function*(){let i=V(n);if(i.qa)return void k("SyncEngine","Ignoring unexpected query state notification.");let o=i.Fa.get(e);if(o&&o.length>0)switch(t){case"current":case"not-current":{let s=yield cD(i.localStore,IC(o[0])),a=ta.createSynthesizedRemoteEventForCurrentChange(e,t==="current",ke.EMPTY_BYTE_STRING);yield bn(i,s,a);break}case"rejected":yield wo(i.localStore,e,!0),bo(i,e,r);break;default:$()}})}function QV(n,e,t){return w(this,null,function*(){let r=cd(n);if(r.qa){for(let i of e){if(r.Fa.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){k("SyncEngine","Adding an already active target "+i);continue}let o=yield aD(r.localStore,i),s=yield Io(r.localStore,o);yield Ay(r,ID(o),s.targetId,!1,s.resumeToken),ad(r.remoteStore,s)}for(let i of t)r.Fa.has(i)&&(yield wo(r.localStore,i,!1).then(()=>{Eo(r.remoteStore,i),bo(r,i)}).catch(fr))}})}function cd(n){let e=V(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=vD.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=$V.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=LV.bind(null,e),e.Ca.E_=NV.bind(null,e.eventManager),e.Ca.Ka=xV.bind(null,e.eventManager),e}function Py(n){let e=V(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=VV.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=FV.bind(null,e),e}function YV(n,e,t){let r=V(n);(function(o,s,a){return w(this,null,function*(){try{let u=yield s.getMetadata();if(yield function(y,D){let R=V(y),P=Pe(D.createTime);return R.persistence.runTransaction("hasNewerBundle","readonly",O=>R.Wr.getBundleMetadata(O,D.id)).then(O=>!!O&&O.createTime.compareTo(P)>=0)}(o.localStore,u))return yield s.close(),a._completeWith(function(y){return{taskState:"Success",documentsLoaded:y.totalDocuments,bytesLoaded:y.totalBytes,totalDocuments:y.totalDocuments,totalBytes:y.totalBytes}}(u)),Promise.resolve(new Set);a._updateProgress(gD(u));let l=new Rg(u,o.localStore,s.serializer),h=yield s.$a();for(;h;){let g=yield l.ca(h);g&&a._updateProgress(g),h=yield s.$a()}let p=yield l.complete();return yield bn(o,p.Pa,void 0),yield function(y,D){let R=V(y);return R.persistence.runTransaction("Save bundle","readwrite",P=>R.Wr.saveBundleMetadata(P,D))}(o.localStore,u),a._completeWith(p.progress),Promise.resolve(p.ha)}catch(u){return wt("SyncEngine",`Loading bundle failed with ${u}`),a._failWith(u),Promise.resolve(new Set)}})})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var ur=class{constructor(){this.synchronizeTabs=!1}initialize(e){return w(this,null,function*(){this.serializer=wa(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return rD(this.persistence,new Ol,e.initialUser,this.serializer)}createPersistence(e){return new aa(Ml.Yr,this.serializer)}createSharedClientState(e){return new jl}terminate(){return w(this,null,function*(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}},Lg=class extends ur{constructor(e){super(),this.cacheSizeBytes=e}createGarbageCollectionScheduler(e,t){q(this.persistence.referenceDelegate instanceof kl);let r=this.persistence.referenceDelegate.garbageCollector;return new xl(r,e.asyncQueue,t)}createPersistence(e){let t=this.cacheSizeBytes!==void 0?pt.withCacheSize(this.cacheSizeBytes):pt.DEFAULT;return new aa(r=>kl.Yr(r,t),this.serializer)}},da=class n extends ur{constructor(e,t,r){super(),this.Ua=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return w(this,null,function*(){yield qa(n.prototype,this,"initialize").call(this,e),yield this.Ua.initialize(this,e),yield Py(this.Ua.syncEngine),yield Po(this.Ua.remoteStore),yield this.persistence.pi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return rD(this.persistence,new Ol,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){let r=this.persistence.referenceDelegate.garbageCollector;return new xl(r,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){let r=new mm(t,this.persistence);return new pm(e.asyncQueue,r)}createPersistence(e){let t=wy(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?pt.withCacheSize(this.cacheSizeBytes):pt.DEFAULT;return new hg(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,lD(),rl(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new jl}},Ql=class n extends da{constructor(e,t){super(e,t,!1),this.Ua=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return w(this,null,function*(){yield qa(n.prototype,this,"initialize").call(this,e);let t=this.Ua.syncEngine;this.sharedClientState instanceof Gs&&(this.sharedClientState.syncEngine={eo:zV.bind(null,t),no:KV.bind(null,t),ro:QV.bind(null,t),qi:WV.bind(null,t),Xs:HV.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.pi(r=>w(this,null,function*(){yield GV(this.Ua.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let t=lD();if(!Gs.D(t))throw new M(N.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=wy(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Gs(t,e.asyncQueue,r,e.clientId,e.initialUser)}},lr=class{initialize(e,t){return w(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>jb(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=BV.bind(null,this.syncEngine),yield Cg(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new Ag}()}createDatastore(e){let t=wa(e.databaseInfo.databaseId),r=function(o){return new _g(o)}(e.databaseInfo);return function(o,s,a,u){return new Eg(o,s,a,u)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,o,s,a){return new bg(r,i,o,s,a)}(this.localStore,this.datastore,e.asyncQueue,t=>jb(this.syncEngine,t,0),function(){return Ul.D()?new Ul:new yg}())}createSyncEngine(e,t){return function(i,o,s,a,u,l,h){let p=new kg(i,o,s,a,u,l);return h&&(p.qa=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return w(this,null,function*(){var e,t;yield function(i){return w(this,null,function*(){let o=V(i);k("RemoteStore","RemoteStore shutting down."),o.N_.add(5),yield Ro(o),o.B_.shutdown(),o.k_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()})}};function Bb(n,e=10240){let t=0;return{read(){return w(this,null,function*(){if(t<n.byteLength){let i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})},cancel(){return w(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var Co=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Wa(this.observer.next,e)}error(e){this.observer.error?this.Wa(this.observer.error,e):Ne("Uncaught Error in snapshot listener:",e.toString())}Ga(){this.muted=!0}Wa(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var Vg=class{constructor(e,t){this.za=e,this.serializer=t,this.metadata=new xe,this.buffer=new Uint8Array,this.ja=function(){return new TextDecoder("utf-8")}(),this.Ha().then(r=>{r&&r.aa()?this.metadata.resolve(r._a.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?._a)}`))},r=>this.metadata.reject(r))}close(){return this.za.cancel()}getMetadata(){return w(this,null,function*(){return this.metadata.promise})}$a(){return w(this,null,function*(){return yield this.getMetadata(),this.Ha()})}Ha(){return w(this,null,function*(){let e=yield this.Ja();if(e===null)return null;let t=this.ja.decode(e),r=Number(t);isNaN(r)&&this.Ya(`length string (${t}) is not valid number`);let i=yield this.Za(r);return new xg(JSON.parse(i),e.length+r)})}Xa(){return this.buffer.findIndex(e=>e===123)}Ja(){return w(this,null,function*(){for(;this.Xa()<0&&!(yield this.eu()););if(this.buffer.length===0)return null;let e=this.Xa();e<0&&this.Ya("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}Za(e){return w(this,null,function*(){for(;this.buffer.length<e;)(yield this.eu())&&this.Ya("Reached the end of bundle when more is expected.");let t=this.ja.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}Ya(e){throw this.za.cancel(),new Error(`Invalid bundle format: ${e}`)}eu(){return w(this,null,function*(){let e=yield this.za.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var Fg=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return w(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new M(N.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(i,o){return w(this,null,function*(){let s=V(i),a={documents:o.map(p=>ra(s.serializer,p))},u=yield s.No("BatchGetDocuments",s.serializer.databaseId,ce.emptyPath(),a,o.length),l=new Map;u.forEach(p=>{let g=nV(s.serializer,p);l.set(g.key.toString(),g)});let h=[];return o.forEach(p=>{let g=l.get(p.toString());q(!!g),h.push(g)}),h})}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new ar(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return w(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{let i=j.fromPath(r);this.mutations.push(new Zs(i,this.precondition(i)))}),yield function(r,i){return w(this,null,function*(){let o=V(r),s={writes:i.map(a=>ia(o.serializer,a))};yield o.Fo("Commit",o.serializer.databaseId,ce.emptyPath(),s)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw $();t=z.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new M(N.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(z.min())?Ae.exists(!1):Ae.updateTime(t):Ae.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(z.min()))throw new M(N.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ae.updateTime(t)}return Ae.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var jg=class{constructor(e,t,r,i,o){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=o,this.tu=r.maxAttempts,this.e_=new ua(this.asyncQueue,"transaction_retry")}nu(){this.tu-=1,this.ru()}ru(){this.e_.Wo(()=>w(this,null,function*(){let e=new Fg(this.datastore),t=this.iu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.su(i)}))}).catch(r=>{this.su(r)})}))}iu(e){try{let t=this.updateFunction(e);return!ya(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}su(e){this.tu>0&&this.ou(e)?(this.tu-=1,this.asyncQueue.enqueueAndForget(()=>(this.ru(),Promise.resolve()))):this.deferred.reject(e)}ou(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!kC(t)}return!1}};var Ug=class{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Fe.UNAUTHENTICATED,this.clientId=al.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,o=>w(this,null,function*(){k("FirestoreClient","Received user=",o.uid),yield this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,o=>(k("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new M(N.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new xe;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>w(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=ko(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function il(n,e){return w(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),k("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>w(this,null,function*(){r.isEqual(i)||(yield iD(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function Bg(n,e){return w(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield My(n);k("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>Lb(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>Lb(e.remoteStore,i)),n._onlineComponents=e})}function wD(n){return n.name==="FirebaseError"?n.code===N.FAILED_PRECONDITION||n.code===N.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}function My(n){return w(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){k("FirestoreClient","Using user provided OfflineComponentProvider");try{yield il(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!wD(t))throw t;wt("Error using user provided cache. Falling back to memory cache: "+t),yield il(n,new ur)}}else k("FirestoreClient","Using default OfflineComponentProvider"),yield il(n,new ur);return n._offlineComponents})}function ud(n){return w(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(k("FirestoreClient","Using user provided OnlineComponentProvider"),yield Bg(n,n._uninitializedComponentsProvider._online)):(k("FirestoreClient","Using default OnlineComponentProvider"),yield Bg(n,new lr))),n._onlineComponents})}function ED(n){return My(n).then(e=>e.persistence)}function Oo(n){return My(n).then(e=>e.localStore)}function TD(n){return ud(n).then(e=>e.remoteStore)}function ky(n){return ud(n).then(e=>e.syncEngine)}function bD(n){return ud(n).then(e=>e.datastore)}function Do(n){return w(this,null,function*(){let e=yield ud(n),t=e.eventManager;return t.onListen=RV.bind(null,e.syncEngine),t.onUnlisten=MV.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=PV.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=kV.bind(null,e.syncEngine),t})}function JV(n){return n.asyncQueue.enqueue(()=>w(this,null,function*(){let e=yield ED(n),t=yield TD(n);return e.setNetworkEnabled(!0),function(i){let o=V(i);return o.N_.delete(0),Ea(o)}(t)}))}function ZV(n){return n.asyncQueue.enqueue(()=>w(this,null,function*(){let e=yield ED(n),t=yield TD(n);return e.setNetworkEnabled(!1),function(i){return w(this,null,function*(){let o=V(i);o.N_.add(0),yield Ro(o),o.k_.set("Offline")})}(t)}))}function XV(n,e){let t=new xe;return n.asyncQueue.enqueueAndForget(()=>w(this,null,function*(){return function(i,o,s){return w(this,null,function*(){try{let a=yield function(l,h){let p=V(l);return p.persistence.runTransaction("read document","readonly",g=>p.localDocuments.getDocument(g,h))}(i,o);a.isFoundDocument()?s.resolve(a):a.isNoDocument()?s.resolve(null):s.reject(new M(N.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let u=ko(a,`Failed to get document '${o} from cache`);s.reject(u)}})}(yield Oo(n),e,t)})),t.promise}function CD(n,e,t={}){let r=new xe;return n.asyncQueue.enqueueAndForget(()=>w(this,null,function*(){return function(o,s,a,u,l){let h=new Co({next:g=>{s.enqueueAndForget(()=>Dy(o,p));let y=g.docs.has(a);!y&&g.fromCache?l.reject(new M(N.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&g.fromCache&&u&&u.source==="server"?l.reject(new M(N.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(g)},error:g=>l.reject(g)}),p=new la(xo(a.path),h,{includeMetadataChanges:!0,oa:!0});return Cy(o,p)}(yield Do(n),n.asyncQueue,e,t,r)})),r.promise}function eF(n,e){let t=new xe;return n.asyncQueue.enqueueAndForget(()=>w(this,null,function*(){return function(i,o,s){return w(this,null,function*(){try{let a=yield Ll(i,o,!0),u=new Kl(o,a.Is),l=u.Va(a.documents),h=u.applyChanges(l,!1);s.resolve(h.snapshot)}catch(a){let u=ko(a,`Failed to execute query '${o} against cache`);s.reject(u)}})}(yield Oo(n),e,t)})),t.promise}function DD(n,e,t={}){let r=new xe;return n.asyncQueue.enqueueAndForget(()=>w(this,null,function*(){return function(o,s,a,u,l){let h=new Co({next:g=>{s.enqueueAndForget(()=>Dy(o,p)),g.fromCache&&u.source==="server"?l.reject(new M(N.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(g)},error:g=>l.reject(g)}),p=new la(a,h,{includeMetadataChanges:!0,oa:!0});return Cy(o,p)}(yield Do(n),n.asyncQueue,e,t,r)})),r.promise}function tF(n,e,t){let r=new xe;return n.asyncQueue.enqueueAndForget(()=>w(this,null,function*(){try{let i=yield bD(n);r.resolve(function(s,a,u){return w(this,null,function*(){var l;let h=V(s),{request:p,ut:g,parent:y}=HC(h.serializer,yC(a),u);h.connection.vo||delete p.parent;let D=(yield h.No("RunAggregationQuery",h.serializer.databaseId,y,p,1)).filter(P=>!!P.result);q(D.length===1);let R=(l=D[0].result)===null||l===void 0?void 0:l.aggregateFields;return Object.keys(R).reduce((P,O)=>(P[g[O]]=R[O],P),{})})}(i,e,t))}catch(i){r.reject(i)}})),r.promise}function nF(n,e){let t=new Co(e);return n.asyncQueue.enqueueAndForget(()=>w(this,null,function*(){return function(i,o){V(i).J_.add(o),o.next()}(yield Do(n),t)})),()=>{t.Ga(),n.asyncQueue.enqueueAndForget(()=>w(this,null,function*(){return function(i,o){V(i).J_.delete(o)}(yield Do(n),t)}))}}function rF(n,e,t,r){let i=function(s,a){let u;return u=typeof s=="string"?LC().encode(s):s,function(h,p){return new Vg(h,p)}(function(h,p){if(h instanceof Uint8Array)return Bb(h,p);if(h instanceof ArrayBuffer)return Bb(new Uint8Array(h),p);if(h instanceof ReadableStream)return h.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(u),a)}(t,wa(e));n.asyncQueue.enqueueAndForget(()=>w(this,null,function*(){YV(yield ky(n),i,r)}))}function iF(n,e){return n.asyncQueue.enqueue(()=>w(this,null,function*(){return function(r,i){let o=V(r);return o.persistence.runTransaction("Get named query","readonly",s=>o.Wr.getNamedQuery(s,i))}(yield Oo(n),e)}))}function oF(n,e){return n.asyncQueue.enqueue(()=>w(this,null,function*(){return function(r,i){return w(this,null,function*(){let o=V(r),s=o.indexManager,a=[];return o.persistence.runTransaction("Configure indexes","readwrite",u=>s.getFieldIndexes(u).next(l=>function(p,g,y,D,R){p=[...p],g=[...g],p.sort(y),g.sort(y);let P=p.length,O=g.length,B=0,U=0;for(;B<O&&U<P;){let G=y(p[U],g[B]);G<0?R(p[U++]):G>0?D(g[B++]):(B++,U++)}for(;B<O;)D(g[B++]);for(;U<P;)R(p[U++])}(l,i,gL,h=>{a.push(s.addFieldIndex(u,h))},h=>{a.push(s.deleteFieldIndex(u,h))})).next(()=>A.waitFor(a)))})}(yield Oo(n),e)}))}function sF(n,e){return n.asyncQueue.enqueue(()=>w(this,null,function*(){return function(r,i){V(r).rs.Gi=i}(yield Oo(n),e)}))}function aF(n){return n.asyncQueue.enqueue(()=>w(this,null,function*(){return function(t){let r=V(t),i=r.indexManager;return r.persistence.runTransaction("Delete All Indexes","readwrite",o=>i.deleteAllFieldIndexes(o))}(yield Oo(n))}))}function SD(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var $b=new Map;function Oy(n,e,t){if(!t)throw new M(N.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function cF(n,e,t,r){if(e===!0&&r===!0)throw new M(N.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function qb(n){if(!j.isDocumentKey(n))throw new M(N.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Hb(n){if(j.isDocumentKey(n))throw new M(N.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function ld(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":$()}function re(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new M(N.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=ld(n);throw new M(N.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function AD(n,e){if(e<=0)throw new M(N.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}var Yl=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new M(N.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new M(N.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}cF("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=SD((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new M(N.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new M(N.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new M(N.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},hi=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Yl({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new M(N.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new M(N.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Yl(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new om;switch(r.type){case"firstParty":return new um(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new M(N.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=$b.get(t);r&&(k("ComponentProvider","Removing Datastore"),$b.delete(t),r.terminate())}(this),Promise.resolve()}};function Ly(n,e,t,r={}){var i;let o=(n=re(n,hi))._getSettings(),s=`${e}:${t}`;if(o.host!=="firestore.googleapis.com"&&o.host!==s&&wt("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},o),{host:s,ssl:!1})),r.mockUserToken){let a,u;if(typeof r.mockUserToken=="string")a=r.mockUserToken,u=Fe.MOCK_USER;else{a=oT(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new M(N.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Fe(l)}n._authCredentials=new sm(new ol(a,u))}}var Qe=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Me=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Xt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},Xt=class n extends Qe{constructor(e,t,r){super(e,t,xo(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Me(this.firestore,null,new j(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function ND(n,e,...t){if(n=Te(n),Oy("collection","path",e),n instanceof hi){let r=ce.fromString(e,...t);return Hb(r),new Xt(n,null,r)}{if(!(n instanceof Me||n instanceof Xt))throw new M(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ce.fromString(e,...t));return Hb(r),new Xt(n.firestore,null,r)}}function xD(n,e){if(n=re(n,hi),Oy("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new M(N.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Qe(n,null,function(r){return new Lt(ce.emptyPath(),r)}(e))}function Vy(n,e,...t){if(n=Te(n),arguments.length===1&&(e=al.newId()),Oy("doc","path",e),n instanceof hi){let r=ce.fromString(e,...t);return qb(r),new Me(n,null,new j(r))}{if(!(n instanceof Me||n instanceof Xt))throw new M(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ce.fromString(e,...t));return qb(r),new Me(n.firestore,n instanceof Xt?n.converter:null,new j(r))}}function yr(n,e){return n=Te(n),e=Te(e),(n instanceof Me||n instanceof Xt)&&(e instanceof Me||e instanceof Xt)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function dd(n,e){return n=Te(n),e=Te(e),n instanceof Qe&&e instanceof Qe&&n.firestore===e.firestore&&_a(n._query,e._query)&&n.converter===e.converter}var $g=class{constructor(){this._u=Promise.resolve(),this.au=[],this.uu=!1,this.cu=[],this.lu=null,this.hu=!1,this.Pu=!1,this.Iu=[],this.e_=new ua(this,"async_queue_retry"),this.Tu=()=>{let t=rl();t&&k("AsyncQueue","Visibility state changed to "+t.visibilityState),this.e_.zo()};let e=rl();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Tu)}get isShuttingDown(){return this.uu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Eu(),this.du(e)}enterRestrictedMode(e){if(!this.uu){this.uu=!0,this.Pu=e||!1;let t=rl();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Tu)}}enqueue(e){if(this.Eu(),this.uu)return new Promise(()=>{});let t=new xe;return this.du(()=>this.uu&&this.Pu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.au.push(e),this.Au()))}Au(){return w(this,null,function*(){if(this.au.length!==0){try{yield this.au[0](),this.au.shift(),this.e_.reset()}catch(e){if(!pr(e))throw e;k("AsyncQueue","Operation failed with retryable error: "+e)}this.au.length>0&&this.e_.Wo(()=>this.Au())}})}du(e){let t=this._u.then(()=>(this.hu=!0,e().catch(r=>{this.lu=r,this.hu=!1;let i=function(s){let a=s.message||"";return s.stack&&(a=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),a}(r);throw Ne("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.hu=!1,r))));return this._u=t,t}enqueueAfterDelay(e,t,r){this.Eu(),this.Iu.indexOf(e)>-1&&(t=0);let i=Dg.createAndSchedule(this,e,t,r,o=>this.Ru(o));return this.cu.push(i),i}Eu(){this.lu&&$()}verifyOperationInProgress(){}Vu(){return w(this,null,function*(){let e;do e=this._u,yield e;while(e!==this._u)})}mu(e){for(let t of this.cu)if(t.timerId===e)return!0;return!1}fu(e){return this.Vu().then(()=>{this.cu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.cu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Vu()})}gu(e){this.Iu.push(e)}Ru(e){let t=this.cu.indexOf(e);this.cu.splice(t,1)}};function qg(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let o of r)if(o in i&&typeof i[o]=="function")return!0;return!1}(n,["next","error","complete"])}var Hg=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new xe,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var i4=-1,pe=class extends hi{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new $g}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||MD(this),this._firestoreClient.terminate()}};function RD(n,e,t){t||(t="(default)");let r=Cs(n,"firestore");if(r.isInitialized(t)){let i=r.getImmediate({identifier:t}),o=r.getOptions(t);if(Wt(o,e))return i;throw new M(N.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new M(N.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new M(N.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:t})}function PD(n,e){let t=typeof n=="object"?n:Ds(),r=typeof n=="string"?n:e||"(default)",i=Cs(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let o=rT("firestore");o&&Ly(i,...o)}return i}function be(n){return n._firestoreClient||MD(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function MD(n){var e,t,r;let i=n._freezeSettings(),o=function(a,u,l,h){return new gm(a,u,l,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,SD(h.experimentalLongPollingOptions),h.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new Ug(n._authCredentials,n._appCheckCredentials,n._queue,o),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function kD(n,e){HD(n=re(n,pe));let t=be(n);if(t._uninitializedComponentsProvider)throw new M(N.FAILED_PRECONDITION,"SDK cache is already specified.");wt("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=n._freezeSettings(),i=new lr;return LD(t,i,new da(i,r.cacheSizeBytes,e?.forceOwnership))}function OD(n){HD(n=re(n,pe));let e=be(n);if(e._uninitializedComponentsProvider)throw new M(N.FAILED_PRECONDITION,"SDK cache is already specified.");wt("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings(),r=new lr;return LD(e,r,new Ql(r,t.cacheSizeBytes))}function LD(n,e,t){let r=new xe;return n.asyncQueue.enqueue(()=>w(this,null,function*(){try{yield il(n,t),yield Bg(n,e),r.resolve()}catch(i){let o=i;if(!wD(o))throw o;wt("Error enabling indexeddb cache. Falling back to memory cache: "+o),r.reject(o)}})).then(()=>r.promise)}function VD(n){if(n._initialized&&!n._terminated)throw new M(N.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new xe;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>w(this,null,function*(){try{yield function(r){return w(this,null,function*(){if(!tr.D())return Promise.resolve();let i=r+"main";yield tr.delete(i)})}(wy(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function FD(n){return function(t){let r=new xe;return t.asyncQueue.enqueueAndForget(()=>w(this,null,function*(){return jV(yield ky(t),r)})),r.promise}(be(n=re(n,pe)))}function jD(n){return JV(be(n=re(n,pe)))}function UD(n){return ZV(be(n=re(n,pe)))}function BD(n){return TT(n.app,"firestore",n._databaseId.database),n._delete()}function $D(n,e){let t=be(n=re(n,pe)),r=new Hg;return rF(t,n._databaseId,e,r),r}function qD(n,e){return iF(be(n=re(n,pe)),e).then(t=>t?new Qe(n,null,t.query):null)}function HD(n){if(n._initialized||n._terminated)throw new M(N.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var fi=class{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}},zg=class{constructor(e,t,r){this._userDataWriter=t,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}};var So=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(ke.fromBase64String(e))}catch(t){throw new M(N.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(ke.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var En=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new M(N.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new je(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};function zD(){return new En("__name__")}var Tn=class{constructor(e){this._methodName=e}};var ha=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new M(N.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new M(N.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return K(this._lat,e._lat)||K(this._long,e._long)}};var uF=/^__.*__$/,Gg=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Ft(e,this.data,this.fieldMask,t,this.fieldTransforms):new sr(e,this.data,t,this.fieldTransforms)}},Jl=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Ft(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function GD(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw $()}}var Zl=class n{constructor(e,t,r,i,o,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.pu(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get yu(){return this.settings.yu}wu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Su(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.wu({path:r,bu:!1});return i.Du(e),i}Cu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.wu({path:r,bu:!1});return i.pu(),i}vu(e){return this.wu({path:void 0,bu:!0})}Fu(e){return Xl(e,this.settings.methodName,this.settings.Mu||!1,this.path,this.settings.xu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}pu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Du(this.path.get(e))}Du(e){if(e.length===0)throw this.Fu("Document fields must not be empty");if(GD(this.yu)&&uF.test(e))throw this.Fu('Document fields cannot begin and end with "__"')}},Wg=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||wa(e)}Ou(e,t,r,i=!1){return new Zl({yu:e,methodName:t,xu:r,path:je.emptyPath(),bu:!1,Mu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function gi(n){let e=n._freezeSettings(),t=wa(n._databaseId);return new Wg(n._databaseId,!!e.ignoreUndefinedProperties,t)}function hd(n,e,t,r,i,o={}){let s=n.Ou(o.merge||o.mergeFields?2:0,e,t,i);Uy("Data must be an object, but it was:",s,r);let a=QD(r,s),u,l;if(o.merge)u=new It(s.fieldMask),l=s.fieldTransforms;else if(o.mergeFields){let h=[];for(let p of o.mergeFields){let g=pa(e,p,t);if(!s.contains(g))throw new M(N.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);JD(h,g)||h.push(g)}u=new It(h),l=s.fieldTransforms.filter(p=>u.covers(p.field))}else u=null,l=s.fieldTransforms;return new Gg(new it(a),u,l)}var fa=class n extends Tn{_toFieldTransform(e){if(e.yu!==2)throw e.yu===1?e.Fu(`${this._methodName}() can only appear at the top level of your update data`):e.Fu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function WD(n,e,t){return new Zl({yu:3,xu:e.settings.xu,methodName:n._methodName,bu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var Kg=class n extends Tn{_toFieldTransform(e){return new ui(e.path,new ir)}isEqual(e){return e instanceof n}},Qg=class n extends Tn{constructor(e,t){super(e),this.Nu=t}_toFieldTransform(e){let t=WD(this,e,!0),r=this.Nu.map(o=>yi(o,t)),i=new In(r);return new ui(e.path,i)}isEqual(e){return e instanceof n&&Wt(this.Nu,e.Nu)}},Yg=class n extends Tn{constructor(e,t){super(e),this.Nu=t}_toFieldTransform(e){let t=WD(this,e,!0),r=this.Nu.map(o=>yi(o,t)),i=new wn(r);return new ui(e.path,i)}isEqual(e){return e instanceof n&&Wt(this.Nu,e.Nu)}},Jg=class n extends Tn{constructor(e,t){super(e),this.Lu=t}_toFieldTransform(e){let t=new or(e.serializer,SC(e.serializer,this.Lu));return new ui(e.path,t)}isEqual(e){return e instanceof n&&this.Lu===e.Lu}};function Fy(n,e,t,r){let i=n.Ou(1,e,t);Uy("Data must be an object, but it was:",i,r);let o=[],s=it.empty();mr(r,(u,l)=>{let h=fd(e,u,t);l=Te(l);let p=i.Cu(h);if(l instanceof fa)o.push(h);else{let g=yi(l,p);g!=null&&(o.push(h),s.set(h,g))}});let a=new It(o);return new Jl(s,a,i.fieldTransforms)}function jy(n,e,t,r,i,o){let s=n.Ou(1,e,t),a=[pa(e,r,t)],u=[i];if(o.length%2!=0)throw new M(N.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<o.length;g+=2)a.push(pa(e,o[g])),u.push(o[g+1]);let l=[],h=it.empty();for(let g=a.length-1;g>=0;--g)if(!JD(l,a[g])){let y=a[g],D=u[g];D=Te(D);let R=s.Cu(y);if(D instanceof fa)l.push(y);else{let P=yi(D,R);P!=null&&(l.push(y),h.set(y,P))}}let p=new It(l);return new Jl(h,p,s.fieldTransforms)}function KD(n,e,t,r=!1){return yi(t,n.Ou(r?4:3,e))}function yi(n,e){if(YD(n=Te(n)))return Uy("Unsupported field value:",e,n),QD(n,e);if(n instanceof Tn)return function(r,i){if(!GD(i.yu))throw i.Fu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Fu(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.bu&&e.yu!==4)throw e.Fu("Nested arrays are not supported");return function(r,i){let o=[],s=0;for(let a of r){let u=yi(a,i.vu(s));u==null&&(u={nullValue:"NULL_VALUE"}),o.push(u),s++}return{arrayValue:{values:o}}}(n,e)}return function(r,i){if((r=Te(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return SC(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=Re.fromDate(r);return{timestampValue:yo(i.serializer,o)}}if(r instanceof Re){let o=new Re(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:yo(i.serializer,o)}}if(r instanceof ha)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof So)return{bytesValue:VC(i.serializer,r._byteString)};if(r instanceof Me){let o=i.databaseId,s=r.firestore._databaseId;if(!s.isEqual(o))throw i.Fu(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:vy(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.Fu(`Unsupported field value: ${ld(r)}`)}(n,e)}function QD(n,e){let t={};return cC(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):mr(n,(r,i)=>{let o=yi(i,e.Su(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function YD(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Re||n instanceof ha||n instanceof So||n instanceof Me||n instanceof Tn)}function Uy(n,e,t){if(!YD(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=ld(t);throw r==="an object"?e.Fu(n+" a custom object"):e.Fu(n+" "+r)}}function pa(n,e,t){if((e=Te(e))instanceof En)return e._internalPath;if(typeof e=="string")return fd(n,e);throw Xl("Field path arguments must be of type string or ",n,!1,void 0,t)}var lF=new RegExp("[~\\*/\\[\\]]");function fd(n,e,t){if(e.search(lF)>=0)throw Xl(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new En(...e.split("."))._internalPath}catch{throw Xl(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Xl(n,e,t,r,i){let o=r&&!r.isEmpty(),s=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(o||s)&&(u+=" (found",o&&(u+=` in field ${r}`),s&&(u+=` in document ${i}`),u+=")"),new M(N.INVALID_ARGUMENT,a+n+u)}function JD(n,e){return n.some(t=>t.isEqual(e))}var pi=class{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Me(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Zg(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(pd("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Zg=class extends pi{data(){return super.data()}};function pd(n,e){return typeof e=="string"?fd(n,e):e instanceof En?e._internalPath:e._delegate._internalPath}function ZD(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new M(N.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var ma=class{},mi=class extends ma{};function XD(n,e,...t){let r=[];e instanceof ma&&r.push(e),r=r.concat(t),function(o){let s=o.filter(u=>u instanceof Ao).length,a=o.filter(u=>u instanceof ga).length;if(s>1||s>0&&a>0)throw new M(N.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var ga=class n extends mi{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return dS(e._query,t),new Qe(e.firestore,e.converter,Nm(e._query,t))}_parse(e){let t=gi(e.firestore);return function(o,s,a,u,l,h,p){let g;if(l.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new M(N.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){Gb(p,h);let y=[];for(let D of p)y.push(zb(u,o,D));g={arrayValue:{values:y}}}else g=zb(u,o,p)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||Gb(p,h),g=KD(a,s,p,h==="in"||h==="not-in");return se.create(l,h,g)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function eS(n,e,t){let r=e,i=pd("where",n);return ga._create(i,r,t)}var Ao=class n extends ma{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:ge.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,o){let s=i,a=o.getFlattenedFilters();for(let u of a)dS(s,u),s=Nm(s,u)}(e._query,t),new Qe(e.firestore,e.converter,Nm(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};function tS(...n){return n.forEach(e=>hS("or",e)),Ao._create("or",n)}function nS(...n){return n.forEach(e=>hS("and",e)),Ao._create("and",n)}var Xg=class n extends mi{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,o,s){if(i.startAt!==null)throw new M(N.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new M(N.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ai(o,s)}(e._query,this._field,this._direction);return new Qe(e.firestore,e.converter,function(i,o){let s=i.explicitOrderBy.concat([o]);return new Lt(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function rS(n,e="asc"){let t=e,r=pd("orderBy",n);return Xg._create(r,t)}var ed=class n extends mi{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new Qe(e.firestore,e.converter,yl(e._query,this._limit,this._limitType))}};function iS(n){return AD("limit",n),ed._create("limit",n,"F")}function oS(n){return AD("limitToLast",n),ed._create("limitToLast",n,"L")}var td=class n extends mi{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=lS(e,this.type,this._docOrFields,this._inclusive);return new Qe(e.firestore,e.converter,function(i,o){return new Lt(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,o,i.endAt)}(e._query,t))}};function sS(...n){return td._create("startAt",n,!0)}function aS(...n){return td._create("startAfter",n,!1)}var nd=class n extends mi{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=lS(e,this.type,this._docOrFields,this._inclusive);return new Qe(e.firestore,e.converter,function(i,o){return new Lt(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,o)}(e._query,t))}};function cS(...n){return nd._create("endBefore",n,!1)}function uS(...n){return nd._create("endAt",n,!0)}function lS(n,e,t,r){if(t[0]=Te(t[0]),t[0]instanceof pi)return function(o,s,a,u,l){if(!u)throw new M(N.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let h=[];for(let p of so(o))if(p.field.isKeyField())h.push(si(s,u.key));else{let g=u.data.field(p.field);if(id(g))throw new M(N.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+p.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(g===null){let y=p.field.canonicalString();throw new M(N.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${y}' (used as the orderBy) does not exist.`)}h.push(g)}return new tn(h,l)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=gi(n.firestore);return function(s,a,u,l,h,p){let g=s.explicitOrderBy;if(h.length>g.length)throw new M(N.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let y=[];for(let D=0;D<h.length;D++){let R=h[D];if(g[D].field.isKeyField()){if(typeof R!="string")throw new M(N.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof R}`);if(!gy(s)&&R.indexOf("/")!==-1)throw new M(N.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${R}' contains a slash.`);let P=s.path.child(ce.fromString(R));if(!j.isDocumentKey(P))throw new M(N.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${P}' is not because it contains an odd number of segments.`);let O=new j(P);y.push(si(a,O))}else{let P=KD(u,l,R);y.push(P)}}return new tn(y,p)}(n._query,n.firestore._databaseId,i,e,t,r)}}function zb(n,e,t){if(typeof(t=Te(t))=="string"){if(t==="")throw new M(N.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!gy(e)&&t.indexOf("/")!==-1)throw new M(N.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(ce.fromString(t));if(!j.isDocumentKey(r))throw new M(N.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return si(n,new j(r))}if(t instanceof Me)return si(n,t._key);throw new M(N.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ld(t)}.`)}function Gb(n,e){if(!Array.isArray(n)||n.length===0)throw new M(N.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function dS(n,e){let t=function(i,o){for(let s of i)for(let a of s.getFlattenedFilters())if(o.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new M(N.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new M(N.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function hS(n,e){if(!(e instanceof ga||e instanceof Ao))throw new M(N.INVALID_ARGUMENT,`Function ${n}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}var rd=class{convertValue(e,t="none"){switch(nr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Se(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(_n(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw $()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return mr(e,(i,o)=>{r[i]=this.convertValue(o,t)}),r}convertGeoPoint(e){return new ha(Se(e.latitude),Se(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=od(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Qs(e));default:return null}}convertTimestamp(e){let t=vn(e);return new Re(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=ce.fromString(e);q(KC(r));let i=new ho(r.get(1),r.get(3)),o=new j(r.popFirst(5));return i.isEqual(t)||Ne(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};function md(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var ey=class extends rd{constructor(e){super(),this.firestore=e}convertBytes(e){return new So(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Me(this.firestore,null,t)}};function fS(n){return new fi("sum",pa("sum",n))}function pS(n){return new fi("avg",pa("average",n))}function By(){return new fi("count")}function mS(n,e){var t,r;return n instanceof fi&&e instanceof fi&&n.aggregateType===e.aggregateType&&((t=n._internalFieldPath)===null||t===void 0?void 0:t.canonicalString())===((r=e._internalFieldPath)===null||r===void 0?void 0:r.canonicalString())}function gS(n,e){return dd(n.query,e.query)&&Wt(n.data(),e.data())}var gn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},dr=class extends pi{constructor(e,t,r,i,o,s){super(e,t,r,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new co(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(pd("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},co=class extends dr{data(e={}){return super.data(e)}},hr=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new gn(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new co(this._firestore,this._userDataWriter,r.key,r,new gn(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new M(N.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(a=>{let u=new co(i._firestore,i._userDataWriter,a.doc.key,a.doc,new gn(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:u,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>o||a.type!==3).map(a=>{let u=new co(i._firestore,i._userDataWriter,a.doc.key,a.doc,new gn(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,h=-1;return a.type!==0&&(l=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),a.type!==1&&(s=s.add(a.doc),h=s.indexOf(a.doc.key)),{type:dF(a.type),doc:u,oldIndex:l,newIndex:h}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function dF(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return $()}}function yS(n,e){return n instanceof dr&&e instanceof dr?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof hr&&e instanceof hr&&n._firestore===e._firestore&&dd(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function vS(n){n=re(n,Me);let e=re(n.firestore,pe);return CD(be(e),n._key).then(t=>$y(e,n,t))}var nn=class extends rd{constructor(e){super(),this.firestore=e}convertBytes(e){return new So(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Me(this.firestore,null,t)}};function _S(n){n=re(n,Me);let e=re(n.firestore,pe),t=be(e),r=new nn(e);return XV(t,n._key).then(i=>new dr(e,r,n._key,i,new gn(i!==null&&i.hasLocalMutations,!0),n.converter))}function IS(n){n=re(n,Me);let e=re(n.firestore,pe);return CD(be(e),n._key,{source:"server"}).then(t=>$y(e,n,t))}function wS(n){n=re(n,Qe);let e=re(n.firestore,pe),t=be(e),r=new nn(e);return ZD(n._query),DD(t,n._query).then(i=>new hr(e,r,n,i))}function ES(n){n=re(n,Qe);let e=re(n.firestore,pe),t=be(e),r=new nn(e);return eF(t,n._query).then(i=>new hr(e,r,n,i))}function TS(n){n=re(n,Qe);let e=re(n.firestore,pe),t=be(e),r=new nn(e);return DD(t,n._query,{source:"server"}).then(i=>new hr(e,r,n,i))}function bS(n,e,t){n=re(n,Me);let r=re(n.firestore,pe),i=md(n.converter,e,t);return Ta(r,[hd(gi(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Ae.none())])}function CS(n,e,t,...r){n=re(n,Me);let i=re(n.firestore,pe),o=gi(i),s;return s=typeof(e=Te(e))=="string"||e instanceof En?jy(o,"updateDoc",n._key,e,t,r):Fy(o,"updateDoc",n._key,e),Ta(i,[s.toMutation(n._key,Ae.exists(!0))])}function DS(n){return Ta(re(n.firestore,pe),[new ar(n._key,Ae.none())])}function SS(n,e){let t=re(n.firestore,pe),r=Vy(n),i=md(n.converter,e);return Ta(t,[hd(gi(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Ae.exists(!1))]).then(()=>r)}function gd(n,...e){var t,r,i;n=Te(n);let o={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||qg(e[s])||(o=e[s],s++);let a={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(qg(e[s])){let p=e[s];e[s]=(t=p.next)===null||t===void 0?void 0:t.bind(p),e[s+1]=(r=p.error)===null||r===void 0?void 0:r.bind(p),e[s+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let u,l,h;if(n instanceof Me)l=re(n.firestore,pe),h=xo(n._key.path),u={next:p=>{e[s]&&e[s]($y(l,n,p))},error:e[s+1],complete:e[s+2]};else{let p=re(n,Qe);l=re(p.firestore,pe),h=p._query;let g=new nn(l);u={next:y=>{e[s]&&e[s](new hr(l,g,p,y))},error:e[s+1],complete:e[s+2]},ZD(n._query)}return function(g,y,D,R){let P=new Co(R),O=new la(y,P,D);return g.asyncQueue.enqueueAndForget(()=>w(this,null,function*(){return Cy(yield Do(g),O)})),()=>{P.Ga(),g.asyncQueue.enqueueAndForget(()=>w(this,null,function*(){return Dy(yield Do(g),O)}))}}(be(l),h,a,u)}function AS(n,e){return nF(be(n=re(n,pe)),qg(e)?e:{next:e})}function Ta(n,e){return function(r,i){let o=new xe;return r.asyncQueue.enqueueAndForget(()=>w(this,null,function*(){return OV(yield ky(r),i,o)})),o.promise}(be(n),e)}function $y(n,e,t){let r=t.docs.get(e._key),i=new nn(n);return new dr(n,i,e._key,r,new gn(t.hasPendingWrites,t.fromCache),e.converter)}function yd(n){return qy(n,{count:By()})}function qy(n,e){let t=re(n.firestore,pe),r=be(t),i=aC(e,(o,s)=>new vl(s,o.aggregateType,o._internalFieldPath));return tF(r,n._query,i).then(o=>function(a,u,l){let h=new nn(a);return new zg(u,h,l)}(t,n,o))}var ty=class{constructor(e){this.kind="memory",this._onlineComponentProvider=new lr,e?.garbageCollector?this._offlineComponentProvider=e.garbageCollector._offlineComponentProvider:this._offlineComponentProvider=new ur}toJSON(){return{kind:this.kind}}},ny=class{constructor(e){let t;this.kind="persistent",e?.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=Hy(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}},ry=class{constructor(){this.kind="memoryEager",this._offlineComponentProvider=new ur}toJSON(){return{kind:this.kind}}},iy=class{constructor(e){this.kind="memoryLru",this._offlineComponentProvider=new Lg(e)}toJSON(){return{kind:this.kind}}};function NS(){return new ry}function xS(n){return new iy(n?.cacheSizeBytes)}function RS(n){return new ty(n)}function PS(n){return new ny(n)}var oy=class{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=new lr,this._offlineComponentProvider=new da(this._onlineComponentProvider,e?.cacheSizeBytes,this.forceOwnership)}},sy=class{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=new lr,this._offlineComponentProvider=new Ql(this._onlineComponentProvider,e?.cacheSizeBytes)}};function Hy(n){return new oy(n?.forceOwnership)}function MS(){return new sy}var hF={maxAttempts:5};var ay=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=gi(e)}set(e,t,r){this._verifyNotCommitted();let i=Jn(e,this._firestore),o=md(i.converter,t,r),s=hd(this._dataReader,"WriteBatch.set",i._key,o,i.converter!==null,r);return this._mutations.push(s.toMutation(i._key,Ae.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let o=Jn(e,this._firestore),s;return s=typeof(t=Te(t))=="string"||t instanceof En?jy(this._dataReader,"WriteBatch.update",o._key,t,r,i):Fy(this._dataReader,"WriteBatch.update",o._key,t),this._mutations.push(s.toMutation(o._key,Ae.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=Jn(e,this._firestore);return this._mutations=this._mutations.concat(new ar(t._key,Ae.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new M(N.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Jn(n,e){if((n=Te(n)).firestore!==e)throw new M(N.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var cy=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=gi(t)}get(t){let r=Jn(t,this._firestore),i=new ey(this._firestore);return this._transaction.lookup([r._key]).then(o=>{if(!o||o.length!==1)return $();let s=o[0];if(s.isFoundDocument())return new pi(this._firestore,i,s.key,s,r.converter);if(s.isNoDocument())return new pi(this._firestore,i,r._key,null,r.converter);throw $()})}set(t,r,i){let o=Jn(t,this._firestore),s=md(o.converter,r,i),a=hd(this._dataReader,"Transaction.set",o._key,s,o.converter!==null,i);return this._transaction.set(o._key,a),this}update(t,r,i,...o){let s=Jn(t,this._firestore),a;return a=typeof(r=Te(r))=="string"||r instanceof En?jy(this._dataReader,"Transaction.update",s._key,r,i,o):Fy(this._dataReader,"Transaction.update",s._key,r),this._transaction.update(s._key,a),this}delete(t){let r=Jn(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=Jn(e,this._firestore),r=new nn(this._firestore);return super.get(e).then(i=>new dr(this._firestore,r,t._key,i._document,new gn(!1,!1),t.converter))}};function kS(n,e,t){n=re(n,pe);let r=Object.assign(Object.assign({},hF),t);return function(o){if(o.maxAttempts<1)throw new M(N.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(o,s,a){let u=new xe;return o.asyncQueue.enqueueAndForget(()=>w(this,null,function*(){let l=yield bD(o);new jg(o.asyncQueue,l,a,s,u).nu()})),u.promise}(be(n),i=>e(new cy(n,i)),r)}function OS(){return new fa("deleteField")}function LS(){return new Kg("serverTimestamp")}function VS(...n){return new Qg("arrayUnion",n)}function FS(...n){return new Yg("arrayRemove",n)}function jS(n){return new Jg("increment",n)}function US(n){return be(n=re(n,pe)),new ay(n,e=>Ta(n,e))}function BS(n,e){var t;let r=be(n=re(n,pe));if(!r._uninitializedComponentsProvider||((t=r._uninitializedComponentsProvider)===null||t===void 0?void 0:t._offlineKind)==="memory")return wt("Cannot enable indexes when persistence is disabled"),Promise.resolve();let i=function(s){let a=typeof s=="string"?function(h){try{return JSON.parse(h)}catch(p){throw new M(N.INVALID_ARGUMENT,"Failed to parse JSON: "+p?.message)}}(s):s,u=[];if(Array.isArray(a.indexes))for(let l of a.indexes){let h=Wb(l,"collectionGroup"),p=[];if(Array.isArray(l.fields))for(let g of l.fields){let y=fd("setIndexConfiguration",Wb(g,"fieldPath"));g.arrayConfig==="CONTAINS"?p.push(new yn(y,2)):g.order==="ASCENDING"?p.push(new yn(y,0)):g.order==="DESCENDING"&&p.push(new yn(y,1))}u.push(new er(er.UNKNOWN_ID,h,p,lo.empty()))}return u}(e);return oF(r,i)}function Wb(n,e){if(typeof n[e]!="string")throw new M(N.INVALID_ARGUMENT,"Missing string value for: "+e);return n[e]}var uy=class{constructor(e){this._client=e,this.type="PersistentCacheIndexManager"}};function $S(n){var e;n=re(n,pe);let t=Kb.get(n);if(t)return t;let r=be(n);if(((e=r._uninitializedComponentsProvider)===null||e===void 0?void 0:e._offlineKind)!=="persistent")return null;let i=new uy(r);return Kb.set(n,i),i}function qS(n){GS(n,!0)}function HS(n){GS(n,!1)}function zS(n){n._client.verifyNotTerminated(),aF(n._client).then(e=>k("deleting all persistent cache indexes succeeded")).catch(e=>wt("deleting all persistent cache indexes failed",e))}function GS(n,e){n._client.verifyNotTerminated(),sF(n._client,e).then(t=>k(`setting persistent cache index auto creation isEnabled=${e} succeeded`)).catch(t=>wt(`setting persistent cache index auto creation isEnabled=${e} failed`,t))}var Kb=new WeakMap;function s4(n){var e;let t=(e=be(re(n.firestore,pe))._onlineComponents)===null||e===void 0?void 0:e.datastore.serializer;return t===void 0?null:sd(t,st(n._query))._t}function a4(n,e){var t;let r=aC(e,(o,s)=>new vl(s,o.aggregateType,o._internalFieldPath)),i=(t=be(re(n.firestore,pe))._onlineComponents)===null||t===void 0?void 0:t.datastore.serializer;return i===void 0?null:HC(i,yC(n._query),r,!0).request}var Qb=class{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return ly.instance.onExistenceFilterMismatch(e)}},ly=class n{constructor(){this.Bu=new Map}static get instance(){return Ju||(Ju=new n,function(t){if(_l)throw new Error("a TestingHooksSpi instance is already set");_l=t}(Ju)),Ju}et(e){this.Bu.forEach(t=>t(e))}onExistenceFilterMismatch(e){let t=Symbol(),r=this.Bu;return r.set(t,e),()=>r.delete(t)}},Ju=null;(function(e,t=!0){(function(i){No=i})(Wi),Hn(new St("firestore",(r,{instanceIdentifier:i,options:o})=>{let s=r.getProvider("app").getImmediate(),a=new pe(new am(r.getProvider("auth-internal")),new lm(r.getProvider("app-check-internal")),function(l,h){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new M(N.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ho(l.options.projectId,h)}(s,i),s);return o=Object.assign({useFetchStreams:t},o),a._setSettings(o),a},"PUBLIC").setMultipleInstances(!0)),He(GT,"4.6.5",e),He(GT,"4.6.5","esm2017")})();var vd=function(){return vd=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},vd.apply(this,arguments)};function Wy(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,o;r<i;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return n.concat(o||Array.prototype.slice.call(e))}var fF={includeMetadataChanges:!1};function ba(n,e){return e===void 0&&(e=fF),new ne(function(t){var r=gd(n,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:r}})}function Ky(n){return ba(n,{includeMetadataChanges:!0})}function WS(n,e){return e===void 0&&(e={}),Ky(n).pipe(We(function(t){return _d(t,e)}))}function _d(n,e){var t;e===void 0&&(e={});var r=n.data(e);return!n.exists()||typeof r!="object"||r===null||!e.idField?r:vd(vd({},r),(t={},t[e.idField]=n.id,t))}var KS=["added","modified","removed"],pF=function(n){return Mn(function(e){for(var t=!1,r=0;r<e.length;r++){var i=e[r];if(n&&n.indexOf(i.type)>=0){t=!0;break}}return t})};function zy(n,e,t){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=n.slice();return o.splice.apply(o,Wy([e,t],r,!1)),o}function mF(n,e){switch(e.type){case"added":if(!(n[e.newIndex]&&yr(n[e.newIndex].doc.ref,e.doc.ref)))return zy(n,e.newIndex,0,e);break;case"modified":if(n[e.oldIndex]==null||yr(n[e.oldIndex].doc.ref,e.doc.ref))if(e.oldIndex!==e.newIndex){var t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}else return zy(n,e.newIndex,1,e);break;case"removed":if(n[e.oldIndex]&&yr(n[e.oldIndex].doc.ref,e.doc.ref))return zy(n,e.oldIndex,1);break}return n}function gF(n,e,t){return t===void 0&&(t=KS),e.forEach(function(r){t.indexOf(r.type)>-1&&(n=mF(n,r))}),n}var QS=function(){return ec(Ih(void 0),_h())},Gy=function(n,e){return JSON.stringify(n.metadata)===JSON.stringify(e.metadata)},yF=function(){return ec(QS(),Mn(function(n){var e=n[0],t=n[1];return t.length>0||e===void 0}),We(function(n){var e=n[1];return e}))};function Id(n,e){return e===void 0&&(e={}),ba(n,{includeMetadataChanges:!0}).pipe(QS(),We(function(t){var r=t[0],i=t[1],o=i.docChanges();return r&&!Gy(r,i)&&i.docs.forEach(function(s,a){var u=o.find(function(h){return yr(h.doc.ref,s.ref)});if(u){if(Gy(u.doc,s))return}else{var l=r?.docs.find(function(h){return yr(h.ref,s.ref)});if(l&&Gy(l,s))return}o.push({oldIndex:a,newIndex:a,type:"modified",doc:s})}),o}),pF(e.events||KS),yF())}function Qy(n){return ba(n,{includeMetadataChanges:!0}).pipe(We(function(e){return e.docs}))}function YS(n,e){return e===void 0&&(e={}),Id(n,e).pipe(Tc(function(t,r){return gF(t,r,e.events)},[]),yh())}function JS(n,e){return e===void 0&&(e={}),Id(n,e).pipe(Tc(function(t,r){return Wy(Wy([],t,!0),r,!0)},[]))}function ZS(n,e){return e===void 0&&(e={}),Qy(n).pipe(We(function(t){return t.map(function(r){return _d(r,e)})}))}function Yy(n){return Et(yd(n))}function XS(n){return Yy(n).pipe(We(function(e){return e.data().count}))}var Ca=class{constructor(e){return e}},Zy="firestore",Jy=class{constructor(){return Qi(Zy)}},D4=fh(0,300).pipe(ph(()=>Et(Qi(Zy))),gh()),Xy=new me("angularfire2.firestore-instances");function vF(n,e){let t=Pp(Zy,n,e);return t&&new Ca(t)}function _F(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Ca(r)}}var eA={provide:Jy,deps:[[new ln,Xy]]},tA={provide:Ca,useFactory:vF,deps:[[new ln,Xy],Qr]},S4=(()=>{class n{constructor(){He("angularfire",Kr.full,"fst")}static \u0275fac=function(r){return new(r||n)};static \u0275mod=GI({type:n});static \u0275inj=kI({providers:[tA,eA]})}return n})();function A4(n,...e){return He("angularfire",Kr.full,"fst"),Is([tA,eA,{provide:Xy,useFactory:_F(n),multi:!0,deps:[$e,Un,As,Ns,[new ln,Hu],[new ln,Ss],...e]}])}var N4=L(Id,!0),x4=L(Qy,!0),R4=L(YS,!0),P4=L(JS,!0),M4=L(ZS,!0),k4=L(Yy,!0),O4=L(XS,!0),L4=L(Ky,!0),V4=L(WS,!0),F4=L(_d,!0),j4=L(ba,!0),U4=L(SS,!0),B4=L(mS,!0),$4=L(gS,!0),q4=L(nS,!0),H4=L(FS,!0),z4=L(VS,!0),G4=L(pS,!0),W4=L(VD,!0),K4=L(ND,!0),Q4=L(xD,!0),Y4=L(Ly,!0),J4=L(By,!0),Z4=L(zS,!0),X4=L(DS,!0),eW=L(OS,!0),tW=L(UD,!0),nW=L(HS,!0),rW=L(Vy,!0),iW=L(zD,!0),oW=L(kD,!0),sW=L(OD,!0),aW=L(jD,!0),cW=L(qS,!0),uW=L(uS,!0),lW=L(cS,!0),dW=L(qy,!0),hW=L(yd,!0),fW=L(vS,!0),pW=L(_S,!0),mW=L(IS,!0),gW=L(wS,!0),yW=L(ES,!0),vW=L(TS,!0),_W=L(PD,!0),IW=L($S,!0),wW=L(jS,!0),EW=L(RD,!0),TW=L(iS,!0),bW=L(oS,!0),CW=L($D,!0),DW=L(NS,!0),SW=L(RS,!0),AW=L(xS,!0),NW=L(qD,!0),xW=L(gd,!0),RW=L(AS,!0),PW=L(tS,!0),MW=L(rS,!0),kW=L(PS,!0),OW=L(MS,!0),LW=L(Hy,!0),VW=L(XD,!0),FW=L(dd,!0),jW=L(yr,!0),UW=L(kS,!0),BW=L(LS,!0),$W=L(bS,!0),qW=L(BS,!0),HW=L(Yb,!0),zW=L(yS,!0),GW=L(aS,!0),WW=L(sS,!0),KW=L(fS,!0),QW=L(BD,!0),YW=L(CS,!0),JW=L(FD,!0),ZW=L(eS,!0),XW=L(US,!0);export{jt as a,Ut as b,w as c,Oe as d,ec as e,ah as f,ch as g,Nn as h,rs as i,os as j,Et as k,aN as l,cN as m,uN as n,Sr as o,We as p,yN as q,Ar as r,wc as s,_N as t,IN as u,Mn as v,$_ as w,ph as x,ss as y,mh as z,wN as A,bN as B,H_ as C,vh as D,CN as E,Tc as F,Ih as G,DN as H,SN as I,wh as J,de as K,yt as L,PI as M,Ke as N,kI as O,iH as P,me as Q,oe as R,qt as S,ve as T,ds as U,oH as V,GI as W,sH as X,aH as Y,Is as Z,tw as _,Fn as $,cH as aa,Rx as ba,uH as ca,lH as da,dH as ea,hH as fa,fH as ga,Un as ha,gu as ia,cn as ja,$e as ka,ji as la,yu as ma,pH as na,mH as oa,VR as pa,Qw as qa,gH as ra,yH as sa,vH as ta,of as ua,_H as va,_u as wa,eu as xa,nu as ya,EH as za,cp as Aa,bH as Ba,FP as Ca,wf as Da,HP as Ea,ZP as Fa,nM as Ga,lM as Ha,dM as Ia,hM as Ja,UE as Ka,BE as La,TM as Ma,CH as Na,DH as Oa,SM as Pa,PM as Qa,SH as Ra,AH as Sa,NH as Ta,xH as Ua,RH as Va,PH as Wa,LM as Xa,qE as Ya,VM as Za,MH as _a,FM as $a,kH as ab,OH as bb,LH as cb,VH as db,FH as eb,GE as fb,JM as gb,bu as hb,jH as ib,UH as jb,YE as kb,BH as lb,gk as mb,$H as nb,qH as ob,HH as pb,zH as qb,Mz as rb,kz as sb,wt as tb,XG as ub,M as vb,om as wb,WT as xb,al as yb,Re as zb,je as Ab,j as Bb,t4 as Cb,ke as Db,ho as Eb,cF as Fb,re as Gb,Qe as Hb,Me as Ib,Xt as Jb,Hg as Kb,i4 as Lb,be as Mb,fi as Nb,zg as Ob,So as Pb,En as Qb,Tn as Rb,ha as Sb,mi as Tb,ga as Ub,Ao as Vb,Xg as Wb,ed as Xb,td as Yb,nd as Zb,rd as _b,gn as $b,dr as ac,co as bc,hr as cc,Ta as dc,ay as ec,cy as fc,uy as gc,s4 as hc,a4 as ic,Qb as jc,Ca as kc,Jy as lc,D4 as mc,S4 as nc,A4 as oc,N4 as pc,x4 as qc,R4 as rc,P4 as sc,M4 as tc,k4 as uc,O4 as vc,L4 as wc,V4 as xc,F4 as yc,j4 as zc,U4 as Ac,B4 as Bc,$4 as Cc,q4 as Dc,H4 as Ec,z4 as Fc,G4 as Gc,W4 as Hc,K4 as Ic,Q4 as Jc,Y4 as Kc,J4 as Lc,Z4 as Mc,X4 as Nc,eW as Oc,tW as Pc,nW as Qc,rW as Rc,iW as Sc,oW as Tc,sW as Uc,aW as Vc,cW as Wc,uW as Xc,lW as Yc,dW as Zc,hW as _c,fW as $c,pW as ad,mW as bd,gW as cd,yW as dd,vW as ed,_W as fd,IW as gd,wW as hd,EW as id,TW as jd,bW as kd,CW as ld,DW as md,SW as nd,AW as od,NW as pd,xW as qd,RW as rd,PW as sd,MW as td,kW as ud,OW as vd,LW as wd,VW as xd,FW as yd,jW as zd,UW as Ad,BW as Bd,$W as Cd,qW as Dd,HW as Ed,zW as Fd,GW as Gd,WW as Hd,KW as Id,QW as Jd,YW as Kd,JW as Ld,ZW as Md,XW as Nd};
